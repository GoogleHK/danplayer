{"version":3,"sources":["webpack://danplayer/webpack/universalModuleDefinition","webpack://danplayer/webpack/bootstrap","webpack://danplayer/./node_modules/number-precision/build/index.js","webpack://danplayer/./node_modules/regenerator-runtime/runtime.js","webpack://danplayer/./node_modules/@babel/runtime/regenerator/index.js","webpack://danplayer/./node_modules/current-script-polyfill/currentScript.js","webpack://danplayer/./node_modules/events/events.js","webpack://danplayer/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://danplayer/./src/player/buttonAndLayer.ts","webpack://danplayer/./src/player/IconButton.ts","webpack://danplayer/./src/player/volumeLayer.ts","webpack://danplayer/./src/player/qualitySelector.ts","webpack://danplayer/./src/player/progressBar.ts","webpack://danplayer/./src/player/danmaku/danmaku.ts","webpack://danplayer/./src/player/danmaku/danmakuDrawer.ts","webpack://danplayer/./src/player/danmaku/canvas.ts","webpack://danplayer/./src/player/danmaku/danmakuLayer.ts","webpack://danplayer/./src/player/danmaku/danmakuStyleLayer.ts","webpack://danplayer/./src/player/danmaku/danmakuForm.ts","webpack://danplayer/./src/player/UI.ts","webpack://danplayer/./src/player/player.ts","webpack://danplayer/./src/player/index.ts","webpack://danplayer/./node_modules/@vue/cli-service/lib/commands/build/entry-lib.js"],"names":["root","factory","exports","module","define","amd","self","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","strip","num","precision","parseFloat","toPrecision","digitLength","eSplit","toString","split","len","length","float2Fixed","indexOf","Number","replace","dLen","Math","pow","checkBoundary","_boundaryCheckingState","MAX_SAFE_INTEGER","MIN_SAFE_INTEGER","console","warn","times","num1","num2","others","_i","arguments","apply","concat","slice","num1Changed","num2Changed","baseNum","leftValue","plus","max","minus","divide","round","ratio","base","enableBoundaryChecking","flag","index","runtime","undefined","Op","hasOwn","$Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","context","Context","_invoke","makeInvokeMethod","tryCatch","fn","obj","arg","type","err","GenStateSuspendedStart","GenStateSuspendedYield","GenStateExecuting","GenStateCompleted","ContinueSentinel","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","values","Gp","defineIteratorMethods","forEach","method","AsyncIterator","invoke","resolve","reject","record","result","Promise","__await","then","unwrapped","error","previousPromise","enqueue","callInvokeWithMethodAndArg","state","Error","doneResult","delegate","delegateResult","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","done","TypeError","info","resultName","next","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","constructor","displayName","isGeneratorFunction","genFun","ctor","mark","setPrototypeOf","__proto__","awrap","async","iter","keys","reverse","pop","skipTempReset","prev","charAt","stop","rootEntry","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","thrown","delegateYield","regeneratorRuntime","accidentalStrictMode","Function","document","currentScript","scripts","getElementsByTagName","res","exec","stack","src","readyState","ReflectOwnKeys","R","Reflect","ReflectApply","target","receiver","args","ProcessEmitWarning","warning","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","NumberIsNaN","EventEmitter","init","_events","_eventsCount","_maxListeners","defaultMaxListeners","$getMaxListeners","that","_addListener","listener","prepend","events","existing","newListener","emit","unshift","warned","w","String","emitter","count","onceWrapper","fired","removeListener","wrapFn","_onceWrap","wrapped","_listeners","unwrap","evlistener","unwrapListeners","arrayClone","listenerCount","arr","copy","Array","spliceOne","list","ret","set","RangeError","setMaxListeners","getMaxListeners","doError","er","message","handler","listeners","addListener","on","prependListener","once","prependOnceListener","position","originalListener","shift","off","removeAllListeners","rawListeners","eventNames","window","match","ButtonAndLayer","ui","layerHideDelay","bottomOffset","hideTimeout","_isShow","player","mouseenterShowLayer","clearTimeout","isMouseInUI","showLayer","mouseleaveHideLayer","setTimeout","hideLayer","$btn","addEventListener","$layer","classList","add","updateLayerPosition","remove","style","display","rootRect","$root","getBoundingClientRect","btnRect","layerRect","left","width","bottom","IconButton","$div","$use","querySelector","iconAttr","titleAttr","switchIcon","switchTitle","attributeName","setAttributeNS","getAttribute","setAttribute","volumeValue","areaHeight","$video","updateController","$valueLabel","btn","toggleMuted","$dragArea","$controller","$current","volume","options","mousemoveControlVolume","e","y","pageY","rect","top","range","mouseupReleaseControl","removeEventListener","updateButton","attr","switch","innerText","height","transform","clientHeight","background","color","QualitySelector","currentLevel","$autoLevel","createElement","innerHTML","$item","hasAttribute","parseInt","log","hls","loadLevel","_updateLevel","levels","level","append","video","DanmakuType","ProgressBar","barWidth","_currentTime","percent","offsetWidth","$time","$buffer","currentTime","duration","time","update","updateBufferBar","mouseMoveChangeTime","playerRect","x","pageX","mouseup","clientWidth","resize","live","getTimeString","buffered","start","end","temp","floor","join","MakeDanmakuOptions","borderColor","fill","Flow","id","fontSize","Danmaku","text","assign","font","DanmakuDrawer","enable","selfCanvas","ctx","getContext","textBaseline","textAlign","danmaku","measureText","clearRect","strokeStyle","strokeRect","strokeText","fillStyle","fillText","DanmakuFlowDrawer","getSize","draw","canvasWidth","lastFrameTime","speed","DanmakuFixedDrawer","timeout","LimitType","Canvas","caches","$canvas","toggle","drawer","splice","clear","drawImage","size","val","globalAlpha","template","MakeDanmakuDrawerMenu","menus","copyFn","$content","$buttons","$span","onclick","$copy","MakeDanmakuLayerOptions","alpha","flowDuration","fadeoutDuration","limit","UnOverlap","contextMenu","danmakus","showed","topEnables","topAndBottomDisables","bottomEnables","flowEnables","flowDisables","lineHeights","topLines","bottomLines","flowLines","displayArea","topY","flowY","bottomY","frameTime","calcDanmakuTime","isShow","calcTopInterval","destroied","addDanmakuToCanvasTime","lastFrame","event","canvas","hideMenu","$menu","found","findDrawers","createDanmakuMenu","right","clientX","clientY","body","preventDefault","stopPropagation","show","hide","loop","drawers","className","copyText","clearCache","lineHeight","fontHeight","screen","Percent75","Half","Percent25","renderAll","trim","filter","DanmakuLayer","find","abs","includes","calcFlowTop","addDrawer","Top","calcTopTop","calcBottomTop","$input","select","execCommand","_d","removeDrawer","addDanmakuToCanvas","Date","now","paused","drawDanmaku","requestAnimationFrame","clearInterval","all","flow","fixed","positionY","offsetX","offsetY","DanmakuStyleLayer","colors","map","$types","from","querySelectorAll","$colors","$dom","styleLayer","send","startsWith","focus","getStyle","danmakuLayer","_isMouseInUI","extraButtons","$gradientBG","qualitySelector","progressBar","danmakuForm","$controllerButtonsRightLayout","btnFullScreen","a","toggleFullScreen","updateFullScreenButton","btnPlay","updatePlayButton","btnShowDanmaku","updateDanmakuButton","insertExtraButtons","cancelHideUIDelay","uiFadeOutDelay","clearExtraButtons","isFullScreen","title","destroy","debug","VideoType","icon","MakeDefaultOptions","autoplay","iconSrc","fullScreen","onlyOne","$e","Normal","_width","_height","_duration","_loading","_paused","delayResize","$icon","Player","instances","parent","parentElement","insertBefore","removeAttribute","outerHTML","fullscreenElement","up","down","hideUIDelay","resizeEvt","_setSrc","_setUI","getContentType","hideButton","Hls","Events","LEVEL_LOADED","updateLevel","showButton","play","resetTimeZone","newOptions","hasChange","detachMedia","ms","array","pause","Dash","isSupported","config","capLevelToPlayerSize","attachMedia","loadSource","http","XMLHttpRequest","open","onreadystatechange","HEADERS_RECEIVED","status","getResponseHeader","abort","contentType","canPlayType","requestFullscreen","exitFullscreen","quality"],"mappings":"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","file":"danplayer.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"danplayer\"] = factory();\n\telse\n\t\troot[\"danplayer\"] = factory();\n})((typeof self !== 'undefined' ? self : this), function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"fb15\");\n","'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n/**\r\n * @desc 解决浮动运算问题，避免小数点后产生多位数和计算精度损失。\r\n * 问题示例：2.3 + 2.4 = 4.699999999999999，1.0 - 0.9 = 0.09999999999999998\r\n */\r\n/**\r\n * 把错误的数据转正\r\n * strip(0.09999999999999998)=0.1\r\n */\r\nfunction strip(num, precision) {\r\n    if (precision === void 0) { precision = 12; }\r\n    return +parseFloat(num.toPrecision(precision));\r\n}\r\n/**\r\n * Return digits length of a number\r\n * @param {*number} num Input number\r\n */\r\nfunction digitLength(num) {\r\n    // Get digit length of e\r\n    var eSplit = num.toString().split(/[eE]/);\r\n    var len = (eSplit[0].split('.')[1] || '').length - (+(eSplit[1] || 0));\r\n    return len > 0 ? len : 0;\r\n}\r\n/**\r\n * 把小数转成整数，支持科学计数法。如果是小数则放大成整数\r\n * @param {*number} num 输入数\r\n */\r\nfunction float2Fixed(num) {\r\n    if (num.toString().indexOf('e') === -1) {\r\n        return Number(num.toString().replace('.', ''));\r\n    }\r\n    var dLen = digitLength(num);\r\n    return dLen > 0 ? strip(num * Math.pow(10, dLen)) : num;\r\n}\r\n/**\r\n * 检测数字是否越界，如果越界给出提示\r\n * @param {*number} num 输入数\r\n */\r\nfunction checkBoundary(num) {\r\n    if (_boundaryCheckingState) {\r\n        if (num > Number.MAX_SAFE_INTEGER || num < Number.MIN_SAFE_INTEGER) {\r\n            console.warn(num + \" is beyond boundary when transfer to integer, the results may not be accurate\");\r\n        }\r\n    }\r\n}\r\n/**\r\n * 精确乘法\r\n */\r\nfunction times(num1, num2) {\r\n    var others = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        others[_i - 2] = arguments[_i];\r\n    }\r\n    if (others.length > 0) {\r\n        return times.apply(void 0, [times(num1, num2), others[0]].concat(others.slice(1)));\r\n    }\r\n    var num1Changed = float2Fixed(num1);\r\n    var num2Changed = float2Fixed(num2);\r\n    var baseNum = digitLength(num1) + digitLength(num2);\r\n    var leftValue = num1Changed * num2Changed;\r\n    checkBoundary(leftValue);\r\n    return leftValue / Math.pow(10, baseNum);\r\n}\r\n/**\r\n * 精确加法\r\n */\r\nfunction plus(num1, num2) {\r\n    var others = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        others[_i - 2] = arguments[_i];\r\n    }\r\n    if (others.length > 0) {\r\n        return plus.apply(void 0, [plus(num1, num2), others[0]].concat(others.slice(1)));\r\n    }\r\n    var baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));\r\n    return (times(num1, baseNum) + times(num2, baseNum)) / baseNum;\r\n}\r\n/**\r\n * 精确减法\r\n */\r\nfunction minus(num1, num2) {\r\n    var others = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        others[_i - 2] = arguments[_i];\r\n    }\r\n    if (others.length > 0) {\r\n        return minus.apply(void 0, [minus(num1, num2), others[0]].concat(others.slice(1)));\r\n    }\r\n    var baseNum = Math.pow(10, Math.max(digitLength(num1), digitLength(num2)));\r\n    return (times(num1, baseNum) - times(num2, baseNum)) / baseNum;\r\n}\r\n/**\r\n * 精确除法\r\n */\r\nfunction divide(num1, num2) {\r\n    var others = [];\r\n    for (var _i = 2; _i < arguments.length; _i++) {\r\n        others[_i - 2] = arguments[_i];\r\n    }\r\n    if (others.length > 0) {\r\n        return divide.apply(void 0, [divide(num1, num2), others[0]].concat(others.slice(1)));\r\n    }\r\n    var num1Changed = float2Fixed(num1);\r\n    var num2Changed = float2Fixed(num2);\r\n    checkBoundary(num1Changed);\r\n    checkBoundary(num2Changed);\r\n    return times((num1Changed / num2Changed), Math.pow(10, digitLength(num2) - digitLength(num1)));\r\n}\r\n/**\r\n * 四舍五入\r\n */\r\nfunction round(num, ratio) {\r\n    var base = Math.pow(10, ratio);\r\n    return divide(Math.round(times(num, base)), base);\r\n}\r\nvar _boundaryCheckingState = true;\r\n/**\r\n * 是否进行边界检查，默认开启\r\n * @param flag 标记开关，true 为开启，false 为关闭，默认为 true\r\n */\r\nfunction enableBoundaryChecking(flag) {\r\n    if (flag === void 0) { flag = true; }\r\n    _boundaryCheckingState = flag;\r\n}\r\nvar index = { strip: strip, plus: plus, minus: minus, times: times, divide: divide, round: round, digitLength: digitLength, float2Fixed: float2Fixed, enableBoundaryChecking: enableBoundaryChecking };\n\nexports.strip = strip;\nexports.plus = plus;\nexports.minus = minus;\nexports.times = times;\nexports.divide = divide;\nexports.round = round;\nexports.digitLength = digitLength;\nexports.float2Fixed = float2Fixed;\nexports.enableBoundaryChecking = enableBoundaryChecking;\nexports['default'] = index;\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return Promise.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return Promise.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new Promise(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList) {\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList)\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n","// document.currentScript polyfill by Adam Miller\n\n// MIT license\n\n(function(document){\n  var currentScript = \"currentScript\",\n      scripts = document.getElementsByTagName('script'); // Live NodeList collection\n\n  // If browser needs currentScript polyfill, add get currentScript() to the document object\n  if (!(currentScript in document)) {\n    Object.defineProperty(document, currentScript, {\n      get: function(){\n\n        // IE 6-10 supports script readyState\n        // IE 10+ support stack trace\n        try { throw new Error(); }\n        catch (err) {\n\n          // Find the second match for the \"at\" string to get file src url from stack.\n          // Specifically works with the format of stack traces in IE.\n          var i, res = ((/.*at [^\\(]*\\((.*):.+:.+\\)$/ig).exec(err.stack) || [false])[1];\n\n          // For all scripts on the page, if src matches or if ready state is interactive, return the script tag\n          for(i in scripts){\n            if(scripts[i].src == res || scripts[i].readyState == \"interactive\"){\n              return scripts[i];\n            }\n          }\n\n          // If no match, return null\n          return null;\n        }\n      }\n    });\n  }\n})(document);\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    require('current-script-polyfill')\n  }\n\n  var i\n  if ((i = window.document.currentScript) && (i = i.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/))) {\n    __webpack_public_path__ = i[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","import { Player } from './player'\nimport { UI } from '@/player/UI'\n\nexport class ButtonAndLayer {\n  player: Player\n  ui: UI\n  $btn!: HTMLElement\n  $layer!: HTMLElement\n\n  protected layerHideDelay = 200\n  protected bottomOffset = 40\n  private hideTimeout = -1\n  private _isShow: boolean = false\n\n  get isShow (): boolean {\n    return this._isShow\n  }\n\n  constructor (ui: UI) {\n    this.ui = ui\n    this.player = ui.player\n  }\n\n  protected init () {\n    const mouseenterShowLayer = () => {\n      clearTimeout(this.hideTimeout)\n      this.ui.isMouseInUI = true\n      this.showLayer()\n    }\n    const mouseleaveHideLayer = () => {\n      this.ui.isMouseInUI = false\n      clearTimeout(this.hideTimeout)\n      this.hideTimeout = setTimeout(() => {\n        this.hideLayer()\n      }, this.layerHideDelay)\n    }\n    this.$btn.addEventListener('mouseenter', mouseenterShowLayer)\n    this.$btn.addEventListener('mouseleave', mouseleaveHideLayer)\n\n    this.$layer.addEventListener('mouseenter', mouseenterShowLayer)\n    this.$layer.addEventListener('mouseleave', mouseleaveHideLayer)\n  }\n\n  showLayer () {\n    this._isShow = true\n    this.$layer.classList.add('show')\n    this.updateLayerPosition()\n  }\n\n  hideLayer () {\n    this._isShow = false\n    this.$layer.classList.remove('show')\n  }\n\n  toggleLayer () {\n    if (this._isShow) {\n      this.hideLayer()\n    } else {\n      this.showLayer()\n    }\n  }\n\n  showButton () {\n    this.$btn.style.display = ''\n  }\n\n  hideButton () {\n    this.$btn.style.display = 'none'\n  }\n\n  updateLayerPosition () {\n    if (!this._isShow) return\n    const rootRect = this.ui.player.$root.getBoundingClientRect()\n    const btnRect = this.$btn.getBoundingClientRect()\n    const layerRect = this.$layer.getBoundingClientRect()\n    const left = btnRect.left + (btnRect.width / 2) - rootRect.left - layerRect.width / 2\n\n    this.$layer.style.left = left + 'px'\n    this.$layer.style.bottom = this.bottomOffset + 'px'\n    // console.log('update', { left })\n  }\n\n  destroy () {\n    clearTimeout(this.hideTimeout)\n  }\n}\n","export class IconButton {\n  $root: HTMLElement\n  $use: SVGUseElement\n\n  constructor ($div: HTMLElement) {\n    this.$root = $div\n    this.$use = this.$root.querySelector('use') as SVGUseElement\n  }\n\n  switch (iconAttr: string, titleAttr?: string) {\n    this.switchIcon(iconAttr)\n    if (titleAttr) this.switchTitle(titleAttr)\n  }\n\n  switchIcon (attributeName: string) {\n    this.$use.setAttributeNS('http://www.w3.org/1999/xlink', 'href',\n      '#' + this.$root.getAttribute(attributeName) as string)\n  }\n\n  switchTitle (attributeName: string) {\n    this.$root.setAttribute('title', this.$root.getAttribute(attributeName) as string)\n  }\n}\n","import NP from 'number-precision'\nimport { ButtonAndLayer } from '@/player/buttonAndLayer'\nimport { UI } from '@/player/UI'\nimport { IconButton } from '@/player/IconButton'\n\nNP.enableBoundaryChecking(false)\n\nexport class VolumeLayer extends ButtonAndLayer {\n  $video: HTMLVideoElement\n  $valueLabel: HTMLElement\n  $dragArea: HTMLElement\n  $controller: HTMLElement\n  btn: IconButton\n\n  $current: HTMLElement\n  volumeValue: number = 0\n  private areaHeight: number = 0\n\n  constructor (ui: UI) {\n    super(ui)\n    this.$video = this.player.$video\n    this.$video.addEventListener('volumechange', () => this.updateController())\n    this.$layer = this.player.$root.querySelector('.interactive-layer .volume-bar') as HTMLElement\n    this.$valueLabel = this.$layer.querySelector('.volume-num-label') as HTMLElement\n    this.$btn = this.player.$root.querySelector('.interactive-layer .buttons .button.volume') as HTMLElement\n    this.btn = new IconButton(this.$btn)\n    this.$btn.addEventListener('click', () => this.toggleMuted())\n    this.$dragArea = this.$layer.querySelector('.volume-column-bar') as HTMLElement\n    this.$controller = this.$dragArea.querySelector('.bar-controller') as HTMLElement\n    this.$current = this.$dragArea.querySelector('.bar-current') as HTMLElement\n    this.volumeValue = this.$video.volume = this.player.options.volume\n\n    if (this.volumeValue === 0) {\n      this.volumeValue = 0.7\n    }\n\n    const mousemoveControlVolume = (e: MouseEvent) => {\n      // console.log({ y })\n      let y = e.pageY\n      const rect = this.$dragArea.getBoundingClientRect()\n      if (y < rect.top) {\n        this.$video.volume = 1\n      } else if (y > rect.bottom) {\n        this.$video.volume = 0\n      } else {\n        const range = rect.bottom - rect.top\n        y -= rect.top\n        const value = y / range\n        this.$video.volume = NP.round(1 - value, 2)\n      }\n      this.volumeValue = this.$video.volume\n      this.updateController()\n    }\n    const mouseupReleaseControl = (e: MouseEvent) => {\n      document.removeEventListener('mousemove', mousemoveControlVolume)\n      document.removeEventListener('mouseup', mouseupReleaseControl)\n      mousemoveControlVolume(e)\n    }\n    this.$dragArea.addEventListener('mousedown', () => {\n      document.addEventListener('mousemove', mousemoveControlVolume)\n      document.addEventListener('mouseup', mouseupReleaseControl)\n    })\n\n    this.init()\n    this.updateController()\n  }\n\n  up () {\n    if (this.$video.volume <= 0.9) {\n      this.$video.volume = NP.plus(this.$video.volume, 0.1)\n    } else {\n      this.$video.volume = 1\n    }\n    this.volumeValue = this.$video.volume\n  }\n\n  down () {\n    if (this.$video.volume >= 0.1) {\n      this.$video.volume = NP.minus(this.$video.volume, 0.1)\n    } else {\n      this.$video.volume = 0\n    }\n    this.volumeValue = this.$video.volume\n  }\n\n  toggleMuted () {\n    if (this.$video.volume > 0) {\n      this.$video.volume = 0\n    } else {\n      if (this.volumeValue === 0) {\n        this.$video.volume = 1\n      } else {\n        this.$video.volume = this.volumeValue\n      }\n    }\n    this.updateButton()\n  }\n\n  updateButton () {\n    let attr\n    // console.log('音量', this.$video.volume)\n    if (this.$video.volume > 0) {\n      attr = 'data-on'\n    } else {\n      attr = 'data-off'\n    }\n    this.btn.switch(attr)\n  }\n\n  updateController () {\n    const value = NP.round(this.$video.volume * 100, 0)\n    this.$valueLabel.innerText = value.toString()\n    let y = this.$video.volume * this.areaHeight\n    this.$current.style.height = y + 'px'\n    y = this.areaHeight - y\n    this.$controller.style.transform = `translateY(${y}px)`\n    this.updateButton()\n  }\n\n  showLayer () {\n    super.showLayer()\n    this.areaHeight = this.$dragArea.clientHeight\n    this.updateController()\n  }\n\n  update () {\n    this.$controller.style.background = this.$current.style.background = this.player.options.color\n  }\n}\n","import { ButtonAndLayer } from '@/player/buttonAndLayer'\nimport { UI } from '@/player/UI'\n\nexport class QualitySelector extends ButtonAndLayer {\n  hls!: Hls\n  private readonly $autoLevel: Element\n  currentLevel = -1\n\n  constructor (ui: UI) {\n    super(ui)\n    this.$btn = this.player.$root.querySelector('.button.quality') as HTMLElement\n    this.$layer = this.player.$root.querySelector('.float.quality-menu') as HTMLElement\n    this.$autoLevel = document.createElement('div')\n    this.$autoLevel.innerHTML = '自动'\n    this.$autoLevel.setAttribute('data-value', (-1).toString())\n    this.init()\n    this.$layer.addEventListener('click', (e: MouseEvent) => {\n      if (e.target) {\n        const $item = e.target as HTMLElement\n        if ($item.hasAttribute('data-value')) {\n          const value = parseInt($item.getAttribute('data-value') as string)\n          console.log('click', value)\n          if (this.player.hls) {\n            this.player.hls.currentLevel = this.player.hls.loadLevel = value\n            this.currentLevel = value\n          }\n        }\n      }\n      this.updateButton()\n      this.hideLayer()\n    })\n  }\n\n  showButton () {\n    this.$btn.style.display = ''\n  }\n\n  hideButton () {\n    this.$btn.style.display = 'none'\n  }\n\n  showLayer () {\n    super.showLayer()\n    this._updateLevel()\n    this.updateLayerPosition()\n  }\n\n  updateButton () {\n    let name = '自动'\n    if (this.currentLevel > -1 && this.hls.levels[this.hls.loadLevel]) {\n      name = this.hls.levels[this.hls.loadLevel].name + 'p'\n    }\n    this.$btn.innerText = name\n  }\n\n  private _updateLevel () {\n    this.$layer.innerHTML = ''\n    this.hls.levels.forEach((level, index) => {\n      if (!level.name) return\n      const $item = document.createElement('div') as HTMLElement\n\n      if (index === this.currentLevel) {\n        $item.classList.add('current')\n      }\n      $item.innerText = level.name + 'P'\n      $item.setAttribute('data-value', index.toString())\n      this.$layer.append($item)\n    })\n    if (this.currentLevel === -1) {\n      this.$autoLevel.classList.add('current')\n    } else {\n      this.$autoLevel.classList.remove('current')\n    }\n    this.$layer.append(this.$autoLevel)\n  }\n\n  updateLevel (video: Hls) {\n    this.hls = video\n    this._updateLevel()\n    this.updateLayerPosition()\n    this.updateButton()\n  }\n}\n","import { Player } from '@/player/player'\nimport { UI } from '@/player/UI'\n\nexport class ProgressBar {\n  private player: Player\n  private ui: UI\n  private readonly $root: HTMLElement\n  private $controller: HTMLElement\n  private $current: HTMLElement\n  private $buffer: HTMLElement\n  private $time: HTMLElement\n\n  private barWidth: number = 0\n  private _currentTime = 0\n  private percent = 0\n  private offsetWidth = 0\n\n  constructor (ui: UI) {\n    this.player = ui.player\n    this.ui = ui\n    this.$root = this.player.$root.querySelector('.progress-bar') as HTMLElement\n    this.$controller = this.$root.querySelector('.bar-controller') as HTMLElement\n    this.$current = this.$root.querySelector('.bar-current') as HTMLElement\n    this.$time = this.player.$root.querySelector('.controller-bottom-bar .time') as HTMLElement\n\n    this.$buffer = this.$root.querySelector('.bar-buffer') as HTMLElement\n    this.player.$video.addEventListener('timeupdate', () => {\n      this._currentTime = this.player.$video.currentTime\n      this.percent = this._currentTime / this.player.$video.duration\n      this.time()\n      this.update()\n    })\n    this.player.$video.addEventListener('progress', () => {\n      this.updateBufferBar()\n      this.time()\n    })\n    const mouseMoveChangeTime = (e: MouseEvent) => {\n      const playerRect = this.player.$root.getBoundingClientRect()\n      let x = e.pageX - playerRect.left - this.offsetWidth / 2\n      if (x < 0) {\n        x = 0\n      } else if (x > this.barWidth) {\n        x = this.barWidth\n      }\n      this.percent = x / this.barWidth\n      this.player.$video.currentTime = this.percent * this.player.$video.duration\n      this.update()\n      this.ui.isMouseInUI = true\n    }\n    const mouseup = () => {\n      document.removeEventListener('mousemove', mouseMoveChangeTime)\n      document.removeEventListener('mouseup', mouseup)\n    }\n    this.$root.addEventListener('mousedown', () => {\n      document.addEventListener('mousemove', mouseMoveChangeTime)\n      document.addEventListener('mouseup', mouseup)\n    })\n\n    this.$root.addEventListener('click', mouseMoveChangeTime)\n\n    this.offsetWidth = this.player.width - this.$root.clientWidth\n    this.resize()\n  }\n\n  private time () {\n    if (this.player.options.live) return\n    this.$time.innerText = ProgressBar.getTimeString(this.player.$video.currentTime) +\n      ' / ' + ProgressBar.getTimeString(this.player.$video.duration)\n  }\n\n  private static getTimeString (s: number): string {\n    let time = []\n    // 小时\n    let temp: string | number = Math.floor(s / (60 * 60))\n    if (temp > 0) {\n      if (temp.toString().length === 1) {\n        temp = '0' + temp\n      }\n      time.push(temp)\n    }\n\n    // 分\n    temp = Math.floor(s / 60) - Math.floor(s / 3600) * 60\n    if (temp.toString().length === 1) {\n      temp = '0' + temp\n    }\n    time.push(temp)\n\n    // 秒\n    temp = Math.floor(s) - Math.floor(s / 60) * 60\n    if (temp.toString().length === 1) {\n      temp = '0' + temp\n    }\n    time.push(temp)\n    return time.join(':')\n  }\n\n  resize () {\n    this.barWidth = this.player.width - this.offsetWidth\n    // console.log('进度条 长度', this.barWidth, this.player.$root.clientWidth)\n    this.update()\n    this.updateBufferBar()\n  }\n\n  update () {\n    const x = this.barWidth * this.percent\n    this.$current.style.width = x + 'px'\n    this.$controller.style.transform = `translateX(${x}px)`\n    this.$controller.style.background = this.player.options.color\n    this.$current.style.background = this.player.options.color\n  }\n\n  resetTimeZone () {\n    if (this.player.options.live) {\n      this.$time.innerText = '直播'\n    } else {\n      this.$time.innerText = ''\n    }\n  }\n\n  updateBufferBar () {\n    for (let i = 0; i < this.player.$video.buffered.length; i++) {\n      const start = this.player.$video.buffered.start(i)\n      const end = this.player.$video.buffered.end(i)\n      if (start < this._currentTime && this._currentTime < end) {\n        this.$buffer.style.width = end / this.player.$video.duration * this.barWidth + 'px'\n      }\n    }\n  }\n}\n","export const enum DanmakuType {\n  Top,\n  Flow,\n  Bottom\n}\n\ninterface iDanmakuContextMeuEvent {\n  readonly danmaku: Danmaku\n}\n\ndeclare var DanmakuContextMeuEvent: {\n  prototype: iDanmakuContextMeuEvent;\n  new (type: string, eventInitDict?: MouseEventInit): MouseEvent;\n}\n\nexport interface DanmakuOptions {\n  // 视频进度\n  currentTime: number\n  type: DanmakuType\n  borderColor: string\n  fill: string\n  id: string | number\n  fontSize: string | number,\n}\n\nexport function MakeDanmakuOptions ({\n  currentTime = 0,\n  borderColor = '',\n  fill = '#ffffff',\n  type = DanmakuType.Flow,\n  id = '',\n  fontSize = 28\n}: Partial<DanmakuOptions>): DanmakuOptions {\n  return { currentTime, type, borderColor, fill, id, fontSize }\n}\n\nexport class Danmaku implements DanmakuOptions {\n  text: string\n  borderColor!: string\n  currentTime!: number\n  fill!: string\n  type!: DanmakuType\n  id!: string\n  fontSize!: string | number\n\n  constructor (text: string, options?: Partial<DanmakuOptions>) {\n    this.text = text\n    Object.assign(this, MakeDanmakuOptions(options || {}))\n  }\n}\n","import { Danmaku } from '@/player/danmaku/danmaku'\n\nconst font = 'px \"Hiragino Sans GB\", \"Microsoft YaHei\", \"WenQuanYi Micro Hei\", sans-serif'\n\nexport class DanmakuDrawer {\n  selfCanvas: HTMLCanvasElement\n  ctx: CanvasRenderingContext2D\n  danmaku!: Danmaku\n  top: number = 0\n  left: number = 0\n  width: number = 0\n  height: number = 0\n\n  enable: boolean = false\n\n  constructor () {\n    this.selfCanvas = document.createElement('canvas')\n    this.selfCanvas.width = 100\n    this.selfCanvas.height = 100\n    this.ctx = this.selfCanvas.getContext('2d') as CanvasRenderingContext2D\n  }\n\n  protected getSize () {\n    this.ctx.textBaseline = 'top'\n    this.ctx.textAlign = 'left'\n    this.ctx.font = this.danmaku.fontSize + font\n    this.width = this.ctx.measureText(this.danmaku.text).width\n    this.height = this.ctx.measureText('M').width * 1.2\n  }\n\n  protected draw () {\n    const width = this.width + 4\n    const height = this.height\n    this.selfCanvas.width = width\n    this.selfCanvas.height = height\n    this.ctx.textBaseline = 'top'\n    this.ctx.textAlign = 'left'\n    this.ctx.font = this.danmaku.fontSize + font\n    this.ctx.clearRect(0, 0, width, height)\n    if (this.danmaku.borderColor) {\n      this.ctx.strokeStyle = this.danmaku.borderColor\n      this.ctx.strokeRect(1, 1, width - 4, height - 4)\n    }\n    this.ctx.strokeStyle = '#000000'\n    this.ctx.strokeText(this.danmaku.text, 1, 1)\n    this.ctx.fillStyle = this.danmaku.fill\n    this.ctx.fillText(this.danmaku.text, 1, 1)\n  }\n}\n\nexport class DanmakuFlowDrawer extends DanmakuDrawer {\n  set (danmaku: Danmaku, left: number, top: number) {\n    this.danmaku = danmaku\n    this.enable = true\n    this.left = left\n    this.top = top\n    this.getSize()\n    this.draw()\n  }\n\n  update (canvasWidth: number, duration: number, lastFrameTime: number) {\n    const speed = (canvasWidth + this.width) / duration * lastFrameTime\n    this.left = this.left - speed\n    this.enable = (this.left + this.width) > 0\n  }\n}\n\nexport class DanmakuFixedDrawer extends DanmakuDrawer {\n  timeout: number = 0\n\n  set (danmaku: Danmaku, timeout: number, canvasWidth: number, top: number) {\n    this.danmaku = danmaku\n    this.timeout = timeout\n    this.enable = true\n    this.getSize()\n    this.left = (canvasWidth - this.width) / 2\n    this.top = top\n    this.draw()\n    this.update(0)\n  }\n\n  update (lastFrameTime: number) {\n    console.log({ timeout: this.timeout, lastFrameTime })\n    this.timeout -= lastFrameTime\n    this.enable = this.timeout > 0\n  }\n}\n","import { Player } from '@/player/player'\nimport { DanmakuDrawer } from '@/player/danmaku/danmakuDrawer'\nimport { Danmaku } from '@/player/danmaku/danmaku'\n\nconst font = 'px \"Hiragino Sans GB\", \"Microsoft YaHei\", \"WenQuanYi Micro Hei\", sans-serif'\n\nexport class Canvas {\n  private player: Player\n  $canvas: HTMLCanvasElement\n  private ctx: CanvasRenderingContext2D\n\n  private caches: DanmakuDrawer[] = []\n\n  constructor (player: Player) {\n    this.player = player\n    this.$canvas = player.$root.querySelector('canvas') as HTMLCanvasElement\n    this.ctx = this.$canvas.getContext('2d') as CanvasRenderingContext2D\n\n    this.$canvas.addEventListener('click', () => {\n      player.toggle()\n    })\n  }\n\n  addDrawer (drawer: DanmakuDrawer) {\n    this.caches.push(drawer)\n  }\n\n  removeDrawer (drawer: DanmakuDrawer) {\n    const index = this.caches.indexOf(drawer)\n    if (index > -1) this.caches.splice(index, 1)\n  }\n\n  renderAll () {\n    this.clear()\n    if (this.caches.length > 0) {\n      for (let i = 0; i < this.caches.length; i++) {\n        const drawer = this.caches[i]\n        this.ctx.drawImage(drawer.selfCanvas, drawer.left, drawer.top)\n      }\n    }\n  }\n\n  clear () {\n    this.ctx.clearRect(0, 0, this.player.width, this.player.height)\n  }\n\n  clearCache () {\n    this.caches.length = 0\n  }\n\n  set alpha (val: number) {\n    this.ctx.globalAlpha = val\n  }\n\n  fontHeight (fontSize: number): number {\n    this.ctx.font = fontSize + font\n    const size = this.ctx.measureText('M')\n    return size.width * 1.2\n  }\n\n  fontWidth (drawer: DanmakuDrawer): number {\n    this.ctx.font = drawer.danmaku.fontSize + font\n    const size = this.ctx.measureText(drawer.danmaku.text)\n    return size.width\n  }\n\n  resize () {\n    this.$canvas.setAttribute('width', this.player.width + 'px')\n    this.$canvas.setAttribute('height', this.player.height + 'px')\n  }\n}\n","import { Player } from '@/player/player'\nimport { Danmaku, DanmakuType } from '@/player/danmaku/danmaku'\nimport { DanmakuDrawer, DanmakuFixedDrawer, DanmakuFlowDrawer } from './danmakuDrawer'\nimport { EventEmitter } from 'events'\nimport { Canvas } from '@/player/danmaku/canvas'\n\nexport enum LimitType {\n  UnLimited = 0, // 不限\n  UnOverlap = 1, // 防重叠\n  Percent25 = 1 / 4, // 25%屏显示弹幕\n  Half = 0.5, // 50%屏显示弹幕\n  Percent75 = 1 / 4, // 75%屏显示弹幕\n}\n\nexport interface DanmakuLayerOptions {\n  alpha: number\n  enable: boolean\n  flowDuration: number\n  fadeoutDuration: number\n  limit: LimitType // 防重叠选项\n  contextMenu: ((d: DanmakuDrawer) => { [name: string]: () => void }) | undefined\n}\n\nconst template = '<div class=\"content\"></div><div class=\"buttons\"><span class=\"copy\">复制</span></div>'\n\nfunction MakeDanmakuDrawerMenu (d: DanmakuDrawer, menus: { [p: string]: () => void }, copyFn: (text: string) => void): HTMLDivElement {\n  const $div = document.createElement('div')\n  $div.innerHTML = template\n  const $content = $div.querySelector('.content') as HTMLElement\n  $content.innerText = d.danmaku.text\n  const $buttons = $div.querySelector('.buttons') as HTMLDivElement\n  for (let key in menus) {\n    const $span = document.createElement('span')\n    $span.innerText = key\n    $span.onclick = menus[key]\n    $buttons.prepend($span)\n  }\n  const $copy = $div.querySelector('.copy') as HTMLElement\n  if ($copy) {\n    $copy.addEventListener('click', () => copyFn(d.danmaku.text))\n  }\n\n  return $div\n}\n\nexport function MakeDanmakuLayerOptions ({\n  alpha = 1,\n  enable = true,\n  flowDuration = 8,\n  fadeoutDuration = 5,\n  limit = LimitType.UnOverlap,\n  contextMenu = undefined\n}: Partial<DanmakuLayerOptions> = {}): DanmakuLayerOptions {\n  return { alpha, enable, flowDuration, limit, fadeoutDuration, contextMenu }\n}\n\nexport class DanmakuLayer {\n  private player: Player\n  private readonly canvas: Canvas\n  private $menu!: HTMLElement\n\n  // 弹幕内容池\n  danmakus: Danmaku[] = []\n  showed: Danmaku[] = []\n\n  // 池\n  topEnables: DanmakuFixedDrawer[] = []\n  topAndBottomDisables: DanmakuFixedDrawer[] = []\n  bottomEnables: DanmakuFixedDrawer[] = []\n  flowEnables: DanmakuFlowDrawer[] = []\n  flowDisables: DanmakuFlowDrawer[] = []\n  private readonly lineHeights: number[] = []\n  private readonly topLines: { [height: string]: DanmakuDrawer | null } = {}\n  private readonly bottomLines: any = {}\n  private readonly flowLines: any = {}\n  private displayArea: number = 0\n\n  private topY = 0\n  private flowY = 0\n  private bottomY = 0\n\n  // 上一帧的生成时间\n  private frameTime: number = 0\n  // 计算弹幕坐标的时间\n  private calcDanmakuTime: number = 0\n\n  isShow = true\n\n  private width = 0\n  private height = 0\n  private calcTopInterval: number = -1\n  private destroied: boolean = false\n\n  private event: EventEmitter\n  private addDanmakuToCanvasTime: number = 0\n  private lastFrame: number = 0\n  private lineHeight!: number\n\n  constructor (player: Player) {\n    this.player = player\n    this.event = new EventEmitter()\n\n    this.canvas = new Canvas(player)\n\n    const hideMenu = () => {\n      document.removeEventListener('click', hideMenu)\n      document.removeEventListener('contextmenu', hideMenu)\n      this.$menu.remove()\n    }\n\n    this.canvas.$canvas.addEventListener('contextmenu', (e: MouseEvent) => {\n      const found = this.findDrawers(e)\n      if (found.length > 0) {\n        this.createDanmakuMenu(found)\n\n        let x = e.pageX\n        let y = e.pageY\n        const right = e.clientX + this.$menu.clientWidth\n        const bottom = e.clientY + this.$menu.clientHeight\n\n        if (right > document.body.clientWidth) {\n          x -= right - document.body.clientWidth\n        }\n        if (bottom > document.body.clientHeight) {\n          y -= bottom - document.body.clientHeight\n        }\n        this.$menu.style.left = x + 'px'\n        this.$menu.style.top = y + 'px'\n        document.addEventListener('click', hideMenu)\n        document.addEventListener('touchstart', hideMenu)\n        document.addEventListener('contextmenu', hideMenu)\n      }\n      e.preventDefault()\n      e.stopPropagation()\n      return false\n    })\n\n    this.player.$video.addEventListener('seeked', () => {\n      this.clear()\n    })\n\n    if (this.player.options.danmaku.enable) {\n      this.show()\n    } else {\n      this.hide()\n    }\n    this.loop()\n  }\n\n  private createDanmakuMenu (drawers: DanmakuDrawer[]) {\n    if (this.$menu) this.$menu.remove()\n    this.$menu = document.createElement('div')\n    this.$menu.className = 'float show danmaku-context-menu'\n    for (let i = 0; i < drawers.length; i++) {\n      const drawer = drawers[i]\n      if (this.player.options.danmaku.contextMenu) {\n        const $menu = MakeDanmakuDrawerMenu(drawer, this.player.options.danmaku.contextMenu(drawer), text => this.copyText(text))\n        this.$menu.append($menu)\n      }\n    }\n    document.body.append(this.$menu)\n  }\n\n  show () {\n    this.isShow = true\n  }\n\n  hide () {\n    this.isShow = false\n    this.canvas.clear()\n  }\n\n  clear () {\n    this.showed.length = 0\n    this.canvas.clear()\n    this.canvas.clearCache()\n    this.topAndBottomDisables.push(...this.topEnables)\n    this.topEnables.length = 0\n    this.flowDisables.push(...this.flowEnables)\n    this.flowEnables.length = 0\n  }\n\n  resize () {\n    this.width = this.player.$root.clientWidth\n    this.height = this.player.$root.clientHeight\n    this.lineHeight = Math.round(this.canvas.fontHeight(this.player.options.fontSize))\n\n    this.lineHeights.length = 0\n    // 每次resize都计算屏幕最大行数\n    for (let y = 0; y < window.screen.height; y++) {\n      const height = y * this.lineHeight\n      if (height > window.screen.height) break\n      this.lineHeights.push(height)\n\n      if (!this.topLines.hasOwnProperty(height)) {\n        this.topLines[height] = null\n      }\n      if (!this.bottomLines.hasOwnProperty(height)) {\n        this.bottomLines[height] = []\n      }\n      if (!this.flowLines.hasOwnProperty(height)) {\n        this.flowLines[height] = []\n      }\n    }\n\n    this.canvas.resize()\n    const limit = this.player.options.danmaku.limit\n    if (limit === LimitType.Percent75) {\n      this.displayArea = this.player.height * 0.75\n    } else if (limit === LimitType.Half) {\n      this.displayArea = this.player.height * 0.5\n    } else if (limit === LimitType.Percent25) {\n      this.displayArea = this.player.height * 0.25\n    } else {\n      this.displayArea = this.player.height\n    }\n    this.canvas.alpha = this.player.options.danmaku.alpha\n    this.canvas.renderAll()\n  }\n\n  toggle (): void {\n    if (this.isShow) {\n      this.hide()\n    } else {\n      this.show()\n    }\n  }\n\n  send (d: Danmaku) {\n    d.text = d.text.trim()\n    this.danmakus.push(d)\n  }\n\n  private findDrawers (e: MouseEvent): DanmakuDrawer[] {\n    return [\n      ...this.topEnables.filter(drawer => DanmakuLayer.find(e, drawer)),\n      ...this.bottomEnables.filter(drawer => DanmakuLayer.find(e, drawer)),\n      ...this.flowEnables.filter(drawer => DanmakuLayer.find(e, drawer))\n    ]\n  }\n\n  private static find (e: MouseEvent, drawer: DanmakuDrawer): boolean {\n    if (e.offsetX > drawer.left && e.offsetX < (drawer.left + drawer.width)) {\n      if (e.offsetY > drawer.top && e.offsetY < (drawer.top + drawer.height)) {\n        return true\n      }\n    }\n    return false\n  }\n\n  private addDanmakuToCanvas () {\n    if (this.danmakus.length === 0) return\n    for (let i = 0; i < this.danmakus.length; i++) {\n      const danmaku = this.danmakus[i]\n      const time = Math.abs(this.player.currentTime - danmaku.currentTime)\n      if (this.showed.includes(danmaku)) continue\n      if (time > 0.1) continue\n      this.showed.push(danmaku)\n\n      let top\n      if (danmaku.type === DanmakuType.Flow) {\n        let drawer = this.flowDisables.shift() || new DanmakuFlowDrawer()\n        drawer.enable = true\n        drawer.set(danmaku, this.width, this.calcFlowTop(drawer))\n        drawer.update(this.width, this.player.options.danmaku.flowDuration, 0)\n        this.flowEnables.push(drawer)\n        this.canvas.addDrawer(drawer)\n      } else {\n        let drawer = this.topAndBottomDisables.shift() || new DanmakuFixedDrawer()\n        drawer.enable = true\n        if (danmaku.type === DanmakuType.Top) {\n          drawer.set(danmaku, this.player.options.danmaku.fadeoutDuration, this.width, this.calcTopTop(drawer))\n          this.topEnables.push(drawer)\n        } else {\n          let top = this.calcBottomTop(drawer) + this.lineHeight\n          top = this.height - top\n          drawer.set(danmaku, this.player.options.danmaku.fadeoutDuration, this.width, top)\n          this.bottomEnables.push(drawer)\n        }\n        drawer.update(0)\n        this.canvas.addDrawer(drawer)\n      }\n      this.canvas.renderAll()\n    }\n  }\n\n  $input!: HTMLInputElement\n\n  copyText (text: string) {\n    if (!this.$input) {\n      this.$input = this.player.$root.querySelector('input.copy-tool') as HTMLInputElement\n    }\n    this.$input.value = text\n    this.$input.select()\n    document.execCommand('copy')\n  }\n\n  private calcFlowTop (drawer: DanmakuFlowDrawer): number {\n    for (let key in this.flowLines) {\n      const _d: DanmakuDrawer = this.flowLines[key]\n      const height = Number(key)\n      const right = _d.left + _d.width\n      if (_d && _d.enable && right > this.width) continue\n      if (height > this.displayArea) break\n      console.log('发现空行', key)\n      this.flowLines[key] = drawer\n      this.flowY = height\n      return height\n    }\n    this.flowY += this.lineHeight\n    if (this.flowY > this.displayArea) this.flowY = 0\n    this.flowLines[this.flowY] = drawer\n    return this.flowY\n  }\n\n  private calcTopTop (drawer: DanmakuFixedDrawer): number {\n    for (let key in this.topLines) {\n      const _d = this.topLines[key]\n      const height = Number(key)\n      if (_d && _d.enable) continue\n      if (height > this.displayArea) break\n      console.log('发现空行', key)\n      this.topLines[key] = drawer\n      this.topY = height\n      return height\n    }\n    this.topY += this.lineHeight\n    if (this.topY > this.displayArea) this.topY = 0\n    this.topLines[this.topY] = drawer\n    return this.topY\n  }\n\n  private calcBottomTop (drawer: DanmakuFixedDrawer): number {\n    for (let key in this.bottomLines) {\n      const _d = this.bottomLines[key]\n      const height = Number(key)\n      if (_d && _d.enable) continue\n      if (height > this.displayArea) break\n      console.log('发现空行', key)\n      this.bottomLines[key] = drawer\n      this.bottomY = height\n      return height\n    }\n    this.bottomY += this.lineHeight\n    if (this.bottomY > this.displayArea) this.bottomY = 0\n    this.bottomLines[this.bottomY] = drawer\n    return this.bottomY\n  }\n\n  /**\n   * 绘制弹幕\n   */\n  private drawDanmaku () {\n    this.topEnables = this.topEnables.filter(drawer => {\n      if (drawer.enable) {\n        drawer.update(this.frameTime)\n        return true\n      } else {\n        this.canvas.removeDrawer(drawer)\n        this.topAndBottomDisables.push(drawer)\n        return false\n      }\n    })\n\n    this.bottomEnables = this.bottomEnables.filter(drawer => {\n      if (drawer.enable) {\n        drawer.update(this.frameTime)\n        return true\n      } else {\n        this.canvas.removeDrawer(drawer)\n        this.topAndBottomDisables.push(drawer)\n        return false\n      }\n    })\n\n    this.flowEnables = this.flowEnables.filter(drawer => {\n      if (drawer.enable) {\n        drawer.update(this.width, this.player.options.danmaku.flowDuration, this.frameTime)\n        return true\n      } else {\n        this.canvas.removeDrawer(drawer)\n        this.flowDisables.push(drawer)\n        return false\n      }\n    })\n  }\n\n  private loop () {\n    if (this.destroied) return\n    this.addDanmakuToCanvas()\n    this.addDanmakuToCanvasTime = (Date.now() - this.lastFrame) / 1000\n    if (!this.player.paused) {\n      this.drawDanmaku()\n      this.calcDanmakuTime = (Date.now() - this.lastFrame) / 1000\n\n      if (this.isShow) {\n        this.canvas.renderAll()\n      } else {\n        this.canvas.clear()\n      }\n    }\n    this.frameTime = (Date.now() - this.lastFrame) / 1000\n    this.lastFrame = Date.now()\n    window.requestAnimationFrame(() => { this.loop() })\n  }\n\n  destroy () {\n    this.destroied = true\n    clearInterval(this.calcTopInterval)\n    if (this.$menu) {\n      this.$menu.remove()\n    }\n  }\n\n  get debug (): Object {\n    return {\n      isShow: this.isShow,\n      all: this.danmakus.length,\n      showed: this.showed.length,\n      // 耗时\n      time: {\n        addDanmakuToCanvas: this.addDanmakuToCanvasTime,\n        drawDanmaku: this.calcDanmakuTime,\n        frameTime: this.frameTime\n      },\n      'on screen danmakus': {\n        top: this.topEnables.length,\n        bottom: this.bottomEnables.length,\n        flow: this.flowEnables.length\n      },\n      'danmaku pool': {\n        fixed: this.topAndBottomDisables.length,\n        flow: this.flowDisables.length\n      },\n      positionY: {\n        top: this.topY,\n        flow: this.flowY,\n        bottom: this.bottomY\n      }\n    }\n  }\n}\n","import { ButtonAndLayer } from '@/player/buttonAndLayer'\nimport { UI } from '@/player/UI'\nimport { DanmakuOptions, DanmakuType, MakeDanmakuOptions } from '@/player/danmaku/danmaku'\n\nconst template =\n  `<div>类型\n<div class=\"types\">\n  <div class=\"type\" data-type=\"1\"><div><svg class=\"icon\"><use xlink:href=\"#danplayer-danmugundongkai\"></use></svg></div>流动</div>\n  <div class=\"type\" data-type=\"0\"><div><svg class=\"icon\"><use xlink:href=\"#danplayer-danmudingbukai\"></use></svg></div>顶部</div>\n  <div class=\"type\" data-type=\"2\"><div><svg class=\"icon\"><use xlink:href=\"#danplayer-danmudibukai\"></use></svg></div>底部</div>\n</div>\n</div>\n<div>颜色\n<div class=\"colors\">\n{colors}\n</div>\n</div>`\n\nexport class DanmakuStyleLayer extends ButtonAndLayer {\n  private readonly $types: Element[]\n  private readonly $colors: Element[]\n  fill: string = '#ffffff'\n  type: DanmakuType = DanmakuType.Flow\n  static readonly colors = [\n    '#FE0302', '#FF7204', '#FFAA02', '#FFD302', '#FFFF00', '#A0EE00', '#00CD00',\n    '#019899', '#4266BE', '#89D5FF', '#CC0273', '#222222', '#9B9B9B', '#FFFFFF'\n  ]\n\n  constructor (ui: UI) {\n    super(ui)\n    this.$layer = this.player.$root.querySelector('.float.danmaku-style-layer') as HTMLElement\n    this.$btn = this.player.$root.querySelector('.intern-button.danmaku-style') as HTMLElement\n    this.$layer.innerHTML = template.replace('{colors}',\n      DanmakuStyleLayer.colors.map(color => `<span style=\"background: ${color}\" data-color=\"${color}\"></span>`).join(''))\n    this.init()\n    this.$types = Array.from(this.$layer.querySelectorAll<Element>('.types > .type'))\n    this.$colors = Array.from(this.$layer.querySelectorAll<Element>('.colors > span'))\n\n    this.$types.forEach($dom => $dom.addEventListener('click', () => {\n      this.$types.forEach($dom => $dom.classList.remove('selected'))\n      $dom.classList.add('selected')\n      this.type = Number($dom.getAttribute('data-type'))\n    }))\n\n    this.$colors.forEach($dom => $dom.addEventListener('click', () => {\n      this.$colors.forEach($dom => $dom.classList.remove('selected'))\n      $dom.classList.add('selected')\n      this.fill = $dom.getAttribute('data-color') as string\n    }))\n\n    this.$types[0].classList.add('selected')\n    this.$colors[this.$colors.length - 1].classList.add('selected')\n  }\n\n  public getStyle (): Partial<DanmakuOptions> {\n    return { fill: this.fill, type: this.type, borderColor: 'white' }\n  }\n}\n","import { UI } from '@/player/UI'\nimport { DanmakuStyleLayer } from '@/player/danmaku/danmakuStyleLayer'\nimport { Danmaku } from '@/player/danmaku/danmaku'\n\nexport class DanmakuForm {\n  ui: UI\n  $root: HTMLElement\n  $btn: HTMLElement\n  $input: HTMLInputElement\n  isShow = false\n  styleLayer: DanmakuStyleLayer\n\n  constructor (ui: UI) {\n    this.ui = ui\n    this.styleLayer = new DanmakuStyleLayer(ui)\n\n    this.$root = ui.player.$root.querySelector('.danmaku-form') as HTMLElement\n    this.$input = this.$root.querySelector('input') as HTMLInputElement\n    this.$btn = this.$root.querySelector('.send') as HTMLElement\n    this.$btn.addEventListener('click', () => this.send())\n    this.$input.addEventListener('keypress', (e: KeyboardEvent) => {\n      // console.log('弹幕表单 keypress', e.key)\n      if (e.key === 'Enter' && this.ui.isShow && this.$input.value) {\n        this.send()\n      }\n    })\n    this.$input.addEventListener('keydown', (e: KeyboardEvent) => {\n      // console.log('弹幕表单 keydown', e.key)\n      if (e.key.startsWith('Arrow') || e.key === ' ') {\n        e.stopPropagation()\n      }\n    })\n    this.$input.addEventListener('keyup', (e: KeyboardEvent) => {\n      // console.log('弹幕表单 keyup', e.key)\n      if (e.key === 'Escape') {\n        this.ui.player.$root.focus()\n        this.ui.hide()\n      }\n      e.stopPropagation()\n    })\n    this.$input.addEventListener('focus', () => { this.ui.isMouseInUI = true })\n    this.$input.addEventListener('blur', () => { this.ui.isMouseInUI = false })\n  }\n\n  send () {\n    const options = this.styleLayer.getStyle()\n    options.currentTime = this.ui.player.currentTime\n    this.ui.danmakuLayer.send(new Danmaku(this.$input.value, options))\n    this.$input.value = ''\n    this.ui.player.$root.focus()\n  }\n\n  toggle () {\n    if (this.isShow) {\n      this.hide()\n    } else {\n      this.show()\n    }\n  }\n\n  show () {\n    this.isShow = true\n    this.$root.style.display = ''\n  }\n\n  hide () {\n    this.isShow = false\n    this.$root.style.display = 'none'\n  }\n\n  update () {\n  }\n\n  focus () {\n    this.$input.focus()\n  }\n}\n","import { Player } from '@/player/player'\nimport { VolumeLayer } from '@/player/volumeLayer'\nimport { QualitySelector } from '@/player/qualitySelector'\nimport { ProgressBar } from '@/player/progressBar'\nimport { DanmakuLayer } from '@/player/danmaku/danmakuLayer'\nimport { DanmakuStyleLayer } from '@/player/danmaku/danmakuStyleLayer'\nimport { DanmakuForm } from '@/player/danmaku/danmakuForm'\nimport { IconButton } from '@/player/IconButton'\n\nexport class UI {\n  qualitySelector: QualitySelector\n\n  private _isMouseInUI: boolean = false\n  danmakuLayer: DanmakuLayer\n  player: Player\n  isShow: boolean = false\n\n  private $root: HTMLElement\n\n  // 控制器按钮\n  private btnPlay: IconButton\n  private btnFullScreen: IconButton\n  private btnShowDanmaku: IconButton\n  private $gradientBG: HTMLElement\n  private extraButtons: Element[] = []\n\n  volume: VolumeLayer\n  progressBar: ProgressBar\n  styleLayer: DanmakuStyleLayer\n  danmakuForm: DanmakuForm\n\n  // 右边按钮区别\n  private $controllerButtonsRightLayout: Element\n\n  private hideTimeout = -1\n\n  constructor (player: Player) {\n    this.player = player\n    this.$root = player.$root.querySelector('.interactive-layer .controller-bottom-bar') as HTMLElement\n    this.$root.addEventListener('mouseenter', () => {\n      this.isMouseInUI = true\n    })\n    this.$root.addEventListener('mouseleave', () => {\n      this.isMouseInUI = false\n    })\n    this.$gradientBG = player.$root.querySelector('.bg-gradient') as HTMLElement\n\n    this.volume = new VolumeLayer(this)\n    this.qualitySelector = new QualitySelector(this)\n    this.progressBar = new ProgressBar(this)\n    this.styleLayer = new DanmakuStyleLayer(this)\n    this.danmakuForm = new DanmakuForm(this)\n\n    this.$controllerButtonsRightLayout = this.$root.querySelector('.buttons .right') as Element\n\n    this.btnFullScreen = new IconButton(this.$root.querySelector('.button.full-screen') as HTMLElement)\n    this.btnFullScreen.$root.addEventListener('click', async () => {\n      await this.player.toggleFullScreen()\n      this.updateFullScreenButton()\n    })\n\n    this.btnPlay = new IconButton(this.$root.querySelector('.button.play') as HTMLElement)\n    this.btnPlay.$root.addEventListener('click', () => {\n      this.player.toggle()\n      this.updatePlayButton()\n    })\n\n    this.btnShowDanmaku = new IconButton(this.$root.querySelector('.button.toggle-danamaku') as HTMLElement)\n    this.btnShowDanmaku.$root.addEventListener('click', () => {\n      this.danmakuLayer.toggle()\n      this.updateDanmakuButton()\n    })\n\n    this.danmakuLayer = new DanmakuLayer(player)\n\n    this.insertExtraButtons()\n  }\n\n  set isMouseInUI (val: boolean) {\n    this._isMouseInUI = val\n    this.cancelHideUIDelay()\n  }\n\n  get isMouseInUI () {\n    return this._isMouseInUI\n  }\n\n  show () {\n    this.isShow = true\n    this.$root.classList.add('show')\n    this.$gradientBG.classList.add('show')\n  }\n\n  hide () {\n    this.isShow = false\n    this.$root.classList.remove('show')\n    this.$gradientBG.classList.remove('show')\n    this.qualitySelector.hideLayer()\n    this.volume.hideLayer()\n    this.danmakuForm.styleLayer.hideLayer()\n    this.player.$root.focus()\n  }\n\n  hideUIDelay () {\n    this.cancelHideUIDelay()\n    return new Promise(resolve => {\n      this.hideTimeout = window.setTimeout(() => {\n        this.hide()\n        resolve()\n      }, this.player.options.uiFadeOutDelay)\n    })\n  }\n\n  cancelHideUIDelay () {\n    clearTimeout(this.hideTimeout)\n  }\n\n  clearExtraButtons () {\n    this.extraButtons.forEach($btn => $btn.remove())\n    this.extraButtons.length = 0\n  }\n\n  insertExtraButtons () {\n    this.clearExtraButtons()\n    if (this.player.options.extraButtons) {\n      this.player.options.extraButtons.forEach($btn => {\n        $btn.classList.add('button')\n        $btn.classList.remove('intern-button')\n      })\n      this.$controllerButtonsRightLayout.prepend(...this.player.options.extraButtons)\n      this.extraButtons.push(...this.player.options.extraButtons)\n    }\n  }\n\n  update () {\n    this.updateDanmakuButton()\n    this.updateFullScreenButton()\n    this.updatePlayButton()\n    this.danmakuForm.update()\n    this.progressBar.update()\n    this.volume.update()\n  }\n\n  updatePlayButton () {\n    if (this.player.paused) {\n      this.btnPlay.switch('data-on', 'data-on-title')\n    } else {\n      this.btnPlay.switch('data-off', 'data-off-title')\n    }\n  }\n\n  updateFullScreenButton () {\n    if (this.player.isFullScreen) {\n      this.btnFullScreen.switch('data-off', 'data-off-title')\n    } else {\n      this.btnFullScreen.switch('data-on', 'data-on-title')\n    }\n  }\n\n  updateDanmakuButton () {\n    let attr: string\n    let title: string\n    if (this.danmakuLayer.isShow) {\n      attr = 'data-off'\n      title = 'data-off-title'\n    } else {\n      attr = 'data-on'\n      title = 'data-on-title'\n    }\n    this.btnShowDanmaku.switch(attr, title)\n  }\n\n  resize () {\n    if (this.volume.isShow) this.volume.updateLayerPosition()\n    if (this.qualitySelector.isShow) this.qualitySelector.updateLayerPosition()\n    this.progressBar.resize()\n    this.danmakuLayer.resize()\n  }\n\n  destroy () {\n    clearTimeout(this.hideTimeout)\n    this.danmakuLayer.destroy()\n    this.qualitySelector.destroy()\n    this.volume.destroy()\n  }\n\n  get debug (): Object {\n    return {\n      isShow: this.isShow,\n      isMouseInUI: this._isMouseInUI,\n      danmakuLayer: this.danmakuLayer.debug\n    }\n  }\n}\n","import './style.scss'\nimport { Danmaku } from '@/player/danmaku/danmaku'\nimport { UI } from '@/player/UI'\nimport { DanmakuLayerOptions, MakeDanmakuLayerOptions } from '@/player/danmaku/danmakuLayer'\n\nconst icon = '//at.alicdn.com/t/font_1373341_m9a3piei0s.js'\n\nconst template = `{video-layer}\n<input class=\"copy-tool\" />\n<div class=\"interactive-layer\">\n  <canvas class=\"danmaku-layer\"></canvas>\n  \n  <div class=\"bg-gradient show\"></div>\n  \n  \n  <div class=\"float danmaku-style-layer\"></div>\n  \n  <div class=\"float volume-bar\">\n    <div class=\"volume-num-label\"></div>\n    <div class=\"volume-column-bar\">\n      <div class=\"bar-ui bar-full\"></div>\n      <div class=\"bar-ui bar-current\"></div>\n      <div class=\"bar-controller\"></div>\n    </div>\n  </div>\n  \n  <div class=\"float quality-menu\"></div>\n  \n  <div class=\"controller-bottom-bar\">\n    <div class=\"progress-bar live-hide\">\n      <div class=\"bar-full\"></div>\n      <div class=\"bar-buffer\"></div>\n      <div class=\"bar-current\"></div>\n      <div class=\"bar-controller\"></div>    \n    </div>\n    \n    <div class=\"buttons\">\n      <div class=\"left\">\n        <div class=\"button intern-button play\" data-on=\"danplayer-bofang\" data-off=\"danplayer-zanting\"\n          data-on-title=\"播放视频\" data-off-title=\"暂停播放\">\n          <svg class=\"icon\" aria-hidden=\"true\"><use xlink:href=\"#danplayer-bofang\"></use></svg>\n        </div>\n        <div class=\"time\"></div>\n      </div>\n      \n      <div class=\"middle danmaku-form\">\n        <div class=\"button intern-button danmaku-style\">\n          <svg class=\"icon\"><use xlink:href=\"#danplayer-style\"></use></svg>\n        </div>\n        <input placeholder=\"输入弹幕内容\" tabindex=\"1\">\n        <div class=\"send\">发送</div>\n      </div>\n      <div class=\"right\">\n      \n        <div class=\"button intern-button volume\" data-on=\"danplayer-yinliang\" data-off=\"danplayer-jingyin\" title=\"音量\">\n          <svg class=\"icon\"><use xlink:href=\"#danplayer-yinliang\"></use></svg>\n        </div>\n        \n        <div class=\"button intern-button toggle-danamaku\" title=\"隐藏弹幕\"\n          data-on=\"danplayer-danmukai\" data-off=\"danplayer-danmuguan\" \n          data-on-title=\"显示弹幕\" data-off-title=\"隐藏弹幕\">\n          <svg class=\"icon\"><use xlink:href=\"#danplayer-danmukai\"></use></svg>\n        </div>\n        \n        <div class=\"button quality\" title=\"切换画质\"></div>\n        \n        <div class=\"button intern-button full-screen\" data-on=\"danplayer-quanping\" data-off=\"danplayer-zuixiaohua\"\n        data-on-title=\"全屏观看\" data-off-title=\"取消全屏\">\n          <svg class=\"icon\"><use xlink:href=\"#danplayer-quanping\"></use></svg>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>`\n\ninterface PlayerOptions {\n  /**\n   * 直播模式\n   * 没有进度条\n   */\n  live: boolean\n\n  // 音量\n  volume: number\n\n  autoplay: boolean,\n\n  fontSize: number,\n\n  // ui 的隐藏时间\n  uiFadeOutDelay: number\n\n  // 视频寸尺\n  width: number | string\n  height: number | string\n\n  // 视频来源，也可以在<video src=\"\"></video>的src设置\n  src: string\n\n  // iconfont Symbol方式 代码\n  iconSrc: string\n\n  // 扩展按钮\n  extraButtons: Element[]\n\n  // 弹幕层的配置\n  danmaku: DanmakuLayerOptions\n\n  fullScreen: boolean\n\n  danmakuForm: boolean\n\n  onlyOne: boolean\n\n  color: string\n}\n\nexport interface PlayerPublicOptions {\n  /**\n   * 直播模式\n   * 没有进度条\n   */\n  live: boolean\n\n  // 音量\n  volume: number\n\n  autoplay: boolean,\n\n  fontSize: number,\n\n  // ui 的隐藏时间\n  uiFadeOutDelay: number\n\n  // 视频寸尺\n  width: number | string\n  height: number | string\n\n  // 视频来源，也可以在<video src=\"\"></video>的src设置\n  src: string\n\n  iconSrc: string\n\n  // 扩展按钮\n  extraButtons: Element[]\n\n  // 弹幕层的配置\n  danmaku: Partial<DanmakuLayerOptions>\n\n  fullScreen: boolean\n\n  danmakuForm: boolean\n\n  onlyOne: boolean\n\n  color: string\n}\n\nenum VideoType {\n  Normal,\n  Hls,\n  Dash\n}\n\nfunction MakeDefaultOptions ({\n  autoplay = false,\n  color = '#00a1d6',\n  live = false,\n  volume = 0.7,\n  fontSize = 28,\n  width = 600,\n  height = 350,\n  uiFadeOutDelay = 3000,\n  extraButtons = [],\n  src = '',\n  iconSrc = icon,\n  danmakuForm = true,\n  fullScreen = true,\n  danmaku = {},\n  onlyOne = false\n}: Partial<PlayerOptions> | Partial<PlayerPublicOptions>): PlayerOptions {\n  return {\n    autoplay,\n    color,\n    live,\n    fontSize,\n    height,\n    danmaku: MakeDanmakuLayerOptions(danmaku),\n    danmakuForm,\n    fullScreen,\n    src,\n    iconSrc,\n    uiFadeOutDelay,\n    extraButtons,\n    onlyOne,\n    volume,\n    width\n  }\n}\n\nexport class Player {\n  private static instances: Player[] = []\n  $root: HTMLElement\n  $video: HTMLVideoElement\n  type = VideoType.Normal\n  hls?: Hls\n\n  public ui: UI\n\n  // 尺寸\n  private _width: string = ''\n  private _height: string = ''\n\n  get width () {\n    return this.$root.clientWidth\n  }\n\n  get height () {\n    return this.$root.clientHeight\n  }\n\n  isFullScreen: boolean = false\n\n  private _duration: number = 0\n  private _loading = true\n  private _paused = true\n\n  get loading () {\n    return this._loading\n  }\n\n  public options: PlayerOptions\n\n  constructor ($e: HTMLVideoElement, options?: Partial<PlayerPublicOptions>) {\n    if (!document.querySelector('script#danplayer-icon')) {\n      const $icon = document.createElement('script')\n      $icon.src = icon\n      $icon.id = 'danplayer-icon'\n      document.body.append($icon)\n    }\n    Player.instances.push(this)\n    const parent = $e.parentElement as Element\n    this.$root = document.createElement('div')\n    this.$root.setAttribute('tabIndex', '0')\n    this.$root.classList.add('video-player')\n    parent.insertBefore(this.$root, $e)\n    $e.classList.add('video-layer')\n    $e.removeAttribute('id')\n    this.$root.innerHTML = template.replace('{video-layer}', $e.outerHTML)\n    $e.remove()\n\n    this.$root.addEventListener('keypress', (e: KeyboardEvent) => {\n      // console.log('keypress', e.key)\n      let stop = true\n      if (e.key === 'Enter') {\n        this.ui.show()\n        this.ui.danmakuForm.focus()\n      } else { stop = false }\n      if (stop) {\n        e.stopPropagation()\n        e.preventDefault()\n      }\n    })\n    this.$root.addEventListener('keyup', (e: KeyboardEvent) => {\n      if (e.key === ' ') this.toggle()\n    })\n    document.addEventListener('fullscreenchange', () => {\n      this.isFullScreen = document.fullscreenElement === this.$root\n      this.ui.updateFullScreenButton()\n    })\n\n    this.$root.addEventListener('keydown', (e: KeyboardEvent) => {\n      // console.log('keydown', e.key)\n      let stop = true\n      if (e.key === 'ArrowLeft' && !this.options.live) {\n        this.$video.currentTime -= 5\n      } else if (e.key === 'ArrowRight' && !this.options.live) {\n        this.$video.currentTime += 5\n      } else if (e.key === 'ArrowUp') {\n        this.ui.volume.up()\n      } else if (e.key === 'ArrowDown') {\n        this.ui.volume.down()\n      } else { stop = false }\n      if (stop) {\n        e.stopPropagation()\n        e.preventDefault()\n      }\n    })\n\n    this.$root.addEventListener('mousemove', () => {\n      this.$root.classList.remove('mouse-idle')\n      this.ui.show()\n      if (this.paused) {\n\n      } else {\n        if (this.ui.isMouseInUI) return\n        this.ui.hideUIDelay().then(() => {\n          this.$root.classList.add('mouse-idle')\n        })\n      }\n    })\n\n    this.$root.addEventListener('mouseenter', () => {\n      this.ui.show()\n      this.ui.cancelHideUIDelay()\n    })\n    this.$root.addEventListener('mouseleave', () => {\n      this.ui.hide()\n      this.ui.cancelHideUIDelay()\n    })\n\n    this.$video = this.$root.querySelector('.video-layer') as HTMLVideoElement\n    this.$video.removeAttribute('controls')\n    this.$video.addEventListener('durationchange', () => {\n      // console.log('视频长度', this.$video.duration)\n      this._duration = this.$video.duration\n    })\n\n    this.$video.addEventListener('playing', () => this.ui.hideUIDelay())\n\n    this.$video.addEventListener('play', () => this.ui.updatePlayButton())\n    this.$video.addEventListener('pause', () => this.ui.updatePlayButton())\n\n    window.addEventListener('resize', () => this.resizeEvt(1000))\n\n    this.options = MakeDefaultOptions(options || { autoplay: this.$video.hasAttribute('autoplay') })\n\n    this.ui = new UI(this)\n    this.ui.update()\n\n    this._setSrc().then()\n    this._setUI()\n  }\n\n  private async _setSrc () {\n    if (this.options.src) {\n      this.$video.setAttribute('src', this.options.src)\n    }\n\n    await this.getContentType()\n\n    this.ui.qualitySelector.hideButton()\n    if (this.hls) {\n      this.hls.on(Hls.Events.LEVEL_LOADED, () => {\n        this.ui.qualitySelector.updateLevel(this.hls as Hls)\n      })\n      this.ui.qualitySelector.showButton()\n    }\n\n    console.log('_set', { autoplay: this.options.autoplay, paused: this._paused })\n    if (this.options.autoplay || !this.paused) {\n      console.log('_set 播放')\n      this.play()\n    }\n\n    if (this.options.live) {\n      this.$root.classList.add('live')\n    } else {\n      this.$root.classList.remove('live')\n    }\n  }\n\n  private _setUI () {\n    this.ui.insertExtraButtons()\n\n    this.ui.update()\n\n    this.ui.progressBar.resize()\n\n    this.ui.progressBar.resetTimeZone()\n\n    this.resize()\n  }\n\n  set (options: Partial<PlayerPublicOptions>) {\n    options.danmaku = Object.assign({}, this.options.danmaku, options.danmaku)\n    const newOptions = Object.assign({}, this.options, options)\n    const hasChange = newOptions.src !== this.options.src || this.options.live !== newOptions.live\n    // console.log('set hasChange', hasChange, { nowLive: this.options.live, newLive: newOptions.live })\n    this.options = newOptions\n    if (hasChange) {\n      if (this.hls) {\n        this.hls.detachMedia()\n        this.hls = undefined\n      }\n      this._setSrc().then()\n    }\n    this._setUI()\n  }\n\n  resize () {\n    if (this.options.width) {\n      if (typeof this.options.width === 'number' || parseInt(this.options.width).toString() === this.options.width) {\n        this._width = this.options.width + 'px'\n      } else {\n        this._width = this.options.width\n      }\n    }\n    if (this.options.height) {\n      if (typeof this.options.height === 'number' || parseInt(this.options.height).toString() === this.options.height) {\n        this._height = this.options.height + 'px'\n      } else {\n        this._height = this.options.height\n      }\n    }\n    // console.log('resize options', this.options, { width: this._width, height: this._height })\n    if (!this.isFullScreen) {\n      this.$root.style.width = this._width\n      this.$root.style.height = this._height\n    }\n    this.ui.resize()\n  }\n\n  private delayResize: number = -1\n\n  private resizeEvt (ms: number) {\n    window.clearTimeout(this.delayResize)\n    this.delayResize = window.setTimeout(() => {\n      this.resize()\n    }, ms)\n  }\n\n  /**\n   * 批量填充弹幕\n   */\n  fillDanmakus (array: Danmaku[]) {\n    this.ui.danmakuLayer.danmakus.push(...array)\n  }\n\n  get currentTime () {\n    return this.$video.currentTime\n  }\n\n  sendDanmaku (danmaku: Danmaku) {\n    this.ui.danmakuLayer.send(danmaku)\n  }\n\n  get paused () {\n    return this._paused\n  }\n\n  toggle () {\n    if (this.paused) {\n      this.play()\n    } else {\n      this.pause()\n    }\n  }\n\n  play () {\n    this._paused = false\n    this.$video.play().then()\n    if (this.options.onlyOne) {\n      Player.instances.forEach(player => {\n        if (player !== this) {\n          player.pause()\n        }\n      })\n    }\n  }\n\n  pause () {\n    this._paused = true\n    this.$video.pause()\n  }\n\n  private async getContentType () {\n    const src = this.$video.getAttribute('src') as string\n    console.log('视频网址', src)\n    if (src) {\n      if (src.match(/\\.m3u[8]/)) this.type = VideoType.Hls\n      if (src.match(/\\.mpd/)) this.type = VideoType.Dash\n      this.options.src = src\n    }\n    if (this.type === VideoType.Hls) {\n      console.log('使用Hls.js')\n      if (Hls.isSupported()) {\n        this.hls = new Hls()\n        this.hls.config.capLevelToPlayerSize = true\n        this.hls.attachMedia(this.$video)\n        this.hls.loadSource(src)\n      } else {\n        const http = new XMLHttpRequest()\n        http.open('Get', src)\n        http.send()\n        const contentType: string | null = await new Promise(resolve => {\n          http.onreadystatechange = () => {\n            if (http.readyState === XMLHttpRequest.HEADERS_RECEIVED) {\n              if (http.status === 200) {\n                resolve(http.getResponseHeader('Content-Type') as string)\n              } else {\n                resolve(null)\n              }\n              http.abort()\n            }\n          }\n        })\n        console.log({ contentType })\n        if (contentType && this.$video.canPlayType(contentType)) {\n          this.options.src = this.$video.src = src\n        }\n      }\n    } else if (this.type === VideoType.Dash) {\n      console.log('使用dash.js')\n    }\n  }\n\n  /**\n   * 切换全屏模式\n   */\n  async toggleFullScreen () {\n    this.isFullScreen = !this.isFullScreen\n    if (this.isFullScreen) {\n      await this.$root.requestFullscreen()\n    } else {\n      await document.exitFullscreen()\n    }\n    this.resize()\n  }\n\n  /**\n   * 销毁\n   */\n  destroy () {\n    Player.instances.splice(Player.instances.indexOf(this), 1)\n    this.ui.destroy()\n    if (this.hls) {\n      this.hls.detachMedia()\n    }\n  }\n\n  get debug (): Object {\n    let quality = '默认'\n    let src = this.options.src\n    if (this.hls) {\n      if (this.ui.qualitySelector.currentLevel === -1) {\n        quality = '自动 '\n      } else {\n        quality = ''\n      }\n      if (this.hls.currentLevel !== -1) {\n        quality += this.hls.levels[this.hls.currentLevel].name + 'P'\n      }\n    }\n    return {\n      width: this.width,\n      height: this.height,\n      src,\n      quality,\n      ui: this.ui.debug\n    }\n  }\n}\n","import { Player } from '@/player/player'\nimport { MakeDanmakuOptions } from '@/player/danmaku/danmaku'\nimport { MakeDanmakuLayerOptions } from '@/player/danmaku/danmakuLayer'\n\nexport default {\n  Player: Player,\n  MakeDanmakuOptions: MakeDanmakuOptions,\n  MakeDanmakuLayerOptions: MakeDanmakuLayerOptions\n}\n","import './setPublicPath'\nimport mod from '~entry'\nexport default mod\nexport * from '~entry'\n"],"sourceRoot":""}