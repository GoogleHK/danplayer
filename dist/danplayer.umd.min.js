!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.danplayer=e():t.danplayer=e()}("undefined"!=typeof self?self:this,function(){return(i={},r.m=n={1441:function(t,e,n){},"5fe9":function(t,e,n){"use strict";function i(t,e){return void 0===e&&(e=12),+parseFloat(t.toPrecision(e))}function u(t){var e=t.toString().split(/[eE]/),n=(e[0].split(".")[1]||"").length-+(e[1]||0);return 0<n?n:0}function l(t){if(-1===t.toString().indexOf("e"))return Number(t.toString().replace(".",""));var e=u(t);return 0<e?i(t*Math.pow(10,e)):t}function c(t){f&&(t>Number.MAX_SAFE_INTEGER||Number.MIN_SAFE_INTEGER)}function h(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(0<n.length)return h.apply(void 0,[h(t,e),n[0]].concat(n.slice(1)));var r=l(t),o=l(e),s=u(t)+u(e),a=r*o;return c(a),a/Math.pow(10,s)}function o(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(0<n.length)return o.apply(void 0,[o(t,e),n[0]].concat(n.slice(1)));var r=Math.pow(10,Math.max(u(t),u(e)));return(h(t,r)+h(e,r))/r}function s(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(0<n.length)return s.apply(void 0,[s(t,e),n[0]].concat(n.slice(1)));var r=Math.pow(10,Math.max(u(t),u(e)));return(h(t,r)-h(e,r))/r}function a(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(0<n.length)return a.apply(void 0,[a(t,e),n[0]].concat(n.slice(1)));var r=l(t),o=l(e);return c(r),c(o),h(r/o,Math.pow(10,u(e)-u(t)))}function r(t,e){var n=Math.pow(10,e);return a(Math.round(h(t,n)),n)}Object.defineProperty(e,"__esModule",{value:!0});var f=!0;function d(t){void 0===t&&(t=!0),f=t}var p={strip:i,plus:o,minus:s,times:h,divide:a,round:r,digitLength:u,float2Fixed:l,enableBoundaryChecking:d};e.strip=i,e.plus=o,e.minus=s,e.times=h,e.divide=a,e.round=r,e.digitLength=u,e.float2Fixed=l,e.enableBoundaryChecking=d,e.default=p},"96cf":function(t,e,n){var i=function(o){"use strict";var u,t=Object.prototype,l=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",n=e.asyncIterator||"@@asyncIterator",i=e.toStringTag||"@@toStringTag";function s(t,e,n,i){var r=e&&e.prototype instanceof a?e:a,o=Object.create(r.prototype),s=new _(i||[]);return o._invoke=function(o,s,a){var u=h;return function(t,e){if(u===d)throw new Error("Generator is already running");if(u===p){if("throw"===t)throw e;return T()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){var i=x(n,a);if(i){if(i===v)continue;return i}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(u===h)throw u=p,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);u=d;var r=c(o,s,a);if("normal"===r.type){if(u=a.done?p:f,r.arg===v)continue;return{value:r.arg,done:a.done}}"throw"===r.type&&(u=p,a.method="throw",a.arg=r.arg)}}}(t,n,s),o}function c(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}o.wrap=s;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function a(){}function y(){}function m(){}var b={};b[r]=function(){return this};var g=Object.getPrototypeOf,w=g&&g(g(O([])));w&&w!==t&&l.call(w,r)&&(b=w);var k=m.prototype=a.prototype=Object.create(b);function $(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function L(u){var e;this._invoke=function(n,i){function t(){return new Promise(function(t,e){!function e(t,n,i,r){var o=c(u[t],u,n);if("throw"!==o.type){var s=o.arg,a=s.value;return a&&"object"==typeof a&&l.call(a,"__await")?Promise.resolve(a.__await).then(function(t){e("next",t,i,r)},function(t){e("throw",t,i,r)}):Promise.resolve(a).then(function(t){s.value=t,i(s)},function(t){return e("throw",t,i,r)})}r(o.arg)}(n,i,t,e)})}return e=e?e.then(t,t):t()}}function x(t,e){var n=t.iterator[e.method];if(n===u){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=u,x(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=c(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var r=i.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,v):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function _(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(l.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=u,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:u,done:!0}}return y.prototype=k.constructor=m,m.constructor=y,m[i]=y.displayName="GeneratorFunction",o.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,i in t||(t[i]="GeneratorFunction")),t.prototype=Object.create(k),t},o.awrap=function(t){return{__await:t}},$(L.prototype),L.prototype[n]=function(){return this},o.AsyncIterator=L,o.async=function(t,e,n,i){var r=new L(s(t,e,n,i));return o.isGeneratorFunction(e)?r:r.next().then(function(t){return t.done?t.value:r.next()})},$(k),k[i]="Generator",k[r]=function(){return this},k.toString=function(){return"[object Generator]"},o.keys=function(n){var i=[];for(var t in n)i.push(t);return i.reverse(),function t(){for(;i.length;){var e=i.pop();if(e in n)return t.value=e,t.done=!1,t}return t.done=!0,t}},o.values=O,_.prototype={constructor:_,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&l.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var i=this;function t(t,e){return o.type="throw",o.arg=n,i.next=t,e&&(i.method="next",i.arg=u),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e],o=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var s=l.call(r,"catchLoc"),a=l.call(r,"finallyLoc");if(s&&a){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&l.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),S(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;S(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=u),v}},o}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},a34a:function(t,e,n){t.exports=n("96cf")},ba10:function(t,e,n){"use strict";var i=Object.prototype.hasOwnProperty,d="~";function r(){}function a(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,n,i,r){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new a(n,i||t,r),s=d?d+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],o]:t._events[s].push(o):(t._events[s]=o,t._eventsCount++),t}function l(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(d=!1)),s.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)i.call(t,e)&&n.push(d?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},s.prototype.listeners=function(t){var e=d?d+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,r=n.length,o=new Array(r);i<r;i++)o[i]=n[i].fn;return o},s.prototype.listenerCount=function(t){var e=d?d+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,i,r,o){var s=d?d+t:t;if(!this._events[s])return!1;var a,u,l=this._events[s],c=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,i),!0;case 5:return l.fn.call(l.context,e,n,i,r),!0;case 6:return l.fn.call(l.context,e,n,i,r,o),!0}for(u=1,a=new Array(c-1);u<c;u++)a[u-1]=arguments[u];l.fn.apply(l.context,a)}else{var h,f=l.length;for(u=0;u<f;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),c){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,n);break;case 4:l[u].fn.call(l[u].context,e,n,i);break;default:if(!a)for(h=1,a=new Array(c-1);h<c;h++)a[h-1]=arguments[h];l[u].fn.apply(l[u].context,a)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,n,i){var r=d?d+t:t;if(!this._events[r])return this;if(!e)return l(this,r),this;var o=this._events[r];if(o.fn)o.fn!==e||i&&!o.once||n&&o.context!==n||l(this,r);else{for(var s=0,a=[],u=o.length;s<u;s++)(o[s].fn!==e||i&&!o[s].once||n&&o[s].context!==n)&&a.push(o[s]);a.length?this._events[r]=1===a.length?a[0]:a:l(this,r)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=d?d+t:t,this._events[e]&&l(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=d,s.EventEmitter=s,t.exports=s},f6fd:function(t,e){var n,i,r;n=document,i="currentScript",r=n.getElementsByTagName("script"),i in n||Object.defineProperty(n,i,{get:function(){try{throw new Error}catch(t){var e,n=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(t.stack)||[!1])[1];for(e in r)if(r[e].src==n||"interactive"==r[e].readyState)return r[e];return null}}})},faa1:function(t,e,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,c=r&&"function"==typeof r.apply?r.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var o=Number.isNaN||function(t){return t!=t};function s(){s.init.call(this)}((t.exports=s).EventEmitter=s).prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function u(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function l(t,e,n,i){var r,o,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n);if(void 0===(o=t._events)?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),s=o[e]),void 0===s)s=o[e]=n,++t._eventsCount;else if("function"==typeof s?s=o[e]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),0<(r=u(t))&&s.length>r&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,console&&console.warn}return t}function h(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=function(){for(var t=[],e=0;e<arguments.length;e++)t.push(arguments[e]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,c(this.listener,this.target,t))}.bind(i);return r.listener=n,i.wrapFn=r}function f(t,e,n){var i=t._events;if(void 0===i)return[];var r=i[e];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(r):p(r,r.length)}function d(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||o(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var i="error"===t,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(0<e.length&&(o=e[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var a=r[t];if(void 0===a)return!1;if("function"==typeof a)c(a,this,e);else{var u=a.length,l=p(a,u);for(n=0;n<u;++n)c(l[n],this,e)}return!0},s.prototype.on=s.prototype.addListener=function(t,e){return l(this,t,e,!1)},s.prototype.prependListener=function(t,e){return l(this,t,e,!0)},s.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.on(t,h(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);return this.prependListener(t,h(this,t,e)),this},s.prototype.off=s.prototype.removeListener=function(t,e){var n,i,r,o,s;if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e);if(void 0===(i=this._events))return this;if(void 0===(n=i[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,o=n.length-1;0<=o;o--)if(n[o]===e||n[o].listener===e){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,r),1===n.length&&(i[t]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",t,s||e)}return this},s.prototype.removeAllListeners=function(t){var e,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;0<=i;i--)this.removeListener(t,e[i]);return this},s.prototype.listeners=function(t){return f(this,t,!0)},s.prototype.rawListeners=function(t){return f(this,t,!1)},s.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return 0<this._eventsCount?i(this._events):[]}},fb15:function(t,e,n){"use strict";var i;n.r(e),"undefined"!=typeof window&&(n("f6fd"),(i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/))&&(n.p=i[1]));var r=n("a34a"),o=n.n(r),s=(n("1441"),n("5fe9")),a=n.n(s);function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var l,c,h,f=(l=d,(c=[{key:"init",value:function(){function t(){clearTimeout(n.hideTimeout),n.ui.isMouseInUI=!0,n.showLayer()}function e(){n.ui.isMouseInUI=!1,clearTimeout(n.hideTimeout),n.hideTimeout=setTimeout(function(){n.hideLayer()},n.layerHideDelay)}var n=this;this.$btn.addEventListener("mouseenter",t),this.$btn.addEventListener("mouseleave",e),this.$layer.addEventListener("mouseenter",t),this.$layer.addEventListener("mouseleave",e)}},{key:"showLayer",value:function(){this._isShow=!0,this.$layer.classList.add("show"),this.updateLayerPosition()}},{key:"hideLayer",value:function(){this._isShow=!1,this.$layer.classList.remove("show")}},{key:"toggleLayer",value:function(){this._isShow?this.hideLayer():this.showLayer()}},{key:"showButton",value:function(){this.$btn.style.display=""}},{key:"hideButton",value:function(){this.$btn.style.display="none"}},{key:"updateLayerPosition",value:function(){if(this._isShow){var t=this.ui.player.$root.getBoundingClientRect(),e=this.$btn.getBoundingClientRect(),n=this.$layer.getBoundingClientRect(),i=e.left+e.width/2-t.left-n.width/2;this.$layer.style.left=i+"px",this.$layer.style.bottom=this.bottomOffset+"px"}}},{key:"destroy",value:function(){clearTimeout(this.hideTimeout)}},{key:"isShow",get:function(){return this._isShow}}])&&u(l.prototype,c),void(h&&u(l,h)),d);function d(t){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,d),this.layerHideDelay=200,this.bottomOffset=40,this.hideTimeout=-1,this._isShow=!1,this.ui=t,this.player=t.player}function p(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var v,y,m,b=(v=g,(y=[{key:"switch",value:function(t,e){this.switchIcon(t),e&&this.switchTitle(e)}},{key:"switchIcon",value:function(t){this.$use.setAttributeNS("http://www.w3.org/1999/xlink","href","#"+this.$root.getAttribute(t))}},{key:"switchTitle",value:function(t){this.$root.setAttribute("title",this.$root.getAttribute(t))}}])&&p(v.prototype,y),void(m&&p(v,m)),g);function g(t){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,g),this.$root=t,this.$use=this.$root.querySelector("use")}function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function k(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function $(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t,e,n){return(L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=x(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function x(t){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}a.a.enableBoundaryChecking(!1);var S,_,O,T=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(j,f),S=j,(_=[{key:"up",value:function(){this.$video.volume<=.9?this.$video.volume=a.a.plus(this.$video.volume,.1):this.$video.volume=1,this.volumeValue=this.$video.volume}},{key:"down",value:function(){.1<=this.$video.volume?this.$video.volume=a.a.minus(this.$video.volume,.1):this.$video.volume=0,this.volumeValue=this.$video.volume}},{key:"toggleMuted",value:function(){0<this.$video.volume?this.$video.volume=0:0===this.volumeValue?this.$video.volume=1:this.$video.volume=this.volumeValue,this.updateButton()}},{key:"updateButton",value:function(){var t;t=0<this.$video.volume?"data-on":"data-off",this.btn.switch(t)}},{key:"updateController",value:function(){var t=a.a.round(100*this.$video.volume,0);this.$valueLabel.innerText=t.toString();var e=this.$video.volume*this.areaHeight;this.$current.style.height=e+"px",e=this.areaHeight-e,this.$controller.style.transform="translateY(".concat(e,"px)"),this.updateButton()}},{key:"showLayer",value:function(){L(x(j.prototype),"showLayer",this).call(this),this.areaHeight=this.$dragArea.clientHeight,this.updateController()}},{key:"update",value:function(){this.$controller.style.background=this.$current.style.background=this.player.options.color}}])&&k(S.prototype,_),void(O&&k(S,O)),j);function j(t){var o;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,j),(o=$(this,x(j).call(this,t))).volumeValue=0,o.areaHeight=0,o.$video=o.player.$video,o.$video.addEventListener("volumechange",function(){return o.updateController()}),o.$layer=o.player.$root.querySelector(".interactive-layer .volume-bar"),o.$valueLabel=o.$layer.querySelector(".volume-num-label"),o.$btn=o.player.$root.querySelector(".interactive-layer .buttons .button.volume"),o.btn=new b(o.$btn),o.$btn.addEventListener("click",function(){return o.toggleMuted()}),o.$dragArea=o.$layer.querySelector(".volume-column-bar"),o.$controller=o.$dragArea.querySelector(".bar-controller"),o.$current=o.$dragArea.querySelector(".bar-current"),o.volumeValue=o.$video.volume=o.player.options.volume,0===o.volumeValue&&(o.volumeValue=.7);function e(t){var e=t.pageY,n=o.$dragArea.getBoundingClientRect();if(e<n.top)o.$video.volume=1;else if(e>n.bottom)o.$video.volume=0;else{var i=n.bottom-n.top,r=(e-=n.top)/i;o.$video.volume=a.a.round(1-r,2)}o.volumeValue=o.$video.volume,o.updateController()}function n(t){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n),e(t)}return o.$dragArea.addEventListener("mousedown",function(){document.addEventListener("mousemove",e),document.addEventListener("mouseup",n)}),o.init(),o.updateController(),o}function P(t){return(P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function D(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function B(t,e){return!e||"object"!==P(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function F(t,e,n){return(F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=C(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function M(t,e){return(M=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var I,H,q,R=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&M(t,e)}(Y,f),I=Y,(H=[{key:"showButton",value:function(){this.$btn.style.display=""}},{key:"hideButton",value:function(){this.$btn.style.display="none"}},{key:"showLayer",value:function(){F(C(Y.prototype),"showLayer",this).call(this),this._updateLevel(),this.updateLayerPosition(),this.updateButton()}},{key:"updateButton",value:function(){var e=this;this.levels.every(function(t){return t.selected&&(e.$btn.innerText=t.name),!t.selected})}},{key:"reset",value:function(){this.currentLevel=-1,this.$layer.innerHTML=""}},{key:"_updateLevel",value:function(){var i=this;this.$layer.innerHTML="",this.levels.forEach(function(t,e){var n=document.createElement("div");e===i.currentLevel&&n.classList.add("current"),n.innerText=t.name,n.setAttribute("data-value",t.index.toString()),i.$layer.append(n)})}},{key:"updateLevel",value:function(t){var e;this.levels.length=0,this.autoLevel.selected=!0,(e=this.levels).push.apply(e,A(t).concat([this.autoLevel])),this._updateLevel(),this.updateLayerPosition(),this.updateButton()}}])&&D(I.prototype,H),void(q&&D(I,q)),Y);function Y(t){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Y),(i=B(this,C(Y).call(this,t))).autoLevel={selected:!1,name:"自动",index:-1,bitrate:0},i.levels=[],i.currentLevel=-1,i.$btn=i.player.$root.querySelector(".button.quality"),i.$layer=i.player.$root.querySelector(".float.quality-menu"),i.init(),i.$layer.addEventListener("click",function(t){if(t.target){var e=t.target;if(e.hasAttribute("data-value")){var n=parseInt(e.getAttribute("data-value"));i.levels.forEach(function(t){t.selected=t.index===n})}}i.updateButton(),i.hideLayer()}),i}function z(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var N,U,W,G,V,X=(U=K,G=[{key:"getTimeString",value:function(t){var e=[],n=Math.floor(t/3600);return 0<n&&(1===n.toString().length&&(n="0"+n),e.push(n)),1===(n=Math.floor(t/60)-60*Math.floor(t/3600)).toString().length&&(n="0"+n),e.push(n),1===(n=Math.floor(t)-60*Math.floor(t/60)).toString().length&&(n="0"+n),e.push(n),e.join(":")}}],(W=[{key:"time",value:function(){this.player.options.live||(this.$time.innerText=K.getTimeString(this.player.$video.currentTime)+" / "+K.getTimeString(this.player.$video.duration))}},{key:"resize",value:function(){this.barWidth=this.player.width-this.offsetWidth,this.update(),this.updateBufferBar()}},{key:"update",value:function(){var t=this.barWidth*this.percent;this.$current.style.width=t+"px",this.$controller.style.transform="translateX(".concat(t,"px)"),this.$controller.style.background=this.player.options.color,this.$current.style.background=this.player.options.color}},{key:"resetTimeZone",value:function(){this.player.options.live?this.$time.innerText="直播":this.$time.innerText=""}},{key:"updateBufferBar",value:function(){for(var t=0;t<this.player.$video.buffered.length;t++){var e=this.player.$video.buffered.start(t),n=this.player.$video.buffered.end(t);e<this._currentTime&&this._currentTime<n&&(this.$buffer.style.width=n/this.player.$video.duration*this.barWidth+"px")}}}])&&z(U.prototype,W),void(G&&z(U,G)),K);function K(t){var i=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,K),this.barWidth=0,this._currentTime=0,this.percent=0,this.offsetWidth=0,this.player=t.player,this.ui=t,this.$root=this.player.$root.querySelector(".progress-bar"),this.$controller=this.$root.querySelector(".bar-controller"),this.$current=this.$root.querySelector(".bar-current"),this.$time=this.player.$root.querySelector(".controller-bottom-bar .time"),this.$buffer=this.$root.querySelector(".bar-buffer"),this.player.$video.addEventListener("timeupdate",function(){i._currentTime=i.player.$video.currentTime,i.percent=i._currentTime/i.player.$video.duration,i.time(),i.update()}),this.player.$video.addEventListener("progress",function(){i.updateBufferBar(),i.time()});function e(t){var e=i.player.$root.getBoundingClientRect(),n=t.pageX-e.left-i.offsetWidth/2;n<0?n=0:n>i.barWidth&&(n=i.barWidth),i.percent=n/i.barWidth,i.player.$video.currentTime=i.percent*i.player.$video.duration,i.update(),i.ui.isMouseInUI=!0}function n(){document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",n)}this.$root.addEventListener("mousedown",function(){document.addEventListener("mousemove",e),document.addEventListener("mouseup",n)}),this.$root.addEventListener("click",e),this.offsetWidth=this.player.width-this.$root.clientWidth,this.resize()}function Q(t){var e=t.currentTime,n=void 0===e?0:e,i=t.borderColor,r=void 0===i?"":i,o=t.fill,s=void 0===o?"#ffffff":o,a=t.type,u=void 0===a?N.Flow:a,l=t.id,c=void 0===l?"":l,h=t.fontSize;return{currentTime:n,type:u,borderColor:r,fill:s,id:c,fontSize:void 0===h?28:h}}(V=N=N||{})[V.Top=0]="Top",V[V.Flow=1]="Flow",V[V.Bottom=2]="Bottom";function Z(t,e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,Z),this.text=t,Object.assign(this,Q(e||{}))}function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function et(t){return(et=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function nt(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&it(t,e)}function it(t,e){return(it=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function rt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ot(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function st(t,e,n){return e&&ot(t.prototype,e),n&&ot(t,n),t}var at='px "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',ut=(st(pt,[{key:"getSize",value:function(){this.ctx.textBaseline="top",this.ctx.textAlign="left",this.ctx.font=this.danmaku.fontSize+at,this.width=this.ctx.measureText(this.danmaku.text).width,this.height=1.2*this.ctx.measureText("M").width}},{key:"draw",value:function(){var t=this.width+4,e=this.height;this.selfCanvas.width=t,this.selfCanvas.height=e,this.ctx.textBaseline="top",this.ctx.textAlign="left",this.ctx.font=this.danmaku.fontSize+at,this.ctx.clearRect(0,0,t,e),this.danmaku.borderColor&&(this.ctx.strokeStyle=this.danmaku.borderColor,this.ctx.strokeRect(1,1,t-4,e-4)),this.ctx.strokeStyle="#000000",this.ctx.strokeText(this.danmaku.text,1,1),this.ctx.fillStyle=this.danmaku.fill,this.ctx.fillText(this.danmaku.text,1,1)}}]),pt),lt=(nt(dt,ut),st(dt,[{key:"set",value:function(t,e,n){this.danmaku=t,this.enable=!0,this.left=e,this.top=n,this.getSize(),this.draw()}},{key:"update",value:function(t,e,n){var i=(t+this.width)/e*n;this.left=this.left-i,this.enable=0<this.left+this.width}}]),dt),ct=(nt(ft,ut),st(ft,[{key:"set",value:function(t,e,n,i){this.danmaku=t,this.timeout=e,this.enable=!0,this.getSize(),this.left=(n-this.width)/2,this.top=i,this.draw(),this.update(0)}},{key:"update",value:function(t){this.timeout-=t,this.enable=0<this.timeout}}]),ft),ht=n("faa1");function ft(){var t;return rt(this,ft),(t=tt(this,et(ft).apply(this,arguments))).timeout=0,t}function dt(){return rt(this,dt),tt(this,et(dt).apply(this,arguments))}function pt(){rt(this,pt),this.top=0,this.left=0,this.width=0,this.height=0,this.enable=!1,this.selfCanvas=document.createElement("canvas"),this.selfCanvas.width=100,this.selfCanvas.height=100,this.ctx=this.selfCanvas.getContext("2d")}function vt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var yt,mt,bt,gt,wt,kt='px "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',$t=(mt=Lt,(bt=[{key:"addDrawer",value:function(t){this.caches.push(t)}},{key:"removeDrawer",value:function(t){var e=this.caches.indexOf(t);-1<e&&this.caches.splice(e,1)}},{key:"renderAll",value:function(){if(this.clear(),0<this.caches.length)for(var t=0;t<this.caches.length;t++){var e=this.caches[t];this.ctx.drawImage(e.selfCanvas,e.left,e.top)}}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.player.width,this.player.height)}},{key:"clearCache",value:function(){this.caches.length=0}},{key:"fontHeight",value:function(t){return this.ctx.font=t+kt,1.2*this.ctx.measureText("M").width}},{key:"fontWidth",value:function(t){return this.ctx.font=t.danmaku.fontSize+kt,this.ctx.measureText(t.danmaku.text).width}},{key:"resize",value:function(){this.$canvas.setAttribute("width",this.player.width+"px"),this.$canvas.setAttribute("height",this.player.height+"px")}},{key:"alpha",set:function(t){this.ctx.globalAlpha=t}}])&&vt(mt.prototype,bt),void(gt&&vt(mt,gt)),Lt);function Lt(t){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,Lt),this.caches=[],this.player=t,this.$canvas=t.$root.querySelector("canvas"),this.ctx=this.$canvas.getContext("2d"),this.$canvas.addEventListener("click",function(){t.toggle()})}function xt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Et(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(wt=yt=yt||{})[wt.UnLimited=0]="UnLimited",wt[wt.UnOverlap=1]="UnOverlap",wt[wt.Percent25=.25]="Percent25",wt[wt.Half=.5]="Half",wt[wt.Percent75=.25]="Percent75";var St='<div class="content"></div><div class="buttons"><span class="copy">复制</span></div>';function _t(t,e,n){var i=document.createElement("div");i.innerHTML=St,i.querySelector(".content").innerText=t.danmaku.text;var r=i.querySelector(".buttons");for(var o in e){var s=document.createElement("span");s.innerText=o,s.onclick=e[o],r.prepend(s)}var a=i.querySelector(".copy");return a&&a.addEventListener("click",function(){return n(t.danmaku.text)}),i}function Ot(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.alpha,n=void 0===e?1:e,i=t.enable,r=void 0===i||i,o=t.flowDuration,s=void 0===o?8:o,a=t.fadeoutDuration,u=void 0===a?5:a,l=t.limit,c=void 0===l?yt.UnOverlap:l,h=t.contextMenu;return{alpha:n,enable:r,flowDuration:s,limit:c,fadeoutDuration:u,contextMenu:void 0===h?void 0:h}}var Tt,jt,Pt,At=(Tt=Dt,Pt=[{key:"find",value:function(t,e){return t.offsetX>e.left&&t.offsetX<e.left+e.width&&t.offsetY>e.top&&t.offsetY<e.top+e.height}}],(jt=[{key:"createDanmakuMenu",value:function(t){var e=this;this.$menu&&this.$menu.remove(),this.$menu=document.createElement("div"),this.$menu.className="float show danmaku-context-menu";for(var n=0;n<t.length;n++){var i=t[n];if(this.player.options.danmaku.contextMenu){var r=_t(i,this.player.options.danmaku.contextMenu(i.danmaku),function(t){return e.copyText(t)});this.$menu.append(r)}}document.body.append(this.$menu)}},{key:"show",value:function(){this.isShow=!0}},{key:"hide",value:function(){this.isShow=!1,this.canvas.clear()}},{key:"clear",value:function(){var t,e;this.showed.length=0,this.canvas.clear(),this.canvas.clearCache(),(t=this.topAndBottomDisables).push.apply(t,xt(this.topEnables)),this.topEnables.length=0,(e=this.flowDisables).push.apply(e,xt(this.flowEnables)),this.flowEnables.length=0}},{key:"resize",value:function(){this.width=this.player.$root.clientWidth,this.height=this.player.$root.clientHeight,this.lineHeight=Math.round(this.canvas.fontHeight(this.player.options.fontSize));for(var t=this.lineHeights.length=0;t<window.screen.height;t++){var e=t*this.lineHeight;if(e>window.screen.height)break;this.lineHeights.push(e),this.topLines.hasOwnProperty(e)||(this.topLines[e]=null),this.bottomLines.hasOwnProperty(e)||(this.bottomLines[e]=[]),this.flowLines.hasOwnProperty(e)||(this.flowLines[e]=[])}this.canvas.resize();var n=this.player.options.danmaku.limit;n===yt.Percent75?this.displayArea=.75*this.player.height:n===yt.Half?this.displayArea=.5*this.player.height:n===yt.Percent25?this.displayArea=.25*this.player.height:this.displayArea=this.player.height,this.canvas.alpha=this.player.options.danmaku.alpha,this.canvas.renderAll()}},{key:"toggle",value:function(){this.isShow?this.hide():this.show()}},{key:"send",value:function(t){t.text=t.text.trim(),this.danmakus.push(t)}},{key:"findDrawers",value:function(e){return[].concat(xt(this.topEnables.filter(function(t){return Dt.find(e,t)})),xt(this.bottomEnables.filter(function(t){return Dt.find(e,t)})),xt(this.flowEnables.filter(function(t){return Dt.find(e,t)})))}},{key:"addDanmakuToCanvas",value:function(){if(0!==this.danmakus.length)for(var t=0;t<this.danmakus.length;t++){var e=this.danmakus[t],n=Math.abs(this.player.currentTime-e.currentTime);if(!(this.showed.includes(e)||.1<n)){if(this.showed.push(e),e.type===N.Flow){var i=this.flowDisables.shift()||new lt;i.enable=!0,i.set(e,this.width,this.calcFlowTop(i)),i.update(this.width,this.player.options.danmaku.flowDuration,0),this.flowEnables.push(i),this.canvas.addDrawer(i)}else{var r=this.topAndBottomDisables.shift()||new ct;if(r.enable=!0,e.type===N.Top)r.set(e,this.player.options.danmaku.fadeoutDuration,this.width,this.calcTopTop(r)),this.topEnables.push(r);else{var o=this.calcBottomTop(r)+this.lineHeight;o=this.height-o,r.set(e,this.player.options.danmaku.fadeoutDuration,this.width,o),this.bottomEnables.push(r)}r.update(0),this.canvas.addDrawer(r)}this.canvas.renderAll()}}}},{key:"copyText",value:function(t){this.$input||(this.$input=this.player.$root.querySelector("input.copy-tool")),this.$input.value=t,this.$input.select(),document.execCommand("copy")}},{key:"calcFlowTop",value:function(t){for(var e in this.flowLines){var n=this.flowLines[e],i=Number(e),r=n.left+n.width;if(!(n&&n.enable&&r>this.width)){if(i>this.displayArea)break;return this.flowLines[e]=t,this.flowY=i}}return this.flowY+=this.lineHeight,this.flowY>this.displayArea&&(this.flowY=0),this.flowLines[this.flowY]=t,this.flowY}},{key:"calcTopTop",value:function(t){for(var e in this.topLines){var n=this.topLines[e],i=Number(e);if(!n||!n.enable){if(i>this.displayArea)break;return this.topLines[e]=t,this.topY=i}}return this.topY+=this.lineHeight,this.topY>this.displayArea&&(this.topY=0),this.topLines[this.topY]=t,this.topY}},{key:"calcBottomTop",value:function(t){for(var e in this.bottomLines){var n=this.bottomLines[e],i=Number(e);if(!n||!n.enable){if(i>this.displayArea)break;return this.bottomLines[e]=t,this.bottomY=i}}return this.bottomY+=this.lineHeight,this.bottomY>this.displayArea&&(this.bottomY=0),this.bottomLines[this.bottomY]=t,this.bottomY}},{key:"drawDanmaku",value:function(){var e=this;this.topEnables=this.topEnables.filter(function(t){return t.enable?(t.update(e.frameTime),!0):(e.canvas.removeDrawer(t),e.topAndBottomDisables.push(t),!1)}),this.bottomEnables=this.bottomEnables.filter(function(t){return t.enable?(t.update(e.frameTime),!0):(e.canvas.removeDrawer(t),e.topAndBottomDisables.push(t),!1)}),this.flowEnables=this.flowEnables.filter(function(t){return t.enable?(t.update(e.width,e.player.options.danmaku.flowDuration,e.frameTime),!0):(e.canvas.removeDrawer(t),e.flowDisables.push(t),!1)})}},{key:"loop",value:function(){var t=this;this.destroied||(this.addDanmakuToCanvas(),this.addDanmakuToCanvasTime=(Date.now()-this.lastFrame)/1e3,this.player.paused||(this.drawDanmaku(),this.calcDanmakuTime=(Date.now()-this.lastFrame)/1e3,this.isShow?this.canvas.renderAll():this.canvas.clear()),this.frameTime=(Date.now()-this.lastFrame)/1e3,this.lastFrame=Date.now(),window.requestAnimationFrame(function(){t.loop()}))}},{key:"destroy",value:function(){this.destroied=!0,clearInterval(this.calcTopInterval),this.$menu&&this.$menu.remove()}},{key:"debug",get:function(){return{isShow:this.isShow,all:this.danmakus.length,showed:this.showed.length,time:{addDanmakuToCanvas:this.addDanmakuToCanvasTime,drawDanmaku:this.calcDanmakuTime,frameTime:this.frameTime},"on screen danmakus":{top:this.topEnables.length,bottom:this.bottomEnables.length,flow:this.flowEnables.length},"danmaku pool":{fixed:this.topAndBottomDisables.length,flow:this.flowDisables.length},positionY:{top:this.topY,flow:this.flowY,bottom:this.bottomY}}}}])&&Et(Tt.prototype,jt),void(Pt&&Et(Tt,Pt)),Dt);function Dt(t){var s=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,Dt),this.danmakus=[],this.showed=[],this.topEnables=[],this.topAndBottomDisables=[],this.bottomEnables=[],this.flowEnables=[],this.flowDisables=[],this.lineHeights=[],this.topLines={},this.bottomLines={},this.flowLines={},this.displayArea=0,this.topY=0,this.flowY=0,this.bottomY=0,this.frameTime=0,this.calcDanmakuTime=0,this.isShow=!0,this.width=0,this.height=0,this.calcTopInterval=-1,this.destroied=!1,this.addDanmakuToCanvasTime=0,this.lastFrame=0,this.player=t,this.event=new ht.EventEmitter,this.canvas=new $t(t);function a(){document.removeEventListener("click",a),document.removeEventListener("contextmenu",a),s.$menu.remove()}this.canvas.$canvas.addEventListener("contextmenu",function(t){var e=s.findDrawers(t);if(0<e.length){s.createDanmakuMenu(e);var n=t.pageX,i=t.pageY,r=t.clientX+s.$menu.clientWidth,o=t.clientY+s.$menu.clientHeight;r>document.body.clientWidth&&(n-=r-document.body.clientWidth),o>document.body.clientHeight&&(i-=o-document.body.clientHeight),s.$menu.style.left=n+"px",s.$menu.style.top=i+"px",document.addEventListener("click",a),document.addEventListener("touchstart",a),document.addEventListener("contextmenu",a)}return t.preventDefault(),t.stopPropagation(),!1}),this.canvas.$canvas.addEventListener("dblclick",function(){s.player.toggleFullScreen()}),this.player.$video.addEventListener("seeked",function(){s.clear()}),this.player.options.danmaku.enable?this.show():this.hide(),this.loop()}function Bt(t){return(Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ct(t,e){return!e||"object"!==Bt(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Mt(t){return(Mt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function It(t,e){return(It=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ht,qt,Rt,Yt=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&It(t,e)}(zt,f),Ht=zt,(qt=[{key:"getStyle",value:function(){return{fill:this.fill,type:this.type,borderColor:"white"}}}])&&Ft(Ht.prototype,qt),void(Rt&&Ft(Ht,Rt)),zt);function zt(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,zt),(e=Ct(this,Mt(zt).call(this,t))).fill="#ffffff",e.type=N.Flow,e.$layer=e.player.$root.querySelector(".float.danmaku-style-layer"),e.$btn=e.player.$root.querySelector(".intern-button.danmaku-style"),e.$layer.innerHTML='<div>类型\n<div class="types">\n  <div class="type" data-type="1"><div><svg class="icon"><use xlink:href="#danplayer-danmugundongkai"></use></svg></div>流动</div>\n  <div class="type" data-type="0"><div><svg class="icon"><use xlink:href="#danplayer-danmudingbukai"></use></svg></div>顶部</div>\n  <div class="type" data-type="2"><div><svg class="icon"><use xlink:href="#danplayer-danmudibukai"></use></svg></div>底部</div>\n</div>\n</div>\n<div>颜色\n<div class="colors">\n{colors}\n</div>\n</div>'.replace("{colors}",zt.colors.map(function(t){return'<span style="background: '.concat(t,'" data-color="').concat(t,'"></span>')}).join("")),e.init(),e.$types=Array.from(e.$layer.querySelectorAll(".types > .type")),e.$colors=Array.from(e.$layer.querySelectorAll(".colors > span")),e.$types.forEach(function(t){return t.addEventListener("click",function(){e.$types.forEach(function(t){return t.classList.remove("selected")}),t.classList.add("selected"),e.type=Number(t.getAttribute("data-type"))})}),e.$colors.forEach(function(t){return t.addEventListener("click",function(){e.$colors.forEach(function(t){return t.classList.remove("selected")}),t.classList.add("selected"),e.fill=t.getAttribute("data-color")})}),e.$types[0].classList.add("selected"),e.$colors[e.$colors.length-1].classList.add("selected"),e}function Nt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}Yt.colors=["#FE0302","#FF7204","#FFAA02","#FFD302","#FFFF00","#A0EE00","#00CD00","#019899","#4266BE","#89D5FF","#CC0273","#222222","#9B9B9B","#FFFFFF"];var Ut,Wt,Gt,Vt=(Ut=Xt,(Wt=[{key:"send",value:function(){var t=this.styleLayer.getStyle();t.currentTime=this.ui.player.currentTime,this.ui.danmakuLayer.send(new Z(this.$input.value,t)),this.$input.value="",this.ui.player.$root.focus()}},{key:"toggle",value:function(){this.isShow?this.hide():this.show()}},{key:"show",value:function(){this.isShow=!0,this.$root.style.display=""}},{key:"hide",value:function(){this.isShow=!1,this.$root.style.display="none"}},{key:"update",value:function(){}},{key:"focus",value:function(){this.$input.focus()}}])&&Nt(Ut.prototype,Wt),void(Gt&&Nt(Ut,Gt)),Xt);function Xt(t){var e=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,Xt),this.isShow=!1,this.ui=t,this.styleLayer=new Yt(t),this.$root=t.player.$root.querySelector(".danmaku-form"),this.$input=this.$root.querySelector("input"),this.$btn=this.$root.querySelector(".send"),this.$btn.addEventListener("click",function(){return e.send()}),this.$input.addEventListener("keypress",function(t){"Enter"===t.key&&e.ui.isShow&&e.$input.value&&e.send()}),this.$input.addEventListener("keydown",function(t){!t.key.startsWith("Arrow")&&" "!==t.key||t.stopPropagation()}),this.$input.addEventListener("keyup",function(t){"Escape"===t.key&&(e.ui.player.$root.focus(),e.ui.hide()),t.stopPropagation()}),this.$input.addEventListener("focus",function(){e.ui.isMouseInUI=!0}),this.$input.addEventListener("blur",function(){e.ui.isMouseInUI=!1})}function Kt(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Qt(t,e,n,i,r,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function Zt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Jt,te,ee,ne=(Jt=ie,(te=[{key:"show",value:function(){this.isShow=!0,this.$root.classList.add("show"),this.$gradientBG.classList.add("show")}},{key:"hide",value:function(){this.isShow=!1,this.$root.classList.remove("show"),this.$gradientBG.classList.remove("show"),this.qualitySelector.hideLayer(),this.volume.hideLayer(),this.danmakuForm.styleLayer.hideLayer(),this.player.$root.focus()}},{key:"hideUIDelay",value:function(){var e=this;return this.cancelHideUIDelay(),new Promise(function(t){e.hideTimeout=window.setTimeout(function(){e.hide(),t()},e.player.options.uiFadeOutDelay)})}},{key:"cancelHideUIDelay",value:function(){clearTimeout(this.hideTimeout)}},{key:"clearExtraButtons",value:function(){this.extraButtons.forEach(function(t){return t.remove()}),this.extraButtons.length=0}},{key:"insertExtraButtons",value:function(){var t,e;this.clearExtraButtons(),this.player.options.extraButtons&&(this.player.options.extraButtons.forEach(function(t){t.classList.add("button"),t.classList.remove("intern-button")}),(t=this.$controllerButtonsRightLayout).prepend.apply(t,Kt(this.player.options.extraButtons)),(e=this.extraButtons).push.apply(e,Kt(this.player.options.extraButtons)))}},{key:"update",value:function(){this.updateDanmakuButton(),this.updateFullScreenButton(),this.updatePlayButton(),this.danmakuForm.update(),this.progressBar.update(),this.volume.update()}},{key:"updatePlayButton",value:function(){this.player.paused?this.btnPlay.switch("data-on","data-on-title"):this.btnPlay.switch("data-off","data-off-title")}},{key:"updateFullScreenButton",value:function(){this.player.isFullScreen?this.btnFullScreen.switch("data-off","data-off-title"):this.btnFullScreen.switch("data-on","data-on-title")}},{key:"updateDanmakuButton",value:function(){var t,e;e=this.danmakuLayer.isShow?(t="data-off","data-off-title"):(t="data-on","data-on-title"),this.btnShowDanmaku.switch(t,e)}},{key:"resize",value:function(){this.volume.isShow&&this.volume.updateLayerPosition(),this.qualitySelector.isShow&&this.qualitySelector.updateLayerPosition(),this.progressBar.resize(),this.danmakuLayer.resize()}},{key:"destroy",value:function(){clearTimeout(this.hideTimeout),this.danmakuLayer.destroy(),this.qualitySelector.destroy(),this.volume.destroy()}},{key:"isMouseInUI",set:function(t){this._isMouseInUI=t,this.cancelHideUIDelay()},get:function(){return this._isMouseInUI}},{key:"debug",get:function(){return{isShow:this.isShow,isMouseInUI:this._isMouseInUI,danmakuLayer:this.danmakuLayer.debug}}}])&&Zt(Jt.prototype,te),void(ee&&Zt(Jt,ee)),ie);function ie(t){var e=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,ie),this._isMouseInUI=!1,this.isShow=!1,this.extraButtons=[],this.hideTimeout=-1,this.player=t,this.$root=t.$root.querySelector(".interactive-layer .controller-bottom-bar"),this.$root.addEventListener("mouseenter",function(){e.isMouseInUI=!0}),this.$root.addEventListener("mouseleave",function(){e.isMouseInUI=!1}),this.$gradientBG=t.$root.querySelector(".bg-gradient"),this.volume=new T(this),this.qualitySelector=new R(this),this.progressBar=new X(this),this.styleLayer=new Yt(this),this.danmakuForm=new Vt(this),this.$controllerButtonsRightLayout=this.$root.querySelector(".buttons .right"),this.btnFullScreen=new b(this.$root.querySelector(".button.full-screen")),this.btnFullScreen.$root.addEventListener("click",function(a){return function(){var t=this,s=arguments;return new Promise(function(e,n){var i=a.apply(t,s);function r(t){Qt(i,e,n,r,o,"next",t)}function o(t){Qt(i,e,n,r,o,"throw",t)}r(void 0)})}}(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.player.toggleFullScreen();case 2:e.updateFullScreenButton();case 3:case"end":return t.stop()}},t)}))),this.btnPlay=new b(this.$root.querySelector(".button.play")),this.btnPlay.$root.addEventListener("click",function(){e.player.toggle(),e.updatePlayButton()}),this.btnShowDanmaku=new b(this.$root.querySelector(".button.toggle-danamaku")),this.btnShowDanmaku.$root.addEventListener("click",function(){e.danmakuLayer.toggle(),e.updateDanmakuButton()}),this.danmakuLayer=new At(t),this.insertExtraButtons()}function re(t){return(re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function oe(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function se(t,e){return!e||"object"!==re(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function ae(t){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ue(t,e){return(ue=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var le,ce,he,fe=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&ue(t,e)}(de,n("ba10").EventEmitter),le=de,(ce=[{key:"useHls",value:function(t){var e=this;(this.hls=t).on(Hls.Events.LEVEL_LOADED,function(){e.emit(de.Events.OnLoad,function(t){var i={};return t.levels.forEach(function(t,e){var n=t.height+"p";i[n]&&i[n].bitrate>t.bitrate||(i[n]={selected:!1,name:n,index:t.level,bitrate:t.bitrate})}),Object.values(i)}(t))})}},{key:"useDash",value:function(t){var e=this;(this.dash=t).on("streamInitialized",function(){e.emit(de.Events.OnLoad,function(t){var i={};return t.getBitrateInfoListFor("video").forEach(function(t,e){var n=t.height+"p";i[n]&&i[n].bitrate>t.bitrate||(i[n]={selected:!1,name:n,index:t.qualityIndex,bitrate:t.bitrate})}),Object.values(i)}(t))})}},{key:"trigger",value:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.emit.apply(this,[t,t].concat(n))}}])&&oe(le.prototype,ce),void(he&&oe(le,he)),de);function de(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,de),se(this,ae(de).call(this))}function pe(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ve(t,e,n,i,r,o,s){try{var a=t[o](s),u=a.value}catch(t){return void n(t)}a.done?e(u):Promise.resolve(u).then(i,r)}function ye(a){return function(){var t=this,s=arguments;return new Promise(function(e,n){var i=a.apply(t,s);function r(t){ve(i,e,n,r,o,"next",t)}function o(t){ve(i,e,n,r,o,"throw",t)}r(void 0)})}}function me(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}fe.Events={OnLoad:"OnLoaded",OnChanged:"OnChanged"};var be,ge,we="//at.alicdn.com/t/font_1373341_m9a3piei0s.js";(ge=be=be||{})[ge.Normal=0]="Normal",ge[ge.Hls=1]="Hls",ge[ge.Dash=2]="Dash";var ke,$e,Le,xe,Ee,Se,_e=(ke=Oe,($e=[{key:"_setSrc",value:(Se=ye(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.options.src&&this.$video.setAttribute("src",this.options.src),t.next=3,this.getContentType();case 3:this.hls?this.adapter.useHls(this.hls):this.dash&&this.adapter.useDash(this.dash),this.type===be.Normal?this.ui.qualitySelector.hideButton():this.ui.qualitySelector.showButton(),!this.options.autoplay&&this.paused||this.play(),this.options.live?this.$root.classList.add("live"):this.$root.classList.remove("live");case 8:case"end":return t.stop()}},t,this)})),function(){return Se.apply(this,arguments)})},{key:"_setUI",value:function(){this.ui.insertExtraButtons(),this.ui.update(),this.ui.progressBar.resize(),this.ui.progressBar.resetTimeZone(),this.resize(),this.$style&&this.$style.remove(),this.$style=document.createElement("style"),this.$style.innerHTML=".video-player .colors .selected{border-color:".concat(this.options.color," !important}\n.video-player .types .selected{color:").concat(this.options.color," !important}"),document.body.append(this.$style)}},{key:"set",value:function(t){t.danmaku=Object.assign({},this.options.danmaku,t.danmaku);var e=Object.assign({},this.options,t),n=e.src!==this.options.src||this.options.live!==e.live;this.options=e,n&&(this.hls&&(this.hls.detachMedia(),this.hls=void 0),this.dash&&(this.dash.reset(),this.dash=void 0),this._setSrc().then()),this._setUI()}},{key:"resize",value:function(){this.options.width&&("number"==typeof this.options.width||parseInt(this.options.width).toString()===this.options.width?this._width=this.options.width+"px":this._width=this.options.width),this.options.height&&("number"==typeof this.options.height||parseInt(this.options.height).toString()===this.options.height?this._height=this.options.height+"px":this._height=this.options.height),this.isFullScreen||(this.$root.style.width=this._width,this.$root.style.height=this._height),this.ui.resize()}},{key:"resizeEvt",value:function(t){var e=this;window.clearTimeout(this.delayResize),this.delayResize=window.setTimeout(function(){e.resize()},t)}},{key:"fillDanmakus",value:function(t){var e;(e=this.ui.danmakuLayer.danmakus).push.apply(e,pe(t))}},{key:"sendDanmaku",value:function(t){this.ui.danmakuLayer.send(t)}},{key:"toggle",value:function(){this.paused?this.play():this.pause()}},{key:"play",value:function(){var e=this;this._paused=!1,this.$video.play().then(),this.options.onlyOne&&Oe.instances.forEach(function(t){t!==e&&t.pause()})}},{key:"pause",value:function(){this._paused=!0,this.$video.pause()}},{key:"getContentType",value:(Ee=ye(o.a.mark(function t(){var e,n,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((e=this.$video.getAttribute("src"))&&((this.options.src=e).match(/\.m3u[8]/)&&(this.type=be.Hls),e.match(/\.mpd/)&&(this.type=be.Dash)),this.type!==be.Hls){t.next=10;break}if(Hls){t.next=7;break}throw Error("播放Hls视频资源请加载hls.js的代码");case 7:Hls.isSupported()&&(this.hls=new Hls,this.hls.config.capLevelToPlayerSize=!0,this.hls.attachMedia(this.$video),this.hls.loadSource(e)),t.next=26;break;case 10:if(this.type!==be.Dash){t.next=18;break}if(dashjs){t.next=14;break}throw Error("播放MPD视频资源前加载dash.js的代码");case 14:this.dash=dashjs.MediaPlayer().create(),this.dash.initialize(this.$video,e,!1),t.next=26;break;case 18:return(n=new XMLHttpRequest).open("Get",e),n.send(),t.next=23,new Promise(function(t){n.onreadystatechange=function(){n.readyState===XMLHttpRequest.HEADERS_RECEIVED&&(200===n.status?t(n.getResponseHeader("Content-Type")):t(null),n.abort())}});case 23:(i=t.sent)&&this.$video.canPlayType(i)&&(this.options.src=this.$video.src=e);case 26:case"end":return t.stop()}},t,this)})),function(){return Ee.apply(this,arguments)})},{key:"toggleFullScreen",value:(xe=ye(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.isFullScreen=!this.isFullScreen,this.isFullScreen)return t.next=4,this.$root.requestFullscreen();t.next=6;break;case 4:t.next=8;break;case 6:return t.next=8,document.exitFullscreen();case 8:this.resize();case 9:case"end":return t.stop()}},t,this)})),function(){return xe.apply(this,arguments)})},{key:"destroy",value:function(){Oe.instances.splice(Oe.instances.indexOf(this),1),this.ui.destroy(),this.hls&&this.hls.detachMedia(),this.dash&&this.dash.reset(),this.$style&&this.$style.remove()}},{key:"width",get:function(){return this.$root.clientWidth}},{key:"height",get:function(){return this.$root.clientHeight}},{key:"loading",get:function(){return this._loading}},{key:"currentTime",get:function(){return this.$video.currentTime}},{key:"paused",get:function(){return this._paused}},{key:"debug",get:function(){var t,e="默认",n=this.options.src;return this.hls&&(e=-1===this.ui.qualitySelector.currentLevel?"自动 ":"",-1!==this.hls.currentLevel&&(e+=this.hls.levels[this.hls.currentLevel].name+"P")),t=this.type===be.Normal?"native":this.type===be.Dash?"dash.js":"hls.js",{width:this.width,height:this.height,type:t,src:n,quality:e,ui:this.ui.debug}}}])&&me(ke.prototype,$e),void(Le&&me(ke,Le)),Oe);function Oe(t,e){var n=this;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Oe),this.type=be.Normal,this._width="",this._height="",this.isFullScreen=!1,this._duration=0,this._loading=!0,this._paused=!0,this.delayResize=-1,!document.querySelector("script#danplayer-icon")){var i=document.createElement("script");i.src=we,i.id="danplayer-icon",document.body.append(i)}Oe.instances.push(this);var r=t.parentElement;this.$root=document.createElement("div"),this.$root.setAttribute("tabIndex","0"),this.$root.classList.add("video-player"),r.insertBefore(this.$root,t),t.classList.add("video-layer"),t.removeAttribute("id"),this.$root.innerHTML='{video-layer}\n<input class="copy-tool" />\n<div class="interactive-layer">\n  <canvas class="danmaku-layer"></canvas>\n  \n  <div class="bg-gradient show"></div>\n  \n  \n  <div class="float danmaku-style-layer"></div>\n  \n  <div class="float volume-bar">\n    <div class="volume-num-label"></div>\n    <div class="volume-column-bar">\n      <div class="bar-ui bar-full"></div>\n      <div class="bar-ui bar-current"></div>\n      <div class="bar-controller"></div>\n    </div>\n  </div>\n  \n  <div class="float quality-menu"></div>\n  \n  <div class="controller-bottom-bar">\n    <div class="progress-bar live-hide">\n      <div class="bar-full"></div>\n      <div class="bar-buffer"></div>\n      <div class="bar-current"></div>\n      <div class="bar-controller"></div>    \n    </div>\n    \n    <div class="buttons">\n      <div class="left">\n        <div class="button intern-button play" data-on="danplayer-bofang" data-off="danplayer-zanting"\n          data-on-title="播放视频" data-off-title="暂停播放">\n          <svg class="icon" aria-hidden="true"><use xlink:href="#danplayer-bofang"></use></svg>\n        </div>\n        <div class="time"></div>\n      </div>\n      \n      <div class="middle danmaku-form">\n        <div class="button intern-button danmaku-style">\n          <svg class="icon"><use xlink:href="#danplayer-style"></use></svg>\n        </div>\n        <input placeholder="输入弹幕内容" tabindex="1">\n        <div class="send">发送</div>\n      </div>\n      <div class="right">\n      \n        <div class="button intern-button volume" data-on="danplayer-yinliang" data-off="danplayer-jingyin" title="音量">\n          <svg class="icon"><use xlink:href="#danplayer-yinliang"></use></svg>\n        </div>\n        \n        <div class="button intern-button toggle-danamaku" title="隐藏弹幕"\n          data-on="danplayer-danmukai" data-off="danplayer-danmuguan" \n          data-on-title="显示弹幕" data-off-title="隐藏弹幕">\n          <svg class="icon"><use xlink:href="#danplayer-danmukai"></use></svg>\n        </div>\n        \n        <div class="button quality" title="切换画质"></div>\n        \n        <div class="button intern-button full-screen" data-on="danplayer-quanping" data-off="danplayer-zuixiaohua"\n        data-on-title="全屏观看" data-off-title="取消全屏">\n          <svg class="icon"><use xlink:href="#danplayer-quanping"></use></svg>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'.replace("{video-layer}",t.outerHTML),t.remove(),this.$root.addEventListener("keypress",function(t){var e=!0;"Enter"===t.key?(n.ui.show(),n.ui.danmakuForm.focus()):" "===t.key||(e=!1),e&&(t.stopPropagation(),t.preventDefault())}),this.$root.addEventListener("keyup",function(t){" "===t.key&&(n.toggle(),t.stopPropagation(),t.preventDefault())}),document.addEventListener("fullscreenchange",function(){n.isFullScreen=document.fullscreenElement===n.$root,n.ui.updateFullScreenButton()}),this.$root.addEventListener("keydown",function(t){var e=!0;"ArrowLeft"!==t.key||n.options.live?"ArrowRight"!==t.key||n.options.live?"ArrowUp"===t.key?n.ui.volume.up():"ArrowDown"===t.key?n.ui.volume.down():e=!1:n.$video.currentTime+=5:n.$video.currentTime-=5,e&&(t.stopPropagation(),t.preventDefault())}),this.$root.addEventListener("mousemove",function(){if(n.$root.classList.remove("mouse-idle"),n.ui.show(),n.paused);else{if(n.ui.isMouseInUI)return;n.ui.hideUIDelay().then(function(){n.$root.classList.add("mouse-idle")})}}),this.$root.addEventListener("mouseenter",function(){n.ui.show(),n.ui.cancelHideUIDelay()}),this.$root.addEventListener("mouseleave",function(){n.ui.hide(),n.ui.cancelHideUIDelay()}),this.$video=this.$root.querySelector(".video-layer"),this.$video.removeAttribute("controls"),this.$video.addEventListener("durationchange",function(){n._duration=n.$video.duration}),this.$video.addEventListener("playing",function(){return n.ui.hideUIDelay()}),this.$video.addEventListener("play",function(){return n.ui.updatePlayButton()}),this.$video.addEventListener("pause",function(){return n.ui.updatePlayButton()}),window.addEventListener("resize",function(){return n.resizeEvt(1e3)}),this.options=function(t){var e=t.autoplay,n=void 0!==e&&e,i=t.color,r=void 0===i?"#00a1d6":i,o=t.live,s=void 0!==o&&o,a=t.volume,u=void 0===a?.7:a,l=t.fontSize,c=void 0===l?28:l,h=t.width,f=void 0===h?600:h,d=t.height,p=void 0===d?350:d,v=t.uiFadeOutDelay,y=void 0===v?3e3:v,m=t.extraButtons,b=void 0===m?[]:m,g=t.src,w=void 0===g?"":g,k=t.iconSrc,$=void 0===k?we:k,L=t.danmakuForm,x=void 0===L||L,E=t.fullScreen,S=void 0===E||E,_=t.danmaku,O=void 0===_?{}:_,T=t.onlyOne,j=void 0!==T&&T;return{autoplay:n,color:r,live:s,fontSize:c,height:p,danmaku:Ot(O),danmakuForm:x,fullScreen:S,src:w,iconSrc:$,uiFadeOutDelay:y,extraButtons:b,onlyOne:j,volume:u,width:f}}(e||{autoplay:this.$video.hasAttribute("autoplay")}),this.adapter=new fe,this.ui=new ne(this),this.ui.update(),this.adapter.on(fe.Events.OnLoad,function(t){n.ui.qualitySelector.updateLevel(t)}),this._setSrc().then(),this._setUI()}_e.instances=[];var Te={Player:_e,MakeDanmakuOptions:Q,MakeDanmakuLayerOptions:Ot,Danmaku:Z,DanmakuDrawer:ut,DanmakuType:N};e.default=Te}},r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="fb15")).default;function r(t){if(i[t])return i[t].exports;var e=i[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}var n,i});