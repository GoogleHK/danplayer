!(function (t, e) { typeof exports === 'object' && typeof module === 'object' ? module.exports = e() : typeof define === 'function' && define.amd ? define([], e) : typeof exports === 'object' ? exports.danplayer = e() : t.danplayer = e() }(typeof self !== 'undefined' ? self : this, function () { return (i = {}, r.m = n = { 1441: function (t, e, n) {}, '5fe9': function (t, e, n) { 'use strict'; function i (t, e) { return void 0 === e && (e = 12), +parseFloat(t.toPrecision(e)) } function u (t) { var e = t.toString().split(/[eE]/); var n = (e[0].split('.')[1] || '').length - +(e[1] || 0); return n > 0 ? n : 0 } function l (t) { if (t.toString().indexOf('e') === -1) return Number(t.toString().replace('.', '')); var e = u(t); return e > 0 ? i(t * Math.pow(10, e)) : t } function h (t) { f && (t > Number.MAX_SAFE_INTEGER || Number.MIN_SAFE_INTEGER) } function c (t, e) { for (var n = [], i = 2; i < arguments.length; i++)n[i - 2] = arguments[i]; if (n.length > 0) return c.apply(void 0, [c(t, e), n[0]].concat(n.slice(1))); var r = l(t); var o = l(e); var s = u(t) + u(e); var a = r * o; return h(a), a / Math.pow(10, s) } function o (t, e) { for (var n = [], i = 2; i < arguments.length; i++)n[i - 2] = arguments[i]; if (n.length > 0) return o.apply(void 0, [o(t, e), n[0]].concat(n.slice(1))); var r = Math.pow(10, Math.max(u(t), u(e))); return (c(t, r) + c(e, r)) / r } function s (t, e) { for (var n = [], i = 2; i < arguments.length; i++)n[i - 2] = arguments[i]; if (n.length > 0) return s.apply(void 0, [s(t, e), n[0]].concat(n.slice(1))); var r = Math.pow(10, Math.max(u(t), u(e))); return (c(t, r) - c(e, r)) / r } function a (t, e) { for (var n = [], i = 2; i < arguments.length; i++)n[i - 2] = arguments[i]; if (n.length > 0) return a.apply(void 0, [a(t, e), n[0]].concat(n.slice(1))); var r = l(t); var o = l(e); return h(r), h(o), c(r / o, Math.pow(10, u(e) - u(t))) } function r (t, e) { var n = Math.pow(10, e); return a(Math.round(c(t, n)), n) }Object.defineProperty(e, '__esModule', { value: !0 }); var f = !0; function d (t) { void 0 === t && (t = !0), f = t } var p = { strip: i, plus: o, minus: s, times: c, divide: a, round: r, digitLength: u, float2Fixed: l, enableBoundaryChecking: d }; e.strip = i, e.plus = o, e.minus = s, e.times = c, e.divide = a, e.round = r, e.digitLength = u, e.float2Fixed = l, e.enableBoundaryChecking = d, e.default = p }, '96cf': function (t, e, n) { var i = (function (o) { 'use strict'; var u; var t = Object.prototype; var l = t.hasOwnProperty; var e = typeof Symbol === 'function' ? Symbol : {}; var r = e.iterator || '@@iterator'; var n = e.asyncIterator || '@@asyncIterator'; var i = e.toStringTag || '@@toStringTag'; function s (t, e, n, i) { var r = e && e.prototype instanceof a ? e : a; var o = Object.create(r.prototype); var s = new T(i || []); return o._invoke = (function (o, s, a) { var u = c; return function (t, e) { if (u === d) throw new Error('Generator is already running'); if (u === p) { if (t === 'throw') throw e; return O() } for (a.method = t, a.arg = e; ;) { var n = a.delegate; if (n) { var i = x(n, a); if (i) { if (i === v) continue; return i } } if (a.method === 'next')a.sent = a._sent = a.arg; else if (a.method === 'throw') { if (u === c) throw u = p, a.arg; a.dispatchException(a.arg) } else a.method === 'return' && a.abrupt('return', a.arg); u = d; var r = h(o, s, a); if (r.type === 'normal') { if (u = a.done ? p : f, r.arg === v) continue; return { value: r.arg, done: a.done } }r.type === 'throw' && (u = p, a.method = 'throw', a.arg = r.arg) } } }(t, n, s)), o } function h (t, e, n) { try { return { type: 'normal', arg: t.call(e, n) } } catch (t) { return { type: 'throw', arg: t } } }o.wrap = s; var c = 'suspendedStart'; var f = 'suspendedYield'; var d = 'executing'; var p = 'completed'; var v = {}; function a () {} function y () {} function m () {} var b = {}; b[r] = function () { return this }; var g = Object.getPrototypeOf; var w = g && g(g(_([]))); w && w !== t && l.call(w, r) && (b = w); var k = m.prototype = a.prototype = Object.create(b); function $ (t) { ['next', 'throw', 'return'].forEach(function (e) { t[e] = function (t) { return this._invoke(e, t) } }) } function L (u) { var e; this._invoke = function (n, i) { function t () { return new Promise(function (t, e) { !(function e (t, n, i, r) { var o = h(u[t], u, n); if (o.type !== 'throw') { var s = o.arg; var a = s.value; return a && typeof a === 'object' && l.call(a, '__await') ? Promise.resolve(a.__await).then(function (t) { e('next', t, i, r) }, function (t) { e('throw', t, i, r) }) : Promise.resolve(a).then(function (t) { s.value = t, i(s) }, function (t) { return e('throw', t, i, r) }) }r(o.arg) }(n, i, t, e)) }) } return e = e ? e.then(t, t) : t() } } function x (t, e) { var n = t.iterator[e.method]; if (n === u) { if (e.delegate = null, e.method === 'throw') { if (t.iterator.return && (e.method = 'return', e.arg = u, x(t, e), e.method === 'throw')) return v; e.method = 'throw', e.arg = new TypeError("The iterator does not provide a 'throw' method") } return v } var i = h(n, t.iterator, e.arg); if (i.type === 'throw') return e.method = 'throw', e.arg = i.arg, e.delegate = null, v; var r = i.arg; return r ? r.done ? (e[t.resultName] = r.value, e.next = t.nextLoc, e.method !== 'return' && (e.method = 'next', e.arg = u), e.delegate = null, v) : r : (e.method = 'throw', e.arg = new TypeError('iterator result is not an object'), e.delegate = null, v) } function E (t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e) } function S (t) { var e = t.completion || {}; e.type = 'normal', delete e.arg, t.completion = e } function T (t) { this.tryEntries = [{ tryLoc: 'root' }], t.forEach(E, this), this.reset(!0) } function _ (e) { if (e) { var t = e[r]; if (t) return t.call(e); if (typeof e.next === 'function') return e; if (!isNaN(e.length)) { var n = -1; var i = function t () { for (;++n < e.length;) if (l.call(e, n)) return t.value = e[n], t.done = !1, t; return t.value = u, t.done = !0, t }; return i.next = i } } return { next: O } } function O () { return { value: u, done: !0 } } return y.prototype = k.constructor = m, m.constructor = y, m[i] = y.displayName = 'GeneratorFunction', o.isGeneratorFunction = function (t) { var e = typeof t === 'function' && t.constructor; return !!e && (e === y || (e.displayName || e.name) === 'GeneratorFunction') }, o.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, m) : (t.__proto__ = m, i in t || (t[i] = 'GeneratorFunction')), t.prototype = Object.create(k), t }, o.awrap = function (t) { return { __await: t } }, $(L.prototype), L.prototype[n] = function () { return this }, o.AsyncIterator = L, o.async = function (t, e, n, i) { var r = new L(s(t, e, n, i)); return o.isGeneratorFunction(e) ? r : r.next().then(function (t) { return t.done ? t.value : r.next() }) }, $(k), k[i] = 'Generator', k[r] = function () { return this }, k.toString = function () { return '[object Generator]' }, o.keys = function (n) { var i = []; for (var t in n)i.push(t); return i.reverse(), function t () { for (;i.length;) { var e = i.pop(); if (e in n) return t.value = e, t.done = !1, t } return t.done = !0, t } }, o.values = _, T.prototype = { constructor: T, reset: function (t) { if (this.prev = 0, this.next = 0, this.sent = this._sent = u, this.done = !1, this.delegate = null, this.method = 'next', this.arg = u, this.tryEntries.forEach(S), !t) for (var e in this)e.charAt(0) === 't' && l.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = u) }, stop: function () { this.done = !0; var t = this.tryEntries[0].completion; if (t.type === 'throw') throw t.arg; return this.rval }, dispatchException: function (n) { if (this.done) throw n; var i = this; function t (t, e) { return o.type = 'throw', o.arg = n, i.next = t, e && (i.method = 'next', i.arg = u), !!e } for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; var o = r.completion; if (r.tryLoc === 'root') return t('end'); if (r.tryLoc <= this.prev) { var s = l.call(r, 'catchLoc'); var a = l.call(r, 'finallyLoc'); if (s && a) { if (this.prev < r.catchLoc) return t(r.catchLoc, !0); if (this.prev < r.finallyLoc) return t(r.finallyLoc) } else if (s) { if (this.prev < r.catchLoc) return t(r.catchLoc, !0) } else { if (!a) throw new Error('try statement without catch or finally'); if (this.prev < r.finallyLoc) return t(r.finallyLoc) } } } }, abrupt: function (t, e) { for (var n = this.tryEntries.length - 1; n >= 0; --n) { var i = this.tryEntries[n]; if (i.tryLoc <= this.prev && l.call(i, 'finallyLoc') && this.prev < i.finallyLoc) { var r = i; break } }r && (t === 'break' || t === 'continue') && r.tryLoc <= e && e <= r.finallyLoc && (r = null); var o = r ? r.completion : {}; return o.type = t, o.arg = e, r ? (this.method = 'next', this.next = r.finallyLoc, v) : this.complete(o) }, complete: function (t, e) { if (t.type === 'throw') throw t.arg; return t.type === 'break' || t.type === 'continue' ? this.next = t.arg : t.type === 'return' ? (this.rval = this.arg = t.arg, this.method = 'return', this.next = 'end') : t.type === 'normal' && e && (this.next = e), v }, finish: function (t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n.finallyLoc === t) return this.complete(n.completion, n.afterLoc), S(n), v } }, catch: function (t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var n = this.tryEntries[e]; if (n.tryLoc === t) { var i = n.completion; if (i.type === 'throw') { var r = i.arg; S(n) } return r } } throw new Error('illegal catch attempt') }, delegateYield: function (t, e, n) { return this.delegate = { iterator: _(t), resultName: e, nextLoc: n }, this.method === 'next' && (this.arg = u), v } }, o }(t.exports)); try { regeneratorRuntime = i } catch (t) { Function('r', 'regeneratorRuntime = r')(i) } }, a34a: function (t, e, n) { t.exports = n('96cf') }, f6fd: function (t, e) { var n, i, r; n = document, i = 'currentScript', r = n.getElementsByTagName('script'), i in n || Object.defineProperty(n, i, { get: function () { try { throw new Error() } catch (t) { var e; var n = (/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(t.stack) || [!1])[1]; for (e in r) if (r[e].src == n || r[e].readyState == 'interactive') return r[e]; return null } } }) }, faa1: function (t, e, n) { 'use strict'; var i; var r = typeof Reflect === 'object' ? Reflect : null; var h = r && typeof r.apply === 'function' ? r.apply : function (t, e, n) { return Function.prototype.apply.call(t, e, n) }; i = r && typeof r.ownKeys === 'function' ? r.ownKeys : Object.getOwnPropertySymbols ? function (t) { return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)) } : function (t) { return Object.getOwnPropertyNames(t) }; var o = Number.isNaN || function (t) { return t != t }; function s () { s.init.call(this) }((t.exports = s).EventEmitter = s).prototype._events = void 0, s.prototype._eventsCount = 0, s.prototype._maxListeners = void 0; var a = 10; function u (t) { return void 0 === t._maxListeners ? s.defaultMaxListeners : t._maxListeners } function l (t, e, n, i) { var r, o, s; if (typeof n !== 'function') throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof n); if (void 0 === (o = t._events) ? (o = t._events = Object.create(null), t._eventsCount = 0) : (void 0 !== o.newListener && (t.emit('newListener', e, n.listener ? n.listener : n), o = t._events), s = o[e]), void 0 === s)s = o[e] = n, ++t._eventsCount; else if (typeof s === 'function' ? s = o[e] = i ? [n, s] : [s, n] : i ? s.unshift(n) : s.push(n), (r = u(t)) > 0 && s.length > r && !s.warned) { s.warned = !0; var a = new Error('Possible EventEmitter memory leak detected. ' + s.length + ' ' + String(e) + ' listeners added. Use emitter.setMaxListeners() to increase limit'); a.name = 'MaxListenersExceededWarning', a.emitter = t, a.type = e, a.count = s.length, console && console.warn } return t } function c (t, e, n) { var i = { fired: !1, wrapFn: void 0, target: t, type: e, listener: n }; var r = function () { for (var t = [], e = 0; e < arguments.length; e++)t.push(arguments[e]); this.fired || (this.target.removeListener(this.type, this.wrapFn), this.fired = !0, h(this.listener, this.target, t)) }.bind(i); return r.listener = n, i.wrapFn = r } function f (t, e, n) { var i = t._events; if (void 0 === i) return []; var r = i[e]; return void 0 === r ? [] : typeof r === 'function' ? n ? [r.listener || r] : [r] : n ? (function (t) { for (var e = new Array(t.length), n = 0; n < e.length; ++n)e[n] = t[n].listener || t[n]; return e }(r)) : p(r, r.length) } function d (t) { var e = this._events; if (void 0 !== e) { var n = e[t]; if (typeof n === 'function') return 1; if (void 0 !== n) return n.length } return 0 } function p (t, e) { for (var n = new Array(e), i = 0; i < e; ++i)n[i] = t[i]; return n }Object.defineProperty(s, 'defaultMaxListeners', { enumerable: !0, get: function () { return a }, set: function (t) { if (typeof t !== 'number' || t < 0 || o(t)) throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + t + '.'); a = t } }), s.init = function () { void 0 !== this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = Object.create(null), this._eventsCount = 0), this._maxListeners = this._maxListeners || void 0 }, s.prototype.setMaxListeners = function (t) { if (typeof t !== 'number' || t < 0 || o(t)) throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + t + '.'); return this._maxListeners = t, this }, s.prototype.getMaxListeners = function () { return u(this) }, s.prototype.emit = function (t) { for (var e = [], n = 1; n < arguments.length; n++)e.push(arguments[n]); var i = t === 'error'; var r = this._events; if (void 0 !== r)i = i && void 0 === r.error; else if (!i) return !1; if (i) { var o; if (e.length > 0 && (o = e[0]), o instanceof Error) throw o; var s = new Error('Unhandled error.' + (o ? ' (' + o.message + ')' : '')); throw s.context = o, s } var a = r[t]; if (void 0 === a) return !1; if (typeof a === 'function')h(a, this, e); else { var u = a.length; var l = p(a, u); for (n = 0; n < u; ++n)h(l[n], this, e) } return !0 }, s.prototype.on = s.prototype.addListener = function (t, e) { return l(this, t, e, !1) }, s.prototype.prependListener = function (t, e) { return l(this, t, e, !0) }, s.prototype.once = function (t, e) { if (typeof e !== 'function') throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof e); return this.on(t, c(this, t, e)), this }, s.prototype.prependOnceListener = function (t, e) { if (typeof e !== 'function') throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof e); return this.prependListener(t, c(this, t, e)), this }, s.prototype.off = s.prototype.removeListener = function (t, e) { var n, i, r, o, s; if (typeof e !== 'function') throw new TypeError('The "listener" argument must be of type Function. Received type ' + typeof e); if (void 0 === (i = this._events)) return this; if (void 0 === (n = i[t])) return this; if (n === e || n.listener === e)--this._eventsCount == 0 ? this._events = Object.create(null) : (delete i[t], i.removeListener && this.emit('removeListener', t, n.listener || e)); else if (typeof n !== 'function') { for (r = -1, o = n.length - 1; o >= 0; o--) if (n[o] === e || n[o].listener === e) { s = n[o].listener, r = o; break } if (r < 0) return this; r === 0 ? n.shift() : (function (t, e) { for (;e + 1 < t.length; e++)t[e] = t[e + 1]; t.pop() }(n, r)), n.length === 1 && (i[t] = n[0]), void 0 !== i.removeListener && this.emit('removeListener', t, s || e) } return this }, s.prototype.removeAllListeners = function (t) { var e, n, i; if (void 0 === (n = this._events)) return this; if (void 0 === n.removeListener) return arguments.length === 0 ? (this._events = Object.create(null), this._eventsCount = 0) : void 0 !== n[t] && (--this._eventsCount == 0 ? this._events = Object.create(null) : delete n[t]), this; if (arguments.length === 0) { var r; var o = Object.keys(n); for (i = 0; i < o.length; ++i)(r = o[i]) !== 'removeListener' && this.removeAllListeners(r); return this.removeAllListeners('removeListener'), this._events = Object.create(null), this._eventsCount = 0, this } if (typeof (e = n[t]) === 'function') this.removeListener(t, e); else if (void 0 !== e) for (i = e.length - 1; i >= 0; i--) this.removeListener(t, e[i]); return this }, s.prototype.listeners = function (t) { return f(this, t, !0) }, s.prototype.rawListeners = function (t) { return f(this, t, !1) }, s.listenerCount = function (t, e) { return typeof t.listenerCount === 'function' ? t.listenerCount(e) : d.call(t, e) }, s.prototype.listenerCount = d, s.prototype.eventNames = function () { return this._eventsCount > 0 ? i(this._events) : [] } }, fb15: function (t, e, n) { 'use strict'; var i; n.r(e), typeof window !== 'undefined' && (n('f6fd'), (i = window.document.currentScript) && (i = i.src.match(/(.+\/)[^\/]+\.js(\?.*)?$/)) && (n.p = i[1])); var r = n('a34a'); var o = n.n(r); var s = (n('1441'), n('5fe9')); var a = n.n(s); function u (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } var l; var h; var c; var f = (l = d, (h = [{ key: 'init', value: function () { function t () { clearTimeout(n.hideTimeout), n.ui.isMouseInUI = !0, n.showLayer() } function e () { n.ui.isMouseInUI = !1, clearTimeout(n.hideTimeout), n.hideTimeout = setTimeout(function () { n.hideLayer() }, n.layerHideDelay) } var n = this; this.$btn.addEventListener('mouseenter', t), this.$btn.addEventListener('mouseleave', e), this.$layer.addEventListener('mouseenter', t), this.$layer.addEventListener('mouseleave', e) } }, { key: 'showLayer', value: function () { this._isShow = !0, this.$layer.classList.add('show'), this.updateLayerPosition() } }, { key: 'hideLayer', value: function () { this._isShow = !1, this.$layer.classList.remove('show') } }, { key: 'toggleLayer', value: function () { this._isShow ? this.hideLayer() : this.showLayer() } }, { key: 'showButton', value: function () { this.$btn.style.display = '' } }, { key: 'hideButton', value: function () { this.$btn.style.display = 'none' } }, { key: 'updateLayerPosition', value: function () { if (this._isShow) { var t = this.ui.player.$root.getBoundingClientRect(); var e = this.$btn.getBoundingClientRect(); var n = this.$layer.getBoundingClientRect(); var i = e.left + e.width / 2 - t.left - n.width / 2; this.$layer.style.left = i + 'px', this.$layer.style.bottom = this.bottomOffset + 'px' } } }, { key: 'destroy', value: function () { clearTimeout(this.hideTimeout) } }, { key: 'isShow', get: function () { return this._isShow } }]) && u(l.prototype, h), void (c && u(l, c)), d); function d (t) { (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, d), this.layerHideDelay = 200, this.bottomOffset = 40, this.hideTimeout = -1, this._isShow = !1, this.ui = t, this.player = t.player } function p (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } var v; var y; var m; var b = (v = g, (y = [{ key: 'switch', value: function (t, e) { this.switchIcon(t), e && this.switchTitle(e) } }, { key: 'switchIcon', value: function (t) { this.$use.setAttributeNS('http://www.w3.org/1999/xlink', 'href', '#' + this.$root.getAttribute(t)) } }, { key: 'switchTitle', value: function (t) { this.$root.setAttribute('title', this.$root.getAttribute(t)) } }]) && p(v.prototype, y), void (m && p(v, m)), g); function g (t) { (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, g), this.$root = t, this.$use = this.$root.querySelector('use') } function w (t) { return (w = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (t) { return typeof t } : function (t) { return t && typeof Symbol === 'function' && t.constructor === Symbol && t !== Symbol.prototype ? 'symbol' : typeof t })(t) } function k (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } function $ (t, e) { return !e || w(e) !== 'object' && typeof e !== 'function' ? (function (t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t)) : e } function L (t, e, n) { return (L = typeof Reflect !== 'undefined' && Reflect.get ? Reflect.get : function (t, e, n) { var i = (function (t, e) { for (;!Object.prototype.hasOwnProperty.call(t, e) && (t = x(t)) !== null;);return t }(t, e)); if (i) { var r = Object.getOwnPropertyDescriptor(i, e); return r.get ? r.get.call(n) : r.value } })(t, e, n || t) } function x (t) { return (x = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function E (t, e) { return (E = Object.setPrototypeOf || function (t, e) { return t.__proto__ = e, t })(t, e) }a.a.enableBoundaryChecking(!1); var S; var T; var _; var O = ((function (t, e) { if (typeof e !== 'function' && e !== null) throw new TypeError('Super expression must either be null or a function'); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && E(t, e) }(P, f)), S = P, (T = [{ key: 'up', value: function () { this.$video.volume <= 0.9 ? this.$video.volume = a.a.plus(this.$video.volume, 0.1) : this.$video.volume = 1, this.volumeValue = this.$video.volume } }, { key: 'down', value: function () { this.$video.volume >= 0.1 ? this.$video.volume = a.a.minus(this.$video.volume, 0.1) : this.$video.volume = 0, this.volumeValue = this.$video.volume } }, { key: 'toggleMuted', value: function () { this.$video.volume > 0 ? this.$video.volume = 0 : this.volumeValue === 0 ? this.$video.volume = 1 : this.$video.volume = this.volumeValue, this.updateButton() } }, { key: 'updateButton', value: function () { var t; t = this.$video.volume > 0 ? 'data-on' : 'data-off', this.btn.switch(t) } }, { key: 'updateController', value: function () { var t = a.a.round(100 * this.$video.volume, 0); this.$valueLabel.innerText = t.toString(); var e = this.$video.volume * this.areaHeight; this.$current.style.height = e + 'px', e = this.areaHeight - e, this.$controller.style.transform = 'translateY('.concat(e, 'px)'), this.updateButton() } }, { key: 'showLayer', value: function () { L(x(P.prototype), 'showLayer', this).call(this), this.areaHeight = this.$dragArea.clientHeight, this.updateController() } }, { key: 'update', value: function () { this.$controller.style.background = this.$current.style.background = this.player.options.color } }]) && k(S.prototype, T), void (_ && k(S, _)), P); function P (t) { var o; (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, P), (o = $(this, x(P).call(this, t))).volumeValue = 0, o.areaHeight = 0, o.$video = o.player.$video, o.$video.addEventListener('volumechange', function () { return o.updateController() }), o.$layer = o.player.$root.querySelector('.interactive-layer .volume-bar'), o.$valueLabel = o.$layer.querySelector('.volume-num-label'), o.$btn = o.player.$root.querySelector('.interactive-layer .buttons .button.volume'), o.btn = new b(o.$btn), o.$btn.addEventListener('click', function () { return o.toggleMuted() }), o.$dragArea = o.$layer.querySelector('.volume-column-bar'), o.$controller = o.$dragArea.querySelector('.bar-controller'), o.$current = o.$dragArea.querySelector('.bar-current'), o.volumeValue = o.$video.volume = o.player.options.volume, o.volumeValue === 0 && (o.volumeValue = 0.7); function e (t) { var e = t.pageY; var n = o.$dragArea.getBoundingClientRect(); if (e < n.top)o.$video.volume = 1; else if (e > n.bottom)o.$video.volume = 0; else { var i = n.bottom - n.top; var r = (e -= n.top) / i; o.$video.volume = a.a.round(1 - r, 2) }o.volumeValue = o.$video.volume, o.updateController() } function n (t) { document.removeEventListener('mousemove', e), document.removeEventListener('mouseup', n), e(t) } return o.$dragArea.addEventListener('mousedown', function () { document.addEventListener('mousemove', e), document.addEventListener('mouseup', n) }), o.init(), o.updateController(), o } function j (t) { return (j = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (t) { return typeof t } : function (t) { return t && typeof Symbol === 'function' && t.constructor === Symbol && t !== Symbol.prototype ? 'symbol' : typeof t })(t) } function A (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } function D (t, e) { return !e || j(e) !== 'object' && typeof e !== 'function' ? (function (t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t)) : e } function B (t, e, n) { return (B = typeof Reflect !== 'undefined' && Reflect.get ? Reflect.get : function (t, e, n) { var i = (function (t, e) { for (;!Object.prototype.hasOwnProperty.call(t, e) && (t = F(t)) !== null;);return t }(t, e)); if (i) { var r = Object.getOwnPropertyDescriptor(i, e); return r.get ? r.get.call(n) : r.value } })(t, e, n || t) } function F (t) { return (F = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function M (t, e) { return (M = Object.setPrototypeOf || function (t, e) { return t.__proto__ = e, t })(t, e) } var C; var I; var q; var H = ((function (t, e) { if (typeof e !== 'function' && e !== null) throw new TypeError('Super expression must either be null or a function'); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && M(t, e) }(R, f)), C = R, (I = [{ key: 'showButton', value: function () { this.$btn.style.display = '' } }, { key: 'hideButton', value: function () { this.$btn.style.display = 'none' } }, { key: 'showLayer', value: function () { B(F(R.prototype), 'showLayer', this).call(this), this._updateLevel(), this.updateLayerPosition() } }, { key: 'updateButton', value: function () { var t = '自动'; this.currentLevel > -1 && this.hls.levels[this.hls.loadLevel] && (t = this.hls.levels[this.hls.loadLevel].name + 'p'), this.$btn.innerText = t } }, { key: '_updateLevel', value: function () { var i = this; this.$layer.innerHTML = '', this.hls.levels.forEach(function (t, e) { if (t.name) { var n = document.createElement('div'); e === i.currentLevel && n.classList.add('current'), n.innerText = t.name + 'P', n.setAttribute('data-value', e.toString()), i.$layer.append(n) } }), this.currentLevel === -1 ? this.$autoLevel.classList.add('current') : this.$autoLevel.classList.remove('current'), this.$layer.append(this.$autoLevel) } }, { key: 'updateLevel', value: function (t) { this.hls = t, this._updateLevel(), this.updateLayerPosition(), this.updateButton() } }]) && A(C.prototype, I), void (q && A(C, q)), R); function R (t) { var i; return (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') }(this, R)), (i = D(this, F(R).call(this, t))).currentLevel = -1, i.$btn = i.player.$root.querySelector('.button.quality'), i.$layer = i.player.$root.querySelector('.float.quality-menu'), i.$autoLevel = document.createElement('div'), i.$autoLevel.innerHTML = '自动', i.$autoLevel.setAttribute('data-value', (-1).toString()), i.init(), i.$layer.addEventListener('click', function (t) { if (t.target) { var e = t.target; if (e.hasAttribute('data-value')) { var n = parseInt(e.getAttribute('data-value')); i.player.hls && (i.player.hls.currentLevel = i.player.hls.loadLevel = n, i.currentLevel = n) } }i.updateButton(), i.hideLayer() }), i } function Y (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } var z; var U; var N; var W; var G; var V = (U = X, W = [{ key: 'getTimeString', value: function (t) { var e = []; var n = Math.floor(t / 3600); return n > 0 && (n.toString().length === 1 && (n = '0' + n), e.push(n)), (n = Math.floor(t / 60) - 60 * Math.floor(t / 3600)).toString().length === 1 && (n = '0' + n), e.push(n), (n = Math.floor(t) - 60 * Math.floor(t / 60)).toString().length === 1 && (n = '0' + n), e.push(n), e.join(':') } }], (N = [{ key: 'time', value: function () { this.player.options.live || (this.$time.innerText = X.getTimeString(this.player.$video.currentTime) + ' / ' + X.getTimeString(this.player.$video.duration)) } }, { key: 'resize', value: function () { this.barWidth = this.player.width - this.offsetWidth, this.update(), this.updateBufferBar() } }, { key: 'update', value: function () { var t = this.barWidth * this.percent; this.$current.style.width = t + 'px', this.$controller.style.transform = 'translateX('.concat(t, 'px)'), this.$controller.style.background = this.player.options.color, this.$current.style.background = this.player.options.color } }, { key: 'resetTimeZone', value: function () { this.player.options.live ? this.$time.innerText = '直播' : this.$time.innerText = '' } }, { key: 'updateBufferBar', value: function () { for (var t = 0; t < this.player.$video.buffered.length; t++) { var e = this.player.$video.buffered.start(t); var n = this.player.$video.buffered.end(t); e < this._currentTime && this._currentTime < n && (this.$buffer.style.width = n / this.player.$video.duration * this.barWidth + 'px') } } }]) && Y(U.prototype, N), void (W && Y(U, W)), X); function X (t) { var i = this; (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, X), this.barWidth = 0, this._currentTime = 0, this.percent = 0, this.offsetWidth = 0, this.player = t.player, this.ui = t, this.$root = this.player.$root.querySelector('.progress-bar'), this.$controller = this.$root.querySelector('.bar-controller'), this.$current = this.$root.querySelector('.bar-current'), this.$time = this.player.$root.querySelector('.controller-bottom-bar .time'), this.$buffer = this.$root.querySelector('.bar-buffer'), this.player.$video.addEventListener('timeupdate', function () { i._currentTime = i.player.$video.currentTime, i.percent = i._currentTime / i.player.$video.duration, i.time(), i.update() }), this.player.$video.addEventListener('progress', function () { i.updateBufferBar(), i.time() }); function e (t) { var e = i.player.$root.getBoundingClientRect(); var n = t.pageX - e.left - i.offsetWidth / 2; n < 0 ? n = 0 : n > i.barWidth && (n = i.barWidth), i.percent = n / i.barWidth, i.player.$video.currentTime = i.percent * i.player.$video.duration, i.update(), i.ui.isMouseInUI = !0 } function n () { document.removeEventListener('mousemove', e), document.removeEventListener('mouseup', n) } this.$root.addEventListener('mousedown', function () { document.addEventListener('mousemove', e), document.addEventListener('mouseup', n) }), this.$root.addEventListener('click', e), this.offsetWidth = this.player.width - this.$root.clientWidth, this.resize() } function K (t) { var e = t.currentTime; var n = void 0 === e ? 0 : e; var i = t.borderColor; var r = void 0 === i ? '' : i; var o = t.fill; var s = void 0 === o ? '#ffffff' : o; var a = t.type; var u = void 0 === a ? z.Flow : a; var l = t.id; var h = void 0 === l ? '' : l; var c = t.fontSize; return { currentTime: n, type: u, borderColor: r, fill: s, id: h, fontSize: void 0 === c ? 28 : c } }(G = z = z || {})[G.Top = 0] = 'Top', G[G.Flow = 1] = 'Flow', G[G.Bottom = 2] = 'Bottom'; function Q (t, e) { (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, Q), this.text = t, Object.assign(this, K(e || {})) } function Z (t) { return (Z = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (t) { return typeof t } : function (t) { return t && typeof Symbol === 'function' && t.constructor === Symbol && t !== Symbol.prototype ? 'symbol' : typeof t })(t) } function J (t, e) { return !e || Z(e) !== 'object' && typeof e !== 'function' ? (function (t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t)) : e } function tt (t) { return (tt = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function et (t, e) { if (typeof e !== 'function' && e !== null) throw new TypeError('Super expression must either be null or a function'); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && nt(t, e) } function nt (t, e) { return (nt = Object.setPrototypeOf || function (t, e) { return t.__proto__ = e, t })(t, e) } function it (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') } function rt (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } function ot (t, e, n) { return e && rt(t.prototype, e), n && rt(t, n), t } var st = 'px "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'; var at = (ot(dt, [{ key: 'getSize', value: function () { this.ctx.textBaseline = 'top', this.ctx.textAlign = 'left', this.ctx.font = this.danmaku.fontSize + st, this.width = this.ctx.measureText(this.danmaku.text).width, this.height = 1.2 * this.ctx.measureText('M').width } }, { key: 'draw', value: function () { var t = this.width + 4; var e = this.height; this.selfCanvas.width = t, this.selfCanvas.height = e, this.ctx.textBaseline = 'top', this.ctx.textAlign = 'left', this.ctx.font = this.danmaku.fontSize + st, this.ctx.clearRect(0, 0, t, e), this.danmaku.borderColor && (this.ctx.strokeStyle = this.danmaku.borderColor, this.ctx.strokeRect(1, 1, t - 4, e - 4)), this.ctx.strokeStyle = '#000000', this.ctx.strokeText(this.danmaku.text, 1, 1), this.ctx.fillStyle = this.danmaku.fill, this.ctx.fillText(this.danmaku.text, 1, 1) } }]), dt); var ut = (et(ft, at), ot(ft, [{ key: 'set', value: function (t, e, n) { this.danmaku = t, this.enable = !0, this.left = e, this.top = n, this.getSize(), this.draw() } }, { key: 'update', value: function (t, e, n) { var i = (t + this.width) / e * n; this.left = this.left - i, this.enable = this.left + this.width > 0 } }]), ft); var lt = (et(ct, at), ot(ct, [{ key: 'set', value: function (t, e, n, i) { this.danmaku = t, this.timeout = e, this.enable = !0, this.getSize(), this.left = (n - this.width) / 2, this.top = i, this.draw(), this.update(0) } }, { key: 'update', value: function (t) { this.timeout -= t, this.enable = this.timeout > 0 } }]), ct); var ht = n('faa1'); function ct () { var t; return it(this, ct), (t = J(this, tt(ct).apply(this, arguments))).timeout = 0, t } function ft () { return it(this, ft), J(this, tt(ft).apply(this, arguments)) } function dt () { it(this, dt), this.top = 0, this.left = 0, this.width = 0, this.height = 0, this.enable = !1, this.selfCanvas = document.createElement('canvas'), this.selfCanvas.width = 100, this.selfCanvas.height = 100, this.ctx = this.selfCanvas.getContext('2d') } function pt (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } var vt; var yt; var mt; var bt; var gt; var wt = 'px "Hiragino Sans GB", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif'; var kt = (yt = $t, (mt = [{ key: 'addDrawer', value: function (t) { this.caches.push(t) } }, { key: 'removeDrawer', value: function (t) { var e = this.caches.indexOf(t); e > -1 && this.caches.splice(e, 1) } }, { key: 'renderAll', value: function () { if (this.clear(), this.caches.length > 0) for (var t = 0; t < this.caches.length; t++) { var e = this.caches[t]; this.ctx.drawImage(e.selfCanvas, e.left, e.top) } } }, { key: 'clear', value: function () { this.ctx.clearRect(0, 0, this.player.width, this.player.height) } }, { key: 'clearCache', value: function () { this.caches.length = 0 } }, { key: 'fontHeight', value: function (t) { return this.ctx.font = t + wt, 1.2 * this.ctx.measureText('M').width } }, { key: 'fontWidth', value: function (t) { return this.ctx.font = t.danmaku.fontSize + wt, this.ctx.measureText(t.danmaku.text).width } }, { key: 'resize', value: function () { this.$canvas.setAttribute('width', this.player.width + 'px'), this.$canvas.setAttribute('height', this.player.height + 'px') } }, { key: 'alpha', set: function (t) { this.ctx.globalAlpha = t } }]) && pt(yt.prototype, mt), void (bt && pt(yt, bt)), $t); function $t (t) { (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, $t), this.caches = [], this.player = t, this.$canvas = t.$root.querySelector('canvas'), this.ctx = this.$canvas.getContext('2d'), this.$canvas.addEventListener('click', function () { t.toggle() }) } function Lt (t) { return (function (t) { if (Array.isArray(t)) { for (var e = 0, n = new Array(t.length); e < t.length; e++)n[e] = t[e]; return n } }(t)) || (function (t) { if (Symbol.iterator in Object(t) || Object.prototype.toString.call(t) === '[object Arguments]') return Array.from(t) }(t)) || (function () { throw new TypeError('Invalid attempt to spread non-iterable instance') }()) } function xt (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } }(gt = vt = vt || {})[gt.UnLimited = 0] = 'UnLimited', gt[gt.UnOverlap = 1] = 'UnOverlap', gt[gt.Percent25 = 0.25] = 'Percent25', gt[gt.Half = 0.5] = 'Half', gt[gt.Percent75 = 0.25] = 'Percent75'; var Et = '<div class="content"></div><div class="buttons"><span class="copy">复制</span></div>'; function St (t, e, n) { var i = document.createElement('div'); i.innerHTML = Et, i.querySelector('.content').innerText = t.danmaku.text; var r = i.querySelector('.buttons'); for (var o in e) { var s = document.createElement('span'); s.innerText = o, s.onclick = e[o], r.prepend(s) } var a = i.querySelector('.copy'); return a && a.addEventListener('click', function () { return n(t.danmaku.text) }), i } function Tt () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; var e = t.alpha; var n = void 0 === e ? 1 : e; var i = t.enable; var r = void 0 === i || i; var o = t.flowDuration; var s = void 0 === o ? 8 : o; var a = t.fadeoutDuration; var u = void 0 === a ? 5 : a; var l = t.limit; var h = void 0 === l ? vt.UnOverlap : l; var c = t.contextMenu; return { alpha: n, enable: r, flowDuration: s, limit: h, fadeoutDuration: u, contextMenu: void 0 === c ? void 0 : c } } var _t; var Ot; var Pt; var jt = (_t = At, Pt = [{ key: 'find', value: function (t, e) { return t.offsetX > e.left && t.offsetX < e.left + e.width && t.offsetY > e.top && t.offsetY < e.top + e.height } }], (Ot = [{ key: 'createDanmakuMenu', value: function (t) { var e = this; this.$menu && this.$menu.remove(), this.$menu = document.createElement('div'), this.$menu.className = 'float show danmaku-context-menu'; for (var n = 0; n < t.length; n++) { var i = t[n]; if (this.player.options.danmaku.contextMenu) { var r = St(i, this.player.options.danmaku.contextMenu(i), function (t) { return e.copyText(t) }); this.$menu.append(r) } }document.body.append(this.$menu) } }, { key: 'show', value: function () { this.isShow = !0 } }, { key: 'hide', value: function () { this.isShow = !1, this.canvas.clear() } }, { key: 'clear', value: function () { var t, e; this.showed.length = 0, this.canvas.clear(), this.canvas.clearCache(), (t = this.topAndBottomDisables).push.apply(t, Lt(this.topEnables)), this.topEnables.length = 0, (e = this.flowDisables).push.apply(e, Lt(this.flowEnables)), this.flowEnables.length = 0 } }, { key: 'resize', value: function () { this.width = this.player.$root.clientWidth, this.height = this.player.$root.clientHeight, this.lineHeight = Math.round(this.canvas.fontHeight(this.player.options.fontSize)); for (var t = this.lineHeights.length = 0; t < window.screen.height; t++) { var e = t * this.lineHeight; if (e > window.screen.height) break; this.lineHeights.push(e), this.topLines.hasOwnProperty(e) || (this.topLines[e] = null), this.bottomLines.hasOwnProperty(e) || (this.bottomLines[e] = []), this.flowLines.hasOwnProperty(e) || (this.flowLines[e] = []) } this.canvas.resize(); var n = this.player.options.danmaku.limit; n === vt.Percent75 ? this.displayArea = 0.75 * this.player.height : n === vt.Half ? this.displayArea = 0.5 * this.player.height : n === vt.Percent25 ? this.displayArea = 0.25 * this.player.height : this.displayArea = this.player.height, this.canvas.alpha = this.player.options.danmaku.alpha, this.canvas.renderAll() } }, { key: 'toggle', value: function () { this.isShow ? this.hide() : this.show() } }, { key: 'send', value: function (t) { t.text = t.text.trim(), this.danmakus.push(t) } }, { key: 'findDrawers', value: function (e) { return [].concat(Lt(this.topEnables.filter(function (t) { return At.find(e, t) })), Lt(this.bottomEnables.filter(function (t) { return At.find(e, t) })), Lt(this.flowEnables.filter(function (t) { return At.find(e, t) }))) } }, { key: 'addDanmakuToCanvas', value: function () { if (this.danmakus.length !== 0) for (var t = 0; t < this.danmakus.length; t++) { var e = this.danmakus[t]; var n = Math.abs(this.player.currentTime - e.currentTime); if (!(this.showed.includes(e) || n > 0.1)) { if (this.showed.push(e), e.type === z.Flow) { var i = this.flowDisables.shift() || new ut(); i.enable = !0, i.set(e, this.width, this.calcFlowTop(i)), i.update(this.width, this.player.options.danmaku.flowDuration, 0), this.flowEnables.push(i), this.canvas.addDrawer(i) } else { var r = this.topAndBottomDisables.shift() || new lt(); if (r.enable = !0, e.type === z.Top)r.set(e, this.player.options.danmaku.fadeoutDuration, this.width, this.calcTopTop(r)), this.topEnables.push(r); else { var o = this.calcBottomTop(r) + this.lineHeight; o = this.height - o, r.set(e, this.player.options.danmaku.fadeoutDuration, this.width, o), this.bottomEnables.push(r) }r.update(0), this.canvas.addDrawer(r) } this.canvas.renderAll() } } } }, { key: 'copyText', value: function (t) { this.$input || (this.$input = this.player.$root.querySelector('input.copy-tool')), this.$input.value = t, this.$input.select(), document.execCommand('copy') } }, { key: 'calcFlowTop', value: function (t) { for (var e in this.flowLines) { var n = this.flowLines[e]; var i = Number(e); var r = n.left + n.width; if (!(n && n.enable && r > this.width)) { if (i > this.displayArea) break; return this.flowLines[e] = t, this.flowY = i } } return this.flowY += this.lineHeight, this.flowY > this.displayArea && (this.flowY = 0), this.flowLines[this.flowY] = t, this.flowY } }, { key: 'calcTopTop', value: function (t) { for (var e in this.topLines) { var n = this.topLines[e]; var i = Number(e); if (!n || !n.enable) { if (i > this.displayArea) break; return this.topLines[e] = t, this.topY = i } } return this.topY += this.lineHeight, this.topY > this.displayArea && (this.topY = 0), this.topLines[this.topY] = t, this.topY } }, { key: 'calcBottomTop', value: function (t) { for (var e in this.bottomLines) { var n = this.bottomLines[e]; var i = Number(e); if (!n || !n.enable) { if (i > this.displayArea) break; return this.bottomLines[e] = t, this.bottomY = i } } return this.bottomY += this.lineHeight, this.bottomY > this.displayArea && (this.bottomY = 0), this.bottomLines[this.bottomY] = t, this.bottomY } }, { key: 'drawDanmaku', value: function () { var e = this; this.topEnables = this.topEnables.filter(function (t) { return t.enable ? (t.update(e.frameTime), !0) : (e.canvas.removeDrawer(t), e.topAndBottomDisables.push(t), !1) }), this.bottomEnables = this.bottomEnables.filter(function (t) { return t.enable ? (t.update(e.frameTime), !0) : (e.canvas.removeDrawer(t), e.topAndBottomDisables.push(t), !1) }), this.flowEnables = this.flowEnables.filter(function (t) { return t.enable ? (t.update(e.width, e.player.options.danmaku.flowDuration, e.frameTime), !0) : (e.canvas.removeDrawer(t), e.flowDisables.push(t), !1) }) } }, { key: 'loop', value: function () { var t = this; this.destroied || (this.addDanmakuToCanvas(), this.addDanmakuToCanvasTime = (Date.now() - this.lastFrame) / 1e3, this.player.paused || (this.drawDanmaku(), this.calcDanmakuTime = (Date.now() - this.lastFrame) / 1e3, this.isShow ? this.canvas.renderAll() : this.canvas.clear()), this.frameTime = (Date.now() - this.lastFrame) / 1e3, this.lastFrame = Date.now(), window.requestAnimationFrame(function () { t.loop() })) } }, { key: 'destroy', value: function () { this.destroied = !0, clearInterval(this.calcTopInterval), this.$menu && this.$menu.remove() } }, { key: 'debug', get: function () { return { isShow: this.isShow, all: this.danmakus.length, showed: this.showed.length, time: { addDanmakuToCanvas: this.addDanmakuToCanvasTime, drawDanmaku: this.calcDanmakuTime, frameTime: this.frameTime }, 'on screen danmakus': { top: this.topEnables.length, bottom: this.bottomEnables.length, flow: this.flowEnables.length }, 'danmaku pool': { fixed: this.topAndBottomDisables.length, flow: this.flowDisables.length }, positionY: { top: this.topY, flow: this.flowY, bottom: this.bottomY } } } }]) && xt(_t.prototype, Ot), void (Pt && xt(_t, Pt)), At); function At (t) { var s = this; (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, At), this.danmakus = [], this.showed = [], this.topEnables = [], this.topAndBottomDisables = [], this.bottomEnables = [], this.flowEnables = [], this.flowDisables = [], this.lineHeights = [], this.topLines = {}, this.bottomLines = {}, this.flowLines = {}, this.displayArea = 0, this.topY = 0, this.flowY = 0, this.bottomY = 0, this.frameTime = 0, this.calcDanmakuTime = 0, this.isShow = !0, this.width = 0, this.height = 0, this.calcTopInterval = -1, this.destroied = !1, this.addDanmakuToCanvasTime = 0, this.lastFrame = 0, this.player = t, this.event = new ht.EventEmitter(), this.canvas = new kt(t); function a () { document.removeEventListener('click', a), document.removeEventListener('contextmenu', a), s.$menu.remove() } this.canvas.$canvas.addEventListener('contextmenu', function (t) { var e = s.findDrawers(t); if (e.length > 0) { s.createDanmakuMenu(e); var n = t.pageX; var i = t.pageY; var r = t.clientX + s.$menu.clientWidth; var o = t.clientY + s.$menu.clientHeight; r > document.body.clientWidth && (n -= r - document.body.clientWidth), o > document.body.clientHeight && (i -= o - document.body.clientHeight), s.$menu.style.left = n + 'px', s.$menu.style.top = i + 'px', document.addEventListener('click', a), document.addEventListener('touchstart', a), document.addEventListener('contextmenu', a) } return t.preventDefault(), t.stopPropagation(), !1 }), this.player.$video.addEventListener('seeked', function () { s.clear() }), this.player.options.danmaku.enable ? this.show() : this.hide(), this.loop() } function Dt (t) { return (Dt = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (t) { return typeof t } : function (t) { return t && typeof Symbol === 'function' && t.constructor === Symbol && t !== Symbol.prototype ? 'symbol' : typeof t })(t) } function Bt (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } function Ft (t, e) { return !e || Dt(e) !== 'object' && typeof e !== 'function' ? (function (t) { if (void 0 === t) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return t }(t)) : e } function Mt (t) { return (Mt = Object.setPrototypeOf ? Object.getPrototypeOf : function (t) { return t.__proto__ || Object.getPrototypeOf(t) })(t) } function Ct (t, e) { return (Ct = Object.setPrototypeOf || function (t, e) { return t.__proto__ = e, t })(t, e) } var It; var qt; var Ht; var Rt = ((function (t, e) { if (typeof e !== 'function' && e !== null) throw new TypeError('Super expression must either be null or a function'); t.prototype = Object.create(e && e.prototype, { constructor: { value: t, writable: !0, configurable: !0 } }), e && Ct(t, e) }(Yt, f)), It = Yt, (qt = [{ key: 'getStyle', value: function () { return { fill: this.fill, type: this.type, borderColor: 'white' } } }]) && Bt(It.prototype, qt), void (Ht && Bt(It, Ht)), Yt); function Yt (t) { var e; return (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') }(this, Yt)), (e = Ft(this, Mt(Yt).call(this, t))).fill = '#ffffff', e.type = z.Flow, e.$layer = e.player.$root.querySelector('.float.danmaku-style-layer'), e.$btn = e.player.$root.querySelector('.intern-button.danmaku-style'), e.$layer.innerHTML = '<div>类型\n<div class="types">\n  <div class="type" data-type="1"><div><svg class="icon"><use xlink:href="#danplayer-danmugundongkai"></use></svg></div>流动</div>\n  <div class="type" data-type="0"><div><svg class="icon"><use xlink:href="#danplayer-danmudingbukai"></use></svg></div>顶部</div>\n  <div class="type" data-type="2"><div><svg class="icon"><use xlink:href="#danplayer-danmudibukai"></use></svg></div>底部</div>\n</div>\n</div>\n<div>颜色\n<div class="colors">\n{colors}\n</div>\n</div>'.replace('{colors}', Yt.colors.map(function (t) { return '<span style="background: '.concat(t, '" data-color="').concat(t, '"></span>') }).join('')), e.init(), e.$types = Array.from(e.$layer.querySelectorAll('.types > .type')), e.$colors = Array.from(e.$layer.querySelectorAll('.colors > span')), e.$types.forEach(function (t) { return t.addEventListener('click', function () { e.$types.forEach(function (t) { return t.classList.remove('selected') }), t.classList.add('selected'), e.type = Number(t.getAttribute('data-type')) }) }), e.$colors.forEach(function (t) { return t.addEventListener('click', function () { e.$colors.forEach(function (t) { return t.classList.remove('selected') }), t.classList.add('selected'), e.fill = t.getAttribute('data-color') }) }), e.$types[0].classList.add('selected'), e.$colors[e.$colors.length - 1].classList.add('selected'), e } function zt (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } }Rt.colors = ['#FE0302', '#FF7204', '#FFAA02', '#FFD302', '#FFFF00', '#A0EE00', '#00CD00', '#019899', '#4266BE', '#89D5FF', '#CC0273', '#222222', '#9B9B9B', '#FFFFFF']; var Ut; var Nt; var Wt; var Gt = (Ut = Vt, (Nt = [{ key: 'send', value: function () { var t = this.styleLayer.getStyle(); t.currentTime = this.ui.player.currentTime, this.ui.danmakuLayer.send(new Q(this.$input.value, t)), this.$input.value = '', this.ui.player.$root.focus() } }, { key: 'toggle', value: function () { this.isShow ? this.hide() : this.show() } }, { key: 'show', value: function () { this.isShow = !0, this.$root.style.display = '' } }, { key: 'hide', value: function () { this.isShow = !1, this.$root.style.display = 'none' } }, { key: 'update', value: function () {} }, { key: 'focus', value: function () { this.$input.focus() } }]) && zt(Ut.prototype, Nt), void (Wt && zt(Ut, Wt)), Vt); function Vt (t) { var e = this; (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, Vt), this.isShow = !1, this.ui = t, this.styleLayer = new Rt(t), this.$root = t.player.$root.querySelector('.danmaku-form'), this.$input = this.$root.querySelector('input'), this.$btn = this.$root.querySelector('.send'), this.$btn.addEventListener('click', function () { return e.send() }), this.$input.addEventListener('keypress', function (t) { t.key === 'Enter' && e.ui.isShow && e.$input.value && e.send() }), this.$input.addEventListener('keydown', function (t) { !t.key.startsWith('Arrow') && t.key !== ' ' || t.stopPropagation() }), this.$input.addEventListener('keyup', function (t) { t.key === 'Escape' && (e.ui.player.$root.focus(), e.ui.hide()), t.stopPropagation() }), this.$input.addEventListener('focus', function () { e.ui.isMouseInUI = !0 }), this.$input.addEventListener('blur', function () { e.ui.isMouseInUI = !1 }) } function Xt (t) { return (function (t) { if (Array.isArray(t)) { for (var e = 0, n = new Array(t.length); e < t.length; e++)n[e] = t[e]; return n } }(t)) || (function (t) { if (Symbol.iterator in Object(t) || Object.prototype.toString.call(t) === '[object Arguments]') return Array.from(t) }(t)) || (function () { throw new TypeError('Invalid attempt to spread non-iterable instance') }()) } function Kt (t, e, n, i, r, o, s) { try { var a = t[o](s); var u = a.value } catch (t) { return void n(t) }a.done ? e(u) : Promise.resolve(u).then(i, r) } function Qt (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } var Zt; var Jt; var te; var ee = (Zt = ne, (Jt = [{ key: 'show', value: function () { this.isShow = !0, this.$root.classList.add('show'), this.$gradientBG.classList.add('show') } }, { key: 'hide', value: function () { this.isShow = !1, this.$root.classList.remove('show'), this.$gradientBG.classList.remove('show'), this.qualitySelector.hideLayer(), this.volume.hideLayer(), this.danmakuForm.styleLayer.hideLayer(), this.player.$root.focus() } }, { key: 'hideUIDelay', value: function () { var e = this; return this.cancelHideUIDelay(), new Promise(function (t) { e.hideTimeout = window.setTimeout(function () { e.hide(), t() }, e.player.options.uiFadeOutDelay) }) } }, { key: 'cancelHideUIDelay', value: function () { clearTimeout(this.hideTimeout) } }, { key: 'clearExtraButtons', value: function () { this.extraButtons.forEach(function (t) { return t.remove() }), this.extraButtons.length = 0 } }, { key: 'insertExtraButtons', value: function () { var t, e; this.clearExtraButtons(), this.player.options.extraButtons && (this.player.options.extraButtons.forEach(function (t) { t.classList.add('button'), t.classList.remove('intern-button') }), (t = this.$controllerButtonsRightLayout).prepend.apply(t, Xt(this.player.options.extraButtons)), (e = this.extraButtons).push.apply(e, Xt(this.player.options.extraButtons))) } }, { key: 'update', value: function () { this.updateDanmakuButton(), this.updateFullScreenButton(), this.updatePlayButton(), this.danmakuForm.update(), this.progressBar.update(), this.volume.update() } }, { key: 'updatePlayButton', value: function () { this.player.paused ? this.btnPlay.switch('data-on', 'data-on-title') : this.btnPlay.switch('data-off', 'data-off-title') } }, { key: 'updateFullScreenButton', value: function () { this.player.isFullScreen ? this.btnFullScreen.switch('data-off', 'data-off-title') : this.btnFullScreen.switch('data-on', 'data-on-title') } }, { key: 'updateDanmakuButton', value: function () { var t, e; e = this.danmakuLayer.isShow ? (t = 'data-off', 'data-off-title') : (t = 'data-on', 'data-on-title'), this.btnShowDanmaku.switch(t, e) } }, { key: 'resize', value: function () { this.volume.isShow && this.volume.updateLayerPosition(), this.qualitySelector.isShow && this.qualitySelector.updateLayerPosition(), this.progressBar.resize(), this.danmakuLayer.resize() } }, { key: 'destroy', value: function () { clearTimeout(this.hideTimeout), this.danmakuLayer.destroy(), this.qualitySelector.destroy(), this.volume.destroy() } }, { key: 'isMouseInUI', set: function (t) { this._isMouseInUI = t, this.cancelHideUIDelay() }, get: function () { return this._isMouseInUI } }, { key: 'debug', get: function () { return { isShow: this.isShow, isMouseInUI: this._isMouseInUI, danmakuLayer: this.danmakuLayer.debug } } }]) && Qt(Zt.prototype, Jt), void (te && Qt(Zt, te)), ne); function ne (t) { var e = this; (function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') })(this, ne), this._isMouseInUI = !1, this.isShow = !1, this.extraButtons = [], this.hideTimeout = -1, this.player = t, this.$root = t.$root.querySelector('.interactive-layer .controller-bottom-bar'), this.$root.addEventListener('mouseenter', function () { e.isMouseInUI = !0 }), this.$root.addEventListener('mouseleave', function () { e.isMouseInUI = !1 }), this.$gradientBG = t.$root.querySelector('.bg-gradient'), this.volume = new O(this), this.qualitySelector = new H(this), this.progressBar = new V(this), this.styleLayer = new Rt(this), this.danmakuForm = new Gt(this), this.$controllerButtonsRightLayout = this.$root.querySelector('.buttons .right'), this.btnFullScreen = new b(this.$root.querySelector('.button.full-screen')), this.btnFullScreen.$root.addEventListener('click', (function (a) { return function () { var t = this; var s = arguments; return new Promise(function (e, n) { var i = a.apply(t, s); function r (t) { Kt(i, e, n, r, o, 'next', t) } function o (t) { Kt(i, e, n, r, o, 'throw', t) }r(void 0) }) } }(o.a.mark(function t () { return o.a.wrap(function (t) { for (;;) switch (t.prev = t.next) { case 0:return t.next = 2, e.player.toggleFullScreen(); case 2:e.updateFullScreenButton(); case 3:case 'end':return t.stop() } }, t) })))), this.btnPlay = new b(this.$root.querySelector('.button.play')), this.btnPlay.$root.addEventListener('click', function () { e.player.toggle(), e.updatePlayButton() }), this.btnShowDanmaku = new b(this.$root.querySelector('.button.toggle-danamaku')), this.btnShowDanmaku.$root.addEventListener('click', function () { e.danmakuLayer.toggle(), e.updateDanmakuButton() }), this.danmakuLayer = new jt(t), this.insertExtraButtons() } function ie (t) { return (function (t) { if (Array.isArray(t)) { for (var e = 0, n = new Array(t.length); e < t.length; e++)n[e] = t[e]; return n } }(t)) || (function (t) { if (Symbol.iterator in Object(t) || Object.prototype.toString.call(t) === '[object Arguments]') return Array.from(t) }(t)) || (function () { throw new TypeError('Invalid attempt to spread non-iterable instance') }()) } function re (t, e, n, i, r, o, s) { try { var a = t[o](s); var u = a.value } catch (t) { return void n(t) }a.done ? e(u) : Promise.resolve(u).then(i, r) } function oe (a) { return function () { var t = this; var s = arguments; return new Promise(function (e, n) { var i = a.apply(t, s); function r (t) { re(i, e, n, r, o, 'next', t) } function o (t) { re(i, e, n, r, o, 'throw', t) }r(void 0) }) } } function se (t, e) { for (var n = 0; n < e.length; n++) { var i = e[n]; i.enumerable = i.enumerable || !1, i.configurable = !0, 'value' in i && (i.writable = !0), Object.defineProperty(t, i.key, i) } } var ae; var ue; var le = '//at.alicdn.com/t/font_1373341_m9a3piei0s.js'; (ue = ae = ae || {})[ue.Normal = 0] = 'Normal', ue[ue.Hls = 1] = 'Hls', ue[ue.Dash = 2] = 'Dash'; var he; var ce; var fe; var de; var pe; var ve; var ye = (he = me, (ce = [{ key: '_setSrc', value: (ve = oe(o.a.mark(function t () { var e = this; return o.a.wrap(function (t) { for (;;) switch (t.prev = t.next) { case 0:return this.options.src && this.$video.setAttribute('src', this.options.src), t.next = 3, this.getContentType(); case 3:this.ui.qualitySelector.hideButton(), this.hls && (this.hls.on(Hls.Events.LEVEL_LOADED, function () { e.ui.qualitySelector.updateLevel(e.hls) }), this.ui.qualitySelector.showButton()), !this.options.autoplay && this.paused || this.play(), this.options.live ? this.$root.classList.add('live') : this.$root.classList.remove('live'); case 8:case 'end':return t.stop() } }, t, this) })), function () { return ve.apply(this, arguments) }) }, { key: '_setUI', value: function () { this.ui.insertExtraButtons(), this.ui.update(), this.ui.progressBar.resize(), this.ui.progressBar.resetTimeZone(), this.resize() } }, { key: 'set', value: function (t) { t.danmaku = Object.assign({}, this.options.danmaku, t.danmaku); var e = Object.assign({}, this.options, t); var n = e.src !== this.options.src || this.options.live !== e.live; this.options = e, n && (this.hls && (this.hls.detachMedia(), this.hls = void 0), this._setSrc().then()), this._setUI() } }, { key: 'resize', value: function () { this.options.width && (typeof this.options.width === 'number' || parseInt(this.options.width).toString() === this.options.width ? this._width = this.options.width + 'px' : this._width = this.options.width), this.options.height && (typeof this.options.height === 'number' || parseInt(this.options.height).toString() === this.options.height ? this._height = this.options.height + 'px' : this._height = this.options.height), this.isFullScreen || (this.$root.style.width = this._width, this.$root.style.height = this._height), this.ui.resize() } }, { key: 'resizeEvt', value: function (t) { var e = this; window.clearTimeout(this.delayResize), this.delayResize = window.setTimeout(function () { e.resize() }, t) } }, { key: 'fillDanmakus', value: function (t) { var e; (e = this.ui.danmakuLayer.danmakus).push.apply(e, ie(t)) } }, { key: 'sendDanmaku', value: function (t) { this.ui.danmakuLayer.send(t) } }, { key: 'toggle', value: function () { this.paused ? this.play() : this.pause() } }, { key: 'play', value: function () { var e = this; this._paused = !1, this.$video.play().then(), this.options.onlyOne && me.instances.forEach(function (t) { t !== e && t.pause() }) } }, { key: 'pause', value: function () { this._paused = !0, this.$video.pause() } }, { key: 'getContentType', value: (pe = oe(o.a.mark(function t () { var e, n, i; return o.a.wrap(function (t) { for (;;) switch (t.prev = t.next) { case 0:if ((e = this.$video.getAttribute('src')) && (e.match(/\.m3u[8]/) && (this.type = ae.Hls), e.match(/\.mpd/) && (this.type = ae.Dash), this.options.src = e), this.type !== ae.Hls) { t.next = 22; break } if (!Hls.isSupported()) { t.next = 12; break } this.hls = new Hls(), this.hls.config.capLevelToPlayerSize = !0, this.hls.attachMedia(this.$video), this.hls.loadSource(e), t.next = 20; break; case 12:return (n = new XMLHttpRequest()).open('Get', e), n.send(), t.next = 17, new Promise(function (t) { n.onreadystatechange = function () { n.readyState === XMLHttpRequest.HEADERS_RECEIVED && (n.status === 200 ? t(n.getResponseHeader('Content-Type')) : t(null), n.abort()) } }); case 17:(i = t.sent) && this.$video.canPlayType(i) && (this.options.src = this.$video.src = e); case 20:t.next = 23; break; case 22:this.type, ae.Dash; case 23:case 'end':return t.stop() } }, t, this) })), function () { return pe.apply(this, arguments) }) }, { key: 'toggleFullScreen', value: (de = oe(o.a.mark(function t () { return o.a.wrap(function (t) { for (;;) switch (t.prev = t.next) { case 0:if (this.isFullScreen = !this.isFullScreen, this.isFullScreen) return t.next = 4, this.$root.requestFullscreen(); t.next = 6; break; case 4:t.next = 8; break; case 6:return t.next = 8, document.exitFullscreen(); case 8:this.resize(); case 9:case 'end':return t.stop() } }, t, this) })), function () { return de.apply(this, arguments) }) }, { key: 'destroy', value: function () { me.instances.splice(me.instances.indexOf(this), 1), this.ui.destroy(), this.hls && this.hls.detachMedia() } }, { key: 'width', get: function () { return this.$root.clientWidth } }, { key: 'height', get: function () { return this.$root.clientHeight } }, { key: 'loading', get: function () { return this._loading } }, { key: 'currentTime', get: function () { return this.$video.currentTime } }, { key: 'paused', get: function () { return this._paused } }, { key: 'debug', get: function () { var t = '默认'; var e = this.options.src; return this.hls && (t = this.ui.qualitySelector.currentLevel === -1 ? '自动 ' : '', this.hls.currentLevel !== -1 && (t += this.hls.levels[this.hls.currentLevel].name + 'P')), { width: this.width, height: this.height, src: e, quality: t, ui: this.ui.debug } } }]) && se(he.prototype, ce), void (fe && se(he, fe)), me); function me (t, e) { var n = this; if ((function (t, e) { if (!(t instanceof e)) throw new TypeError('Cannot call a class as a function') }(this, me)), this.type = ae.Normal, this._width = '', this._height = '', this.isFullScreen = !1, this._duration = 0, this._loading = !0, this._paused = !0, this.delayResize = -1, !document.querySelector('script#danplayer-icon')) { var i = document.createElement('script'); i.src = le, i.id = 'danplayer-icon', document.body.append(i) }me.instances.push(this); var r = t.parentElement; this.$root = document.createElement('div'), this.$root.setAttribute('tabIndex', '0'), this.$root.classList.add('video-player'), r.insertBefore(this.$root, t), t.classList.add('video-layer'), t.removeAttribute('id'), this.$root.innerHTML = '{video-layer}\n<input class="copy-tool" />\n<div class="interactive-layer">\n  <canvas class="danmaku-layer"></canvas>\n  \n  <div class="bg-gradient show"></div>\n  \n  \n  <div class="float danmaku-style-layer"></div>\n  \n  <div class="float volume-bar">\n    <div class="volume-num-label"></div>\n    <div class="volume-column-bar">\n      <div class="bar-ui bar-full"></div>\n      <div class="bar-ui bar-current"></div>\n      <div class="bar-controller"></div>\n    </div>\n  </div>\n  \n  <div class="float quality-menu"></div>\n  \n  <div class="controller-bottom-bar">\n    <div class="progress-bar live-hide">\n      <div class="bar-full"></div>\n      <div class="bar-buffer"></div>\n      <div class="bar-current"></div>\n      <div class="bar-controller"></div>    \n    </div>\n    \n    <div class="buttons">\n      <div class="left">\n        <div class="button intern-button play" data-on="danplayer-bofang" data-off="danplayer-zanting"\n          data-on-title="播放视频" data-off-title="暂停播放">\n          <svg class="icon" aria-hidden="true"><use xlink:href="#danplayer-bofang"></use></svg>\n        </div>\n        <div class="time"></div>\n      </div>\n      \n      <div class="middle danmaku-form">\n        <div class="button intern-button danmaku-style">\n          <svg class="icon"><use xlink:href="#danplayer-style"></use></svg>\n        </div>\n        <input placeholder="输入弹幕内容" tabindex="1">\n        <div class="send">发送</div>\n      </div>\n      <div class="right">\n      \n        <div class="button intern-button volume" data-on="danplayer-yinliang" data-off="danplayer-jingyin" title="音量">\n          <svg class="icon"><use xlink:href="#danplayer-yinliang"></use></svg>\n        </div>\n        \n        <div class="button intern-button toggle-danamaku" title="隐藏弹幕"\n          data-on="danplayer-danmukai" data-off="danplayer-danmuguan" \n          data-on-title="显示弹幕" data-off-title="隐藏弹幕">\n          <svg class="icon"><use xlink:href="#danplayer-danmukai"></use></svg>\n        </div>\n        \n        <div class="button quality" title="切换画质"></div>\n        \n        <div class="button intern-button full-screen" data-on="danplayer-quanping" data-off="danplayer-zuixiaohua"\n        data-on-title="全屏观看" data-off-title="取消全屏">\n          <svg class="icon"><use xlink:href="#danplayer-quanping"></use></svg>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>'.replace('{video-layer}', t.outerHTML), t.remove(), this.$root.addEventListener('keypress', function (t) { var e = !0; t.key === 'Enter' ? (n.ui.show(), n.ui.danmakuForm.focus()) : e = !1, e && (t.stopPropagation(), t.preventDefault()) }), this.$root.addEventListener('keyup', function (t) { t.key === ' ' && n.toggle() }), document.addEventListener('fullscreenchange', function () { n.isFullScreen = document.fullscreenElement === n.$root, n.ui.updateFullScreenButton() }), this.$root.addEventListener('keydown', function (t) { var e = !0; t.key !== 'ArrowLeft' || n.options.live ? t.key !== 'ArrowRight' || n.options.live ? t.key === 'ArrowUp' ? n.ui.volume.up() : t.key === 'ArrowDown' ? n.ui.volume.down() : e = !1 : n.$video.currentTime += 5 : n.$video.currentTime -= 5, e && (t.stopPropagation(), t.preventDefault()) }), this.$root.addEventListener('mousemove', function () { if (n.$root.classList.remove('mouse-idle'), n.ui.show(), n.paused);else { if (n.ui.isMouseInUI) return; n.ui.hideUIDelay().then(function () { n.$root.classList.add('mouse-idle') }) } }), this.$root.addEventListener('mouseenter', function () { n.ui.show(), n.ui.cancelHideUIDelay() }), this.$root.addEventListener('mouseleave', function () { n.ui.hide(), n.ui.cancelHideUIDelay() }), this.$video = this.$root.querySelector('.video-layer'), this.$video.removeAttribute('controls'), this.$video.addEventListener('durationchange', function () { n._duration = n.$video.duration }), this.$video.addEventListener('playing', function () { return n.ui.hideUIDelay() }), this.$video.addEventListener('play', function () { return n.ui.updatePlayButton() }), this.$video.addEventListener('pause', function () { return n.ui.updatePlayButton() }), window.addEventListener('resize', function () { return n.resizeEvt(1e3) }), this.options = (function (t) { var e = t.autoplay; var n = void 0 !== e && e; var i = t.color; var r = void 0 === i ? '#00a1d6' : i; var o = t.live; var s = void 0 !== o && o; var a = t.volume; var u = void 0 === a ? 0.7 : a; var l = t.fontSize; var h = void 0 === l ? 28 : l; var c = t.width; var f = void 0 === c ? 600 : c; var d = t.height; var p = void 0 === d ? 350 : d; var v = t.uiFadeOutDelay; var y = void 0 === v ? 3e3 : v; var m = t.extraButtons; var b = void 0 === m ? [] : m; var g = t.src; var w = void 0 === g ? '' : g; var k = t.iconSrc; var $ = void 0 === k ? le : k; var L = t.danmakuForm; var x = void 0 === L || L; var E = t.fullScreen; var S = void 0 === E || E; var T = t.danmaku; var _ = void 0 === T ? {} : T; var O = t.onlyOne; var P = void 0 !== O && O; return { autoplay: n, color: r, live: s, fontSize: h, height: p, danmaku: Tt(_), danmakuForm: x, fullScreen: S, src: w, iconSrc: $, uiFadeOutDelay: y, extraButtons: b, onlyOne: P, volume: u, width: f } }(e || { autoplay: this.$video.hasAttribute('autoplay') })), this.ui = new ee(this), this.ui.update(), this._setSrc().then(), this._setUI() }ye.instances = []; var be = { Player: ye, MakeDanmakuOptions: K, MakeDanmakuLayerOptions: Tt }; e.default = be } }, r.c = i, r.d = function (t, e, n) { r.o(t, e) || Object.defineProperty(t, e, { enumerable: !0, get: n }) }, r.r = function (t) { typeof Symbol !== 'undefined' && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, { value: 'Module' }), Object.defineProperty(t, '__esModule', { value: !0 }) }, r.t = function (e, t) { if (1 & t && (e = r(e)), 8 & t) return e; if (4 & t && typeof e === 'object' && e && e.__esModule) return e; var n = Object.create(null); if (r.r(n), Object.defineProperty(n, 'default', { enumerable: !0, value: e }), 2 & t && typeof e !== 'string') for (var i in e)r.d(n, i, function (t) { return e[t] }.bind(null, i)); return n }, r.n = function (t) { var e = t && t.__esModule ? function () { return t.default } : function () { return t }; return r.d(e, 'a', e), e }, r.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, r.p = '', r(r.s = 'fb15')).default; function r (t) { if (i[t]) return i[t].exports; var e = i[t] = { i: t, l: !1, exports: {} }; return n[t].call(e.exports, e, e.exports, r), e.l = !0, e.exports } var n, i }))
